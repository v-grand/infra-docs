{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"infra-deployer/","title":"Infra deployer","text":""},{"location":"infra-deployer/#infra-deployer-usage-guide","title":"Infra Deployer Usage Guide","text":"<p><code>infra-deployer</code> is an automation tool for deploying infrastructure across multiple cloud providers and environments.</p>"},{"location":"infra-deployer/#overview","title":"Overview","text":"<p>Infra Deployer provides a unified interface for deploying and managing infrastructure modules including: - Core infrastructure (VPC, networking) - Compute resources (VMs, Kubernetes clusters) - Databases and storage - Monitoring and observability - Security and access control</p>"},{"location":"infra-deployer/#installation","title":"Installation","text":""},{"location":"infra-deployer/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.8+</li> <li>Terraform 1.0+</li> <li>Cloud provider CLI tools (AWS CLI, gcloud, etc.)</li> </ul>"},{"location":"infra-deployer/#setup","title":"Setup","text":"<pre><code>git clone https://github.com/v-grand/infra-deployer.git\ncd infra-deployer\npip install -r requirements.txt\n</code></pre>"},{"location":"infra-deployer/#configuration","title":"Configuration","text":"<p>Create a configuration file <code>config.yaml</code>:</p> <pre><code>environments:\n  dev:\n    provider: aws\n    region: us-east-1\n    modules:\n      - core\n      - compute\n\n  prod:\n    provider: gcp\n    region: us-central1\n    modules:\n      - core\n      - compute\n      - database\n      - monitoring\n</code></pre>"},{"location":"infra-deployer/#usage","title":"Usage","text":""},{"location":"infra-deployer/#deploy-all-modules","title":"Deploy All Modules","text":"<p>Deploy all configured modules for an environment:</p> <pre><code>python -m deploy.cli deploy all --env dev\n</code></pre>"},{"location":"infra-deployer/#deploy-specific-module","title":"Deploy Specific Module","text":"<p>Deploy a single module:</p> <pre><code>python -m deploy.cli deploy core --env prod\n</code></pre>"},{"location":"infra-deployer/#list-available-modules","title":"List Available Modules","text":"<pre><code>python -m deploy.cli list\n</code></pre>"},{"location":"infra-deployer/#check-deployment-status","title":"Check Deployment Status","text":"<pre><code>python -m deploy.cli status --env dev\n</code></pre>"},{"location":"infra-deployer/#update-existing-deployment","title":"Update Existing Deployment","text":"<pre><code>python -m deploy.cli update core --env prod\n</code></pre>"},{"location":"infra-deployer/#destroy-resources","title":"Destroy Resources","text":"<p>Destroy specific module:</p> <pre><code>python -m deploy.cli destroy core --env dev\n</code></pre> <p>Destroy all modules:</p> <pre><code>python -m deploy.cli destroy all --env dev\n</code></pre>"},{"location":"infra-deployer/#module-structure","title":"Module Structure","text":"<p>Each module follows this structure:</p> <pre><code>modules/\n\u251c\u2500\u2500 core/\n\u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u251c\u2500\u2500 variables.tf\n\u2502   \u251c\u2500\u2500 outputs.tf\n\u2502   \u2514\u2500\u2500 README.md\n\u251c\u2500\u2500 compute/\n\u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u251c\u2500\u2500 variables.tf\n\u2502   \u2514\u2500\u2500 outputs.tf\n\u2514\u2500\u2500 database/\n    \u251c\u2500\u2500 main.tf\n    \u251c\u2500\u2500 variables.tf\n    \u2514\u2500\u2500 outputs.tf\n</code></pre>"},{"location":"infra-deployer/#advanced-features","title":"Advanced Features","text":""},{"location":"infra-deployer/#dry-run","title":"Dry Run","text":"<p>Preview changes without applying:</p> <pre><code>python -m deploy.cli deploy core --env dev --dry-run\n</code></pre>"},{"location":"infra-deployer/#parallel-deployment","title":"Parallel Deployment","text":"<p>Deploy multiple modules in parallel:</p> <pre><code>python -m deploy.cli deploy --modules core,compute,database --parallel\n</code></pre>"},{"location":"infra-deployer/#custom-variables","title":"Custom Variables","text":"<p>Override variables from command line:</p> <pre><code>python -m deploy.cli deploy core --env dev --var region=eu-west-1 --var instance_type=t3.large\n</code></pre>"},{"location":"infra-deployer/#state-management","title":"State Management","text":"<p>View current state:</p> <pre><code>python -m deploy.cli state show --env dev\n</code></pre> <p>Export state:</p> <pre><code>python -m deploy.cli state export --env dev --output state.json\n</code></pre>"},{"location":"infra-deployer/#cicd-integration","title":"CI/CD Integration","text":""},{"location":"infra-deployer/#github-actions","title":"GitHub Actions","text":"<pre><code>name: Deploy Infrastructure\n\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Setup Python\n        uses: actions/setup-python@v4\n        with:\n          python-version: '3.10'\n\n      - name: Install dependencies\n        run: pip install -r requirements.txt\n\n      - name: Deploy\n        run: python -m deploy.cli deploy all --env prod\n        env:\n          AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}\n          AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n</code></pre>"},{"location":"infra-deployer/#best-practices","title":"Best Practices","text":"<ol> <li>Use environments to separate dev, staging, and production</li> <li>Version control your configuration files</li> <li>Test in dev before deploying to production</li> <li>Use dry-run to preview changes</li> <li>Enable state locking to prevent concurrent modifications</li> <li>Tag resources for better organization and cost tracking</li> </ol>"},{"location":"infra-deployer/#troubleshooting","title":"Troubleshooting","text":""},{"location":"infra-deployer/#common-issues","title":"Common Issues","text":"<p>Module not found:</p> <pre><code># List available modules\npython -m deploy.cli list\n</code></pre> <p>Authentication errors:</p> <pre><code># Verify cloud provider credentials\naws sts get-caller-identity  # For AWS\ngcloud auth list             # For GCP\n</code></pre> <p>State conflicts:</p> <pre><code># Force unlock state\npython -m deploy.cli state unlock --env dev\n</code></pre>"},{"location":"infra-deployer/#resources","title":"Resources","text":"<ul> <li>GitHub Repository</li> <li>Module Documentation</li> <li>Examples</li> </ul>"},{"location":"links/","title":"Links","text":""},{"location":"links/#repository-links","title":"Repository Links","text":"<ul> <li>infra-aws</li> <li>infra-core</li> <li>infra-docs</li> <li>infra-gcp</li> </ul>"},{"location":"en/","title":"Home","text":""},{"location":"en/#welcome-to-infra-docs","title":"Welcome to Infra Docs","text":"<p>Welcome to the comprehensive documentation for the v-grand infrastructure ecosystem. This suite of repositories provides a complete, production-ready infrastructure-as-code (IaC) solution for multi-cloud deployments.</p>"},{"location":"en/#architecture-overview","title":"\ud83d\udcda Architecture Overview","text":"<p>The infrastructure ecosystem is built on a modular architecture where each repository serves a specific purpose:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    infra-docs       \u2502  \u2190 Documentation &amp; Examples\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n          \u2502\n          \u251c\u2500\u25ba infra-core       (Reusable Terraform Modules)\n          \u251c\u2500\u25ba infra-template   (Project Template)\n          \u251c\u2500\u25ba infra-ci         (CI/CD Workflows)\n          \u2502\n          \u2514\u2500\u25ba Application Repositories:\n              \u251c\u2500\u25ba template-platform (This Project)\n              \u251c\u2500\u25ba infra-aws        (AWS Infrastructure)\n              \u251c\u2500\u25ba infra-gcp        (GCP Infrastructure)\n              \u251c\u2500\u25ba infra-network    (Network Configuration)\n              \u251c\u2500\u25ba infra-monitoring (Observability Stack)\n              \u251c\u2500\u25ba infra-secrets    (Secrets Management)\n              \u2514\u2500\u25ba infra-k8s        (Kubernetes Clusters)\n</code></pre>"},{"location":"en/#repository-guide","title":"\ud83d\uddc2\ufe0f Repository Guide","text":""},{"location":"en/#core-libraries","title":"Core Libraries","text":"Repository Purpose Status infra-core Reusable Terraform modules (VM, VPC, DB, K8s, Tailscale) \u2705 Active infra-template Standardized template for new infrastructure projects \u2705 Active template-platform A foundational backend service for new applications. \u2705 Active infra-ci Reusable GitHub Actions workflows for CI/CD \u2705 Active infra-docs Documentation website (this site) \u2705 Active"},{"location":"en/#cloud-infrastructure","title":"Cloud Infrastructure","text":"Repository Purpose Supported Clouds infra-aws AWS infrastructure deployment AWS infra-gcp GCP infrastructure deployment GCP infra-network VPC, VPN, Tailscale mesh networking AWS, GCP"},{"location":"en/#platform-services","title":"Platform Services","text":"Repository Purpose Key Technologies infra-monitoring Observability &amp; logging stack Prometheus, Grafana, Loki infra-secrets Centralized secrets management Vault, SOPS, GCP Secrets infra-k8s Kubernetes cluster management GKE, EKS, K3s"},{"location":"en/#quick-start","title":"\ud83d\ude80 Quick Start","text":""},{"location":"en/#for-new-projects","title":"For New Projects","text":"<ol> <li> <p>Clone the template: <code>bash    git clone https://github.com/v-grand/infra-template.git my-new-project    cd my-new-project</code></p> </li> <li> <p>Configure your environment: <code>bash    cp terraform.tfvars.example terraform.tfvars    # Edit terraform.tfvars with your settings</code></p> </li> <li> <p>Deploy: <code>bash    terraform init    terraform plan    terraform apply</code></p> </li> </ol>"},{"location":"en/#for-existing-projects","title":"For Existing Projects","text":"<p>Choose the appropriate repository based on your needs:</p> <ul> <li>AWS Deployment \u2192 infra-aws</li> <li>GCP Deployment \u2192 infra-gcp</li> <li>Kubernetes \u2192 infra-k8s</li> <li>Monitoring \u2192 infra-monitoring</li> </ul>"},{"location":"en/#documentation-structure","title":"\ud83d\udcd6 Documentation Structure","text":"<ul> <li>Infra Core Modules - Detailed module documentation</li> <li>AWS Examples - AWS deployment examples</li> <li>GCP Guides - GCP-specific documentation</li> <li>Tailscale Integration - Mesh networking setup</li> <li>Notebooks - Interactive examples and tutorials</li> </ul>"},{"location":"en/#external-resources","title":"\ud83d\udd17 External Resources","text":"<ul> <li>Terraform Documentation</li> <li>GitHub Actions Documentation</li> <li>AWS Well-Architected Framework</li> <li>Google Cloud Architecture Center</li> </ul>"},{"location":"en/#contributing","title":"\ud83e\udd1d Contributing","text":"<p>We welcome contributions! Please see the individual repository guidelines for contribution instructions.</p>"},{"location":"en/#license","title":"\ud83d\udcc4 License","text":"<p>All repositories are licensed under the MIT License unless otherwise specified.</p>"},{"location":"en/aws/","title":"AWS","text":""},{"location":"en/aws/#aws-infrastructure","title":"AWS Infrastructure","text":"<p>infra-aws manages AWS infrastructure deployment using Terraform modules from infra-core, providing standardized cloud resource provisioning.</p>"},{"location":"en/aws/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Deploy and manage AWS infrastructure:</p> <ul> <li>EC2 Instances - Virtual machine deployment</li> <li>VPC Configuration - Network infrastructure</li> <li>RDS Databases - Managed databases</li> <li>EKS Clusters - Kubernetes on AWS</li> <li>S3 Storage - Object storage</li> <li>IAM Policies - Access management</li> </ul>"},{"location":"en/aws/#repository-structure","title":"\ud83d\udcc1 Repository Structure","text":"<pre><code>infra-aws/\n\u251c\u2500\u2500 bootstrap/              # Initial AWS setup\n\u2502   \u251c\u2500\u2500 iam/               # IAM roles and policies\n\u2502   \u251c\u2500\u2500 s3/                # S3 buckets for Terraform state\n\u2502   \u2514\u2500\u2500 dynamodb/          # DynamoDB for state locking\n\u251c\u2500\u2500 infra/                 # Main infrastructure\n\u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u251c\u2500\u2500 variables.tf\n\u2502   \u251c\u2500\u2500 terraform.tfvars.example\n\u2502   \u251c\u2500\u2500 backend.tf\n\u2502   \u2514\u2500\u2500 outputs.tf\n\u251c\u2500\u2500 ops/                   # Operational scripts\n\u2502   \u251c\u2500\u2500 ssh_config.example\n\u2502   \u2514\u2500\u2500 scripts/\n\u251c\u2500\u2500 ide/                   # IDE configurations\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"en/aws/#quick-start","title":"\ud83d\ude80 Quick Start","text":""},{"location":"en/aws/#1-prerequisites","title":"1. Prerequisites","text":"<ul> <li>Terraform &gt;= 1.5.0</li> <li>AWS CLI configured with credentials</li> <li>Existing EC2 key pair (or create new one)</li> </ul> <pre><code># Configure AWS CLI\naws configure\n\n# Verify access\naws sts get-caller-identity\n</code></pre>"},{"location":"en/aws/#2-bootstrap-infrastructure","title":"2. Bootstrap Infrastructure","text":"<pre><code># Clone repository\ngit clone https://github.com/v-grand/infra-aws.git\ncd infra-aws\n\n# Bootstrap (first time only)\ncd bootstrap\nterraform init\nterraform apply\n\n# This creates:\n# - S3 bucket for Terraform state\n# - DynamoDB table for state locking\n# - Basic IAM roles\n</code></pre>"},{"location":"en/aws/#3-deploy-main-infrastructure","title":"3. Deploy Main Infrastructure","text":"<pre><code>cd ../infra\n\n# Copy example configuration\ncp terraform.tfvars.example terraform.tfvars\n\n# Edit configuration\nnano terraform.tfvars\n</code></pre> <p>terraform.tfvars example:</p> <pre><code># AWS Configuration\naws_region = \"us-east-1\"\nkey_name   = \"my-ec2-key\"\n\n# Network Configuration\nvpc_cidr             = \"10.0.0.0/16\"\navailability_zones   = [\"us-east-1a\", \"us-east-1b\"]\npublic_subnet_cidrs  = [\"10.0.1.0/24\", \"10.0.2.0/24\"]\nprivate_subnet_cidrs = [\"10.0.10.0/24\", \"10.0.11.0/24\"]\n\n# SSH Access\nallowed_ssh_cidr = \"YOUR_IP/32\"  # Get with: curl ifconfig.me\n\n# Application\nrepo_url    = \"https://github.com/your-org/your-app.git\"\nrepo_branch = \"main\"\n\n# Tags\ntags = {\n  Environment = \"dev\"\n  Project     = \"my-app\"\n  ManagedBy   = \"terraform\"\n}\n</code></pre> <pre><code># Deploy\nterraform init\nterraform plan\nterraform apply\n</code></pre>"},{"location":"en/aws/#architecture","title":"\ud83c\udfd7\ufe0f Architecture","text":""},{"location":"en/aws/#basic-architecture","title":"Basic Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              AWS Region (us-east-1)         \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502           VPC (10.0.0.0/16)            \u2502 \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502 \u2502\n\u2502  \u2502  \u2502   AZ-1a      \u2502      AZ-1b       \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502              \u2502                  \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  Public      \u2502    Public        \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  Subnet      \u2502    Subnet        \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  10.0.1/24   \u2502    10.0.2/24     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  \u2502  EC2   \u2502  \u2502   \u2502  EC2   \u2502     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  \u2502  ALB   \u2502  \u2502   \u2502  ALB   \u2502     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502              \u2502                  \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  Private     \u2502    Private       \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  Subnet      \u2502    Subnet        \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  10.0.10/24  \u2502    10.0.11/24    \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  \u2502  RDS   \u2502  \u2502   \u2502  RDS   \u2502     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  \u2502(Primary)\u2502  \u2502   \u2502(Standby)\u2502    \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"en/aws/#modules-usage","title":"\ud83d\udce6 Modules Usage","text":""},{"location":"en/aws/#deploy-ec2-instance","title":"Deploy EC2 Instance","text":"<pre><code>module \"web_server\" {\n  source = \"github.com/v-grand/infra-core//modules/vm\"\n\n  cloud         = \"aws\"\n  instance_name = \"web-server\"\n  instance_type = \"t3.medium\"\n\n  # Network\n  subnet_id          = module.vpc.public_subnet_ids[0]\n  security_group_ids = [aws_security_group.web.id]\n\n  # SSH\n  key_name = var.key_name\n\n  # User data\n  user_data = templatefile(\"${path.module}/scripts/user-data.sh\", {\n    repo_url = var.repo_url\n  })\n\n  tags = merge(var.tags, {\n    Role = \"web-server\"\n  })\n}\n</code></pre>"},{"location":"en/aws/#deploy-vpc","title":"Deploy VPC","text":"<pre><code>module \"vpc\" {\n  source = \"github.com/v-grand/infra-network//modules/vpc-aws\"\n\n  vpc_cidr           = var.vpc_cidr\n  availability_zones = var.availability_zones\n\n  public_subnet_cidrs  = var.public_subnet_cidrs\n  private_subnet_cidrs = var.private_subnet_cidrs\n\n  enable_nat_gateway   = true\n  enable_dns_hostnames = true\n\n  tags = var.tags\n}\n</code></pre>"},{"location":"en/aws/#deploy-rds-database","title":"Deploy RDS Database","text":"<pre><code>module \"database\" {\n  source = \"github.com/v-grand/infra-core//modules/db\"\n\n  cloud = \"aws\"\n\n  # Instance configuration\n  identifier     = \"myapp-db\"\n  engine         = \"postgres\"\n  engine_version = \"15.3\"\n  instance_class = \"db.t3.medium\"\n\n  # Storage\n  allocated_storage     = 100\n  max_allocated_storage = 500\n  storage_encrypted     = true\n\n  # Database\n  db_name  = \"myapp\"\n  username = \"admin\"\n  password = var.db_password  # Use secrets manager\n\n  # Network\n  vpc_id     = module.vpc.vpc_id\n  subnet_ids = module.vpc.private_subnet_ids\n\n  # Security\n  allowed_cidr_blocks = [var.vpc_cidr]\n\n  # Backup\n  backup_retention_period = 7\n  backup_window          = \"03:00-04:00\"\n  maintenance_window     = \"mon:04:00-mon:05:00\"\n\n  # High Availability\n  multi_az               = true\n  deletion_protection    = true\n\n  tags = var.tags\n}\n</code></pre>"},{"location":"en/aws/#security-configuration","title":"\ud83d\udd12 Security Configuration","text":""},{"location":"en/aws/#security-groups","title":"Security Groups","text":"<pre><code># Web server security group\nresource \"aws_security_group\" \"web\" {\n  name        = \"web-server-sg\"\n  description = \"Security group for web servers\"\n  vpc_id      = module.vpc.vpc_id\n\n  # HTTP\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  # HTTPS\n  ingress {\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  # SSH (restricted)\n  ingress {\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [var.allowed_ssh_cidr]\n  }\n\n  # Outbound\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = merge(var.tags, {\n    Name = \"web-server-sg\"\n  })\n}\n</code></pre>"},{"location":"en/aws/#iam-roles","title":"IAM Roles","text":"<pre><code># EC2 instance role\nresource \"aws_iam_role\" \"ec2_role\" {\n  name = \"ec2-instance-role\"\n\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\"\n        Effect = \"Allow\"\n        Principal = {\n          Service = \"ec2.amazonaws.com\"\n        }\n      }\n    ]\n  })\n}\n\n# Attach policies\nresource \"aws_iam_role_policy_attachment\" \"ec2_s3_access\" {\n  role       = aws_iam_role.ec2_role.name\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess\"\n}\n</code></pre>"},{"location":"en/aws/#integration-examples","title":"\ud83d\udd17  Integration Examples","text":""},{"location":"en/aws/#with-infra-monitoring","title":"With infra-monitoring","text":"<pre><code># Deploy monitoring\nmodule \"monitoring\" {\n  source = \"github.com/v-grand/infra-monitoring//modules/prometheus\"\n\n  # AWS specific configuration\n  vpc_id    = module.vpc.vpc_id\n  subnet_id = module.vpc.private_subnet_ids[0]\n\n  instance_type = \"t3.medium\"\n\n  # Scrape targets\n  scrape_targets = [\n    module.web_server.instance_private_ip\n  ]\n}\n</code></pre>"},{"location":"en/aws/#with-infra-secrets","title":"With infra-secrets","text":"<pre><code># Store secrets in AWS Secrets Manager\nmodule \"secrets\" {\n  source = \"github.com/v-grand/infra-secrets//modules/aws-secrets\"\n\n  secrets = {\n    db_password = {\n      secret_string           = var.db_password\n      recovery_window_in_days = 30\n    }\n  }\n}\n</code></pre>"},{"location":"en/aws/#best-practices","title":"\ud83d\udcda Best Practices","text":"<ol> <li>Multi-AZ Deployment - Deploy across multiple availability zones</li> <li>Encrypted Storage - Enable encryption for EBS and RDS</li> <li>IAM Least Privilege - Minimal required permissions</li> <li>VPC Flow Logs - Enable for network monitoring</li> <li>CloudWatch Alarms - Set up monitoring alerts</li> <li>Backup Strategy - Regular automated snapshots</li> <li>Cost Optimization - Use reserved instances, spot instances</li> <li>Tagging Strategy - Consistent resource tagging</li> </ol>"},{"location":"en/aws/#operations","title":"\ud83d\udd27 Operations","text":""},{"location":"en/aws/#connect-to-instance","title":"Connect to Instance","text":"<pre><code># Get instance IP\nterraform output instance_public_ip\n\n# SSH connection\nssh -i ~/.ssh/your-key.pem ec2-user@INSTANCE_IP\n\n# Or use SSH config\ncp ops/ssh_config.example ~/.ssh/config\n# Edit config with your IP\nssh devml\n</code></pre>"},{"location":"en/aws/#backup-and-recovery","title":"Backup and Recovery","text":"<pre><code># Create snapshot\naws ec2 create-snapshot \\\n  --volume-id vol-xxxxx \\\n  --description \"Manual backup\"\n\n# Create AMI\naws ec2 create-image \\\n  --instance-id i-xxxxx \\\n  --name \"web-server-backup-$(date +%Y%m%d)\"\n</code></pre>"},{"location":"en/aws/#documentation","title":"\ud83d\udcd6 Documentation","text":"<ul> <li>AWS Well-Architected</li> <li>Terraform AWS Provider</li> <li>AWS CLI Reference</li> </ul>"},{"location":"en/aws/#related-repositories","title":"\ud83d\udd17 Related Repositories","text":"<ul> <li>infra-core - Reusable Terraform modules</li> <li>infra-network - Network configuration</li> <li>infra-monitoring - Monitoring setup</li> <li>infra-secrets - Secrets management</li> </ul>"},{"location":"en/infra-ci/","title":"Infra CI","text":""},{"location":"en/infra-ci/#infra-ci-cicd-workflows","title":"infra-ci: CI/CD Workflows","text":"<p>infra-ci is a centralized repository containing reusable GitHub Actions workflows, pipeline templates, and automation utilities for infrastructure-as-code projects.</p>"},{"location":"en/infra-ci/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>This repository provides standardized CI/CD components that:</p> <ul> <li>Unify CI/CD Processes across all <code>infra-*</code> repositories</li> <li>Simplify Maintenance by centralizing pipeline logic</li> <li>Enhance Security with integrated secrets management</li> <li>Accelerate Development with ready-to-use templates</li> </ul>"},{"location":"en/infra-ci/#repository-structure","title":"\ud83d\udcc1 Repository Structure","text":"<pre><code>infra-ci/\n\u251c\u2500\u2500 .github/\n\u2502   \u2514\u2500\u2500 workflows/\n\u2502       \u251c\u2500\u2500 validate.yml             # Terraform validation\n\u2502       \u251c\u2500\u2500 deploy.yml               # Deployment template\n\u2502       \u2514\u2500\u2500 reusable/\n\u2502           \u251c\u2500\u2500 terraform-plan.yml   # Reusable Terraform plan\n\u2502           \u251c\u2500\u2500 terraform-apply.yml  # Reusable Terraform apply\n\u2502           \u2514\u2500\u2500 sops-decrypt.yml     # SOPS secrets decryption\n\u251c\u2500\u2500 scripts/\n\u2502   \u251c\u2500\u2500 decrypt.sh                   # SOPS decryption script\n\u2502   \u2514\u2500\u2500 lint.sh                      # Code formatting checks\n\u251c\u2500\u2500 templates/\n\u2502   \u2514\u2500\u2500 README.template.md           # Module README template\n\u251c\u2500\u2500 docs/\n\u2502   \u2514\u2500\u2500 ci-guide.md                  # Usage documentation\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"en/infra-ci/#core-features","title":"\ud83d\udd27 Core Features","text":""},{"location":"en/infra-ci/#1-reusable-workflows","title":"1. Reusable Workflows","text":""},{"location":"en/infra-ci/#terraform-plan-workflow","title":"Terraform Plan Workflow","text":"<pre><code># .github/workflows/reusable/terraform-plan.yml\nname: Terraform Plan\non:\n  workflow_call:\n    inputs:\n      working-directory:\n        required: true\n        type: string\n      environment:\n        required: true\n        type: string\n</code></pre>"},{"location":"en/infra-ci/#terraform-apply-workflow","title":"Terraform Apply Workflow","text":"<pre><code># .github/workflows/reusable/terraform-apply.yml\nname: Terraform Apply\non:\n  workflow_call:\n    inputs:\n      working-directory:\n        required: true\n        type: string\n</code></pre>"},{"location":"en/infra-ci/#sops-decryption-workflow","title":"SOPS Decryption Workflow","text":"<p>Decrypts sensitive files using SOPS before deployment.</p>"},{"location":"en/infra-ci/#2-validation-pipeline","title":"2. Validation Pipeline","text":"<p>Performs automated checks: - \u2705 <code>terraform fmt</code> - Code formatting - \u2705 <code>terraform validate</code> - Configuration validation - \u2705 <code>tflint</code> - Linting (optional)</p>"},{"location":"en/infra-ci/#3-security-features","title":"3. Security Features","text":"<ul> <li>All secrets passed via GitHub Secrets</li> <li>SOPS file decryption via <code>age</code> or KMS</li> <li>Optional Tailscale connectivity for secure deployments</li> </ul>"},{"location":"en/infra-ci/#usage-examples","title":"\ud83d\udcd6 Usage Examples","text":""},{"location":"en/infra-ci/#using-reusable-workflows-in-your-repository","title":"Using Reusable Workflows in Your Repository","text":""},{"location":"en/infra-ci/#example-infra-awsgithubworkflowsdeployyml","title":"Example: infra-aws/.github/workflows/deploy.yml","text":"<pre><code>name: Deploy AWS Infrastructure\non:\n  push:\n    branches: [main]\n  pull_request:\n\njobs:\n  plan:\n    uses: v-grand/infra-ci/.github/workflows/reusable/terraform-plan.yml@main\n    with:\n      working-directory: ./infra\n      environment: dev\n    secrets:\n      AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}\n      AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n\n  apply:\n    needs: plan\n    if: github.ref == 'refs/heads/main'\n    uses: v-grand/infra-ci/.github/workflows/reusable/terraform-apply.yml@main\n    with:\n      working-directory: ./infra\n      environment: dev\n    secrets:\n      AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}\n      AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n</code></pre>"},{"location":"en/infra-ci/#using-sops-decryption","title":"Using SOPS Decryption","text":"<pre><code>name: Deploy with Secrets\non:\n  push:\n    branches: [main]\n\njobs:\n  decrypt-and-deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Decrypt Secrets\n        uses: v-grand/infra-ci/.github/workflows/reusable/sops-decrypt.yml@main\n        with:\n          encrypted-file: secrets.enc.yaml\n          age-key: ${{ secrets.AGE_SECRET_KEY }}\n\n      - name: Deploy Infrastructure\n        run: |\n          terraform init\n          terraform apply -auto-approve\n</code></pre>"},{"location":"en/infra-ci/#required-github-secrets","title":"\ud83d\udd11 Required GitHub Secrets","text":"<p>Configure these secrets in your repository settings:</p>"},{"location":"en/infra-ci/#for-aws-deployments","title":"For AWS Deployments","text":"<ul> <li><code>AWS_ACCESS_KEY_ID</code></li> <li><code>AWS_SECRET_ACCESS_KEY</code></li> <li><code>AWS_REGION</code> (optional)</li> </ul>"},{"location":"en/infra-ci/#for-gcp-deployments","title":"For GCP Deployments","text":"<ul> <li><code>GCP_CREDENTIALS</code> - Service account JSON</li> <li><code>GCP_PROJECT_ID</code></li> <li><code>GCP_REGION</code></li> </ul>"},{"location":"en/infra-ci/#for-sops-decryption","title":"For SOPS Decryption","text":"<ul> <li><code>AGE_SECRET_KEY</code> - Age private key</li> <li><code>SOPS_KMS_ARN</code> - AWS KMS key ARN (if using AWS KMS)</li> <li><code>SOPS_GCP_KMS</code> - GCP KMS key (if using GCP KMS)</li> </ul>"},{"location":"en/infra-ci/#for-tailscale-optional","title":"For Tailscale (Optional)","text":"<ul> <li><code>TAILSCALE_AUTH_KEY</code> - Tailscale authentication key</li> </ul>"},{"location":"en/infra-ci/#security-best-practices","title":"\ud83d\udee1\ufe0f Security Best Practices","text":"<ol> <li>Never commit secrets - Always use GitHub Secrets or SOPS</li> <li>Use least privilege - Grant minimal required permissions</li> <li>Enable branch protection - Require PR reviews for <code>main</code></li> <li>Rotate credentials - Regularly update access keys</li> <li>Audit deployments - Review workflow run logs</li> </ol>"},{"location":"en/infra-ci/#integration-with-other-repositories","title":"\ud83d\udcda Integration with Other Repositories","text":"Repository Integration infra-aws Uses <code>terraform-plan</code> and <code>terraform-apply</code> workflows infra-gcp Uses reusable workflows with GCP credentials infra-k8s Integrates for Helm chart deployments infra-monitoring Uses validation workflows infra-secrets Uses SOPS decryption workflows"},{"location":"en/infra-ci/#getting-started","title":"\ud83d\ude80 Getting Started","text":""},{"location":"en/infra-ci/#1-configure-your-repository","title":"1. Configure Your Repository","text":"<p>Add this workflow to your repository:</p> <pre><code>mkdir -p .github/workflows\ncat &gt; .github/workflows/deploy.yml &lt;&lt; 'EOF'\nname: Deploy Infrastructure\non:\n  push:\n    branches: [main]\n  pull_request:\n\njobs:\n  terraform:\n    uses: v-grand/infra-ci/.github/workflows/reusable/terraform-plan.yml@main\n    with:\n      working-directory: ./\n      environment: dev\nEOF\n</code></pre>"},{"location":"en/infra-ci/#2-configure-secrets","title":"2. Configure Secrets","text":"<p>Navigate to your repository \u2192 Settings \u2192 Secrets and add required secrets.</p>"},{"location":"en/infra-ci/#3-push-and-deploy","title":"3. Push and Deploy","text":"<pre><code>git add .github/workflows/deploy.yml\ngit commit -m \"Add CI/CD pipeline\"\ngit push\n</code></pre>"},{"location":"en/infra-ci/#outcome","title":"\ud83d\udcca Outcome","text":"<p>After implementation: - \u2705 Unified CI/CD pipelines across all repositories - \u2705 Simplified maintenance and updates - \u2705 Enhanced security with secrets management - \u2705 Faster project initiation</p>"},{"location":"en/infra-ci/#related-documentation","title":"\ud83d\udd17 Related Documentation","text":"<ul> <li>Terraform Documentation</li> <li>GitHub Actions</li> <li>SOPS</li> <li>Tailscale</li> </ul>"},{"location":"en/infra-ci/#additional-resources","title":"\ud83d\udcdd Additional Resources","text":"<ul> <li>CI Guide</li> <li>Repository Template</li> </ul>"},{"location":"en/infra-core/","title":"Infra Core","text":""},{"location":"en/infra-core/#infra-core","title":"infra-core","text":"<p>A comprehensive library of reusable Terraform modules designed for multi-cloud infrastructure management. This library supports AWS, GCP, Hetzner, and Contabo, allowing for flexible and agnostic infrastructure deployment.</p>"},{"location":"en/infra-core/#features","title":"\ud83d\ude80 Features","text":"<ul> <li>Multi-Cloud Support: Seamlessly provision resources across major cloud providers.</li> <li>Modular Design: Reusable components for VMs, VPCs, Databases, and more.</li> <li>Best Practices: Built with security and scalability in mind.</li> <li>Tailscale Integration: Easy setup for secure mesh networking.</li> </ul>"},{"location":"en/infra-core/#modules","title":"\ud83d\udce6 Modules","text":"Module Description Supported Providers <code>vm</code> Provision Virtual Machines (EC2, GCE) AWS, GCP <code>vpc</code> Network configuration (VPC, Subnets) AWS, GCP <code>db</code> Managed Databases (RDS, Cloud SQL) AWS, GCP <code>tailscale</code> Tailscale Mesh Networking All <code>k8s</code> Kubernetes Clusters (EKS, GKE) AWS, GCP"},{"location":"en/infra-core/#prerequisites","title":"\ud83d\udee0\ufe0f Prerequisites","text":"<ul> <li>Terraform &gt;= 1.0</li> <li>Cloud Provider Credentials (configured via environment variables or CLI)</li> </ul>"},{"location":"en/infra-core/#usage","title":"\ud83d\udcd6 Usage","text":"<p>Here is a basic example of how to use the <code>vm</code> module in your Terraform configuration:</p> <pre><code>module \"my_web_server\" {\n  source        = \"./modules/vm\" # Or git source\n  provider      = \"aws\"\n  instance_type = \"t3.micro\"\n  ami           = \"ami-0c55b159cbfafe1f0\"\n  tags = {\n    Environment = \"dev\"\n  }\n}\n</code></pre>"},{"location":"en/infra-deployer/","title":"Infra Deployer","text":""},{"location":"en/infra-deployer/#infra-deployer","title":"infra-deployer","text":"<p><code>infra-deployer</code> is a repository template for automated infrastructure deployment based on plug-in <code>infra-*</code> modules. It can be used as a CLI utility or as a REST/gRPC service embedded in CI/CD pipelines or lab environments.</p>"},{"location":"en/infra-deployer/#project-structure","title":"\ud83d\udcc1 Project Structure","text":"<pre><code>infra-deployer/\n\u251c\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 .env.example\n\u251c\u2500\u2500 deploy/\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u251c\u2500\u2500 cli.py\n\u2502   \u251c\u2500\u2500 core.py\n\u2502   \u251c\u2500\u2500 terraform.py\n\u2502   \u251c\u2500\u2500 ansible.py\n\u2502   \u2514\u2500\u2500 config.yaml\n\u251c\u2500\u2500 infra-modules/\n\u2502   \u251c\u2500\u2500 infra-core/ (git submodule)\n\u2502   \u251c\u2500\u2500 infra-network/\n\u2502   \u2514\u2500\u2500 infra-monitoring/\n\u251c\u2500\u2500 scripts/\n\u2502   \u2514\u2500\u2500 run_deploy.sh\n\u251c\u2500\u2500 tests/\n\u2502   \u2514\u2500\u2500 test_core.py\n\u251c\u2500\u2500 .github/\n\u2502   \u2514\u2500\u2500 workflows/\n\u2502       \u2514\u2500\u2500 ci.yml\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"en/infra-deployer/#key-components","title":"\u2699\ufe0f Key Components","text":"<ul> <li>CLI Interface (<code>cli.py</code>): Provides <code>deploy</code>, <code>destroy</code>, <code>plan</code>, and <code>status</code> commands.</li> <li>Terraform/Ansible Wrappers: Manages module execution, logging, and dry-runs.</li> <li><code>infra-*</code> Submodules: Pluggable infrastructure modules.</li> <li><code>Makefile</code>: Commands for <code>run</code>, <code>test</code>, <code>lint</code>, and <code>build</code>.</li> <li>CI/CD: GitHub Actions for testing, linting, and building.</li> </ul>"},{"location":"en/infra-deployer/#testing","title":"\ud83e\uddea Testing","text":"<ul> <li><code>pytest</code> with <code>mock</code> for unit and integration tests.</li> <li>Aims for \u2265 80% test coverage.</li> <li>Validates CLI commands and core logic.</li> </ul>"},{"location":"en/infra-deployer/#documentation","title":"\ud83d\udcda Documentation","text":"<ul> <li><code>README.md</code> with setup instructions, project structure, and module integration guides.</li> <li>Supports configuration via <code>.env</code> and <code>config.yaml</code>.</li> <li>Can be extended to a REST API.</li> </ul>"},{"location":"en/infra-deployer/#integration","title":"\ud83e\udde9 Integration","text":"<ul> <li>Used as a CLI in <code>u-cloud24-platform</code>.</li> <li>Can be called from any CI/CD pipeline.</li> <li>Supports lab scenarios and automation.</li> </ul>"},{"location":"en/infra-deployer/#getting-started","title":"\ud83d\ude80 Getting Started","text":"<p>To use <code>infra-deployer</code> as a template for a new service:</p> <pre><code># Clone the template\ncookiecutter gh:v-grand/infra-deployer-template\n\n# Install dependencies\npip install -r requirements.txt\n\n# Run the CLI\npython -m deploy.cli deploy all\n</code></pre> <p>This template can be used as a basis for creating infrastructure management services, laboratories, CI/CD integrations, and internal platforms.</p>"},{"location":"en/infra-k8s/","title":"Kubernetes","text":""},{"location":"en/infra-k8s/#infra-k8s-kubernetes-infrastructure","title":"infra-k8s: Kubernetes Infrastructure","text":"<p>infra-k8s provides complete Kubernetes cluster deployment and management across GKE, EKS, and K3s with integrated system components and monitoring.</p>"},{"location":"en/infra-k8s/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Deploy and manage Kubernetes clusters:</p> <ul> <li>GKE - Google Kubernetes Engine clusters</li> <li>EKS - Amazon Elastic Kubernetes Service</li> <li>K3s - Lightweight Kubernetes for edge/local</li> <li>Helm Charts - System component deployment</li> <li>GitOps - Continuous deployment integration</li> </ul>"},{"location":"en/infra-k8s/#repository-structure","title":"\ud83d\udcc1 Repository Structure","text":"<pre><code>infra-k8s/\n\u251c\u2500\u2500 modules/\n\u2502   \u251c\u2500\u2500 gke/                  # Google Kubernetes Engine\n\u2502   \u251c\u2500\u2500 eks/                  # AWS EKS\n\u2502   \u251c\u2500\u2500 k3s/                  # K3s deployment\n\u2502   \u2514\u2500\u2500 addons/               # Helm charts &amp; system components\n\u2502       \u251c\u2500\u2500 ingress/          # NGINX/Traefik ingress\n\u2502       \u251c\u2500\u2500 cert-manager/     # Certificate management\n\u2502       \u251c\u2500\u2500 external-dns/     # DNS automation\n\u2502       \u2514\u2500\u2500 prometheus-stack/ # Monitoring stack\n\u251c\u2500\u2500 environments/\n\u2502   \u251c\u2500\u2500 dev/\n\u2502   \u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u2502   \u251c\u2500\u2500 variables.tf\n\u2502   \u2502   \u251c\u2500\u2500 terraform.tfvars.example\n\u2502   \u2502   \u2514\u2500\u2500 backend.tf\n\u2502   \u251c\u2500\u2500 prod/\n\u2502   \u2502   \u2514\u2500\u2500 ...\n\u2502   \u2514\u2500\u2500 k3s-example/          # K3s on GCP VM example\n\u251c\u2500\u2500 manifests/                # Kubernetes manifests\n\u251c\u2500\u2500 helm-values/              # Helm chart values\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"en/infra-k8s/#cluster-modules","title":"\u2638\ufe0f Cluster Modules","text":""},{"location":"en/infra-k8s/#1-gke-google-kubernetes-engine","title":"1. GKE (Google Kubernetes Engine)","text":"<p>Deploy managed Kubernetes on Google Cloud.</p> <p>Features: - Auto-scaling node pools - Regional/zonal clusters - Workload identity - Binary authorization - Network policies - Private clusters</p> <p>Example:</p> <pre><code>module \"gke_cluster\" {\n  source = \"github.com/v-grand/infra-k8s//modules/gke\"\n\n  project_id = var.gcp_project_id\n  region     = \"us-central1\"\n\n  cluster_name    = \"production-gke\"\n  kubernetes_version = \"1.28\"\n\n  # Network configuration\n  network    = module.vpc.network_name\n  subnetwork = module.vpc.subnet_names[0]\n\n  # Enable private cluster\n  enable_private_nodes    = true\n  enable_private_endpoint = false\n  master_ipv4_cidr_block  = \"172.16.0.0/28\"\n\n  # Node pools\n  node_pools = [\n    {\n      name         = \"general-pool\"\n      machine_type = \"n2-standard-4\"\n      min_count    = 1\n      max_count    = 10\n      disk_size_gb = 100\n      disk_type    = \"pd-standard\"\n\n      auto_repair  = true\n      auto_upgrade = true\n\n      preemptible = false\n    },\n    {\n      name         = \"spot-pool\"\n      machine_type = \"n2-standard-4\"\n      min_count    = 0\n      max_count    = 20\n\n      preemptible = true  # Use spot instances\n    }\n  ]\n\n  # Workload Identity\n  enable_workload_identity = true\n\n  # Security\n  enable_network_policy = true\n  enable_pod_security_policy = true\n\n  # Monitoring\n  enable_cloud_logging    = true\n  enable_cloud_monitoring = true\n\n  tags = {\n    Environment = \"production\"\n    ManagedBy   = \"terraform\"\n  }\n}\n</code></pre>"},{"location":"en/infra-k8s/#2-eks-amazon-elastic-kubernetes-service","title":"2. EKS (Amazon Elastic Kubernetes Service)","text":"<p>Deploy managed Kubernetes on AWS.</p> <p>Features: - Managed control plane - Multiple node groups (on-demand + spot) - Pod security policies - IRSA (IAM Roles for Service Accounts) - VPC CNI networking - EBS/EFS integration</p> <p>Example:</p> <pre><code>module \"eks_cluster\" {\n  source = \"github.com/v-grand/infra-k8s//modules/eks\"\n\n  cluster_name    = \"production-eks\"\n  cluster_version = \"1.28\"\n\n  # Network configuration\n  vpc_id     = module.vpc.vpc_id\n  subnet_ids = module.vpc.private_subnet_ids\n\n  # Control plane\n  cluster_endpoint_private_access = true\n  cluster_endpoint_public_access  = true\n\n  # Node groups\n  node_groups = {\n    general = {\n      desired_capacity = 3\n      max_capacity     = 10\n      min_capacity     = 1\n\n      instance_types = [\"t3.large\"]\n      capacity_type  = \"ON_DEMAND\"\n\n      disk_size = 100\n\n      labels = {\n        role = \"general\"\n      }\n\n      tags = {\n        Environment = \"production\"\n      }\n    }\n\n    spot = {\n      desired_capacity = 2\n      max_capacity     = 20\n      min_capacity     = 0\n\n      instance_types = [\"t3.large\", \"t3a.large\"]\n      capacity_type  = \"SPOT\"\n\n      labels = {\n        role = \"spot\"\n      }\n    }\n  }\n\n  # Enable IRSA\n  enable_irsa = true\n\n  # Cluster addons\n  cluster_addons = {\n    coredns = {\n      most_recent = true\n    }\n    kube-proxy = {\n      most_recent = true\n    }\n    vpc-cni = {\n      most_recent = true\n    }\n  }\n\n  tags = {\n    Environment = \"production\"\n    ManagedBy   = \"terraform\"\n  }\n}\n</code></pre>"},{"location":"en/infra-k8s/#3-k3s-lightweight-kubernetes","title":"3. K3s (Lightweight Kubernetes)","text":"<p>Deploy K3s for edge, IoT, or local development.</p> <p>Features: - Minimal resource footprint - Single binary - Embedded SQLite or external DB - Built-in load balancer (Klipper) - Traefik ingress included</p> <p>Example:</p> <pre><code>module \"k3s_cluster\" {\n  source = \"github.com/v-grand/infra-k8s//modules/k3s\"\n\n  # Server nodes\n  server_count = 3\n  server_instance_type = \"e2-medium\"\n\n  # Agent nodes\n  agent_count = 5\n  agent_instance_type = \"e2-standard-2\"\n\n  # Network\n  vpc_id     = module.vpc.vpc_id\n  subnet_ids = module.vpc.private_subnet_ids\n\n  # Storage\n  datastore_endpoint = \"postgres://user:pass@postgres.example.com:5432/k3s\"\n\n  # Options\n  disable_components = [\"traefik\"]  # Use NGINX instead\n\n  # TLS SANs\n  tls_san = [\n    \"k3s.example.com\",\n    \"10.0.0.100\"\n  ]\n\n  tags = {\n    Environment = \"edge\"\n    ManagedBy   = \"terraform\"\n  }\n}\n</code></pre>"},{"location":"en/infra-k8s/#system-addons","title":"\ud83d\udd27 System Addons","text":""},{"location":"en/infra-k8s/#1-ingress-controller","title":"1. Ingress Controller","text":""},{"location":"en/infra-k8s/#nginx-ingress","title":"NGINX Ingress","text":"<pre><code>module \"nginx_ingress\" {\n  source = \"github.com/v-grand/infra-k8s//modules/addons/ingress\"\n\n  ingress_type = \"nginx\"\n  namespace    = \"ingress-nginx\"\n\n  # Helm values\n  values = {\n    controller = {\n      replicaCount = 3\n\n      service = {\n        type = \"LoadBalancer\"\n        annotations = {\n          \"service.beta.kubernetes.io/aws-load-balancer-type\" = \"nlb\"\n        }\n      }\n\n      resources = {\n        requests = {\n          cpu    = \"100m\"\n          memory = \"128Mi\"\n        }\n        limits = {\n          cpu    = \"200m\"\n          memory = \"256Mi\"\n        }\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"en/infra-k8s/#traefik-ingress","title":"Traefik Ingress","text":"<pre><code>module \"traefik_ingress\" {\n  source = \"github.com/v-grand/infra-k8s//modules/addons/ingress\"\n\n  ingress_type = \"traefik\"\n  namespace    = \"traefik\"\n\n  values = {\n    deployment = {\n      replicas = 3\n    }\n\n    service = {\n      type = \"LoadBalancer\"\n    }\n\n    providers = {\n      kubernetesCRD = {\n        enabled = true\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"en/infra-k8s/#2-cert-manager","title":"2. Cert-Manager","text":"<p>Automatic TLS certificate management.</p> <pre><code>module \"cert_manager\" {\n  source = \"github.com/v-grand/infra-k8s//modules/addons/cert-manager\"\n\n  namespace = \"cert-manager\"\n\n  # Let's Encrypt issuers\n  letsencrypt_email = \"admin@example.com\"\n\n  # Create staging and production issuers\n  create_cluster_issuers = true\n\n  values = {\n    installCRDs = true\n\n    resources = {\n      requests = {\n        cpu    = \"10m\"\n        memory = \"32Mi\"\n      }\n    }\n  }\n}\n</code></pre> <p>ClusterIssuer Example:</p> <pre><code>apiVersion: cert-manager.io/v1\nkind: ClusterIssuer\nmetadata:\n  name: letsencrypt-prod\nspec:\n  acme:\n    server: https://acme-v02.api.letsencrypt.org/directory\n    email: admin@example.com\n    privateKeySecretRef:\n      name: letsencrypt-prod\n    solvers:\n    - http01:\n        ingress:\n          class: nginx\n</code></pre>"},{"location":"en/infra-k8s/#3-external-dns","title":"3. External-DNS","text":"<p>Automatic DNS record management.</p> <pre><code>module \"external_dns\" {\n  source = \"github.com/v-grand/infra-k8s//modules/addons/external-dns\"\n\n  namespace = \"external-dns\"\n\n  # Provider configuration\n  provider = \"google\"  # or \"aws\", \"cloudflare\"\n\n  # Google Cloud DNS\n  google_project = var.gcp_project_id\n\n  # Domain filters\n  domain_filters = [\"example.com\", \"*.example.com\"]\n\n  # Policy\n  policy = \"sync\"  # or \"upsert-only\"\n\n  values = {\n    resources = {\n      requests = {\n        cpu    = \"10m\"\n        memory = \"32Mi\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"en/infra-k8s/#4-kube-prometheus-stack","title":"4. Kube Prometheus Stack","text":"<p>Complete monitoring solution.</p> <pre><code>module \"prometheus_stack\" {\n  source = \"github.com/v-grand/infra-k8s//modules/addons/prometheus-stack\"\n\n  namespace = \"monitoring\"\n\n  # Prometheus\n  prometheus = {\n    retention = \"30d\"\n    storage_size = \"50Gi\"\n    storage_class = \"standard\"\n\n    resources = {\n      requests = {\n        cpu    = \"500m\"\n        memory = \"2Gi\"\n      }\n      limits = {\n        cpu    = \"1000m\"\n        memory = \"4Gi\"\n      }\n    }\n  }\n\n  # Grafana\n  grafana = {\n    enabled = true\n    admin_password = var.grafana_admin_password\n\n    ingress = {\n      enabled = true\n      host    = \"grafana.example.com\"\n      tls     = true\n    }\n  }\n\n  # AlertManager\n  alertmanager = {\n    enabled = true\n\n    config = {\n      receivers = [\n        {\n          name = \"slack\"\n          slack_configs = [\n            {\n              api_url = var.slack_webhook_url\n              channel = \"#alerts\"\n            }\n          ]\n        }\n      ]\n    }\n  }\n}\n</code></pre>"},{"location":"en/infra-k8s/#quick-start","title":"\ud83d\ude80 Quick Start","text":""},{"location":"en/infra-k8s/#deploy-gke-cluster","title":"Deploy GKE Cluster","text":"<pre><code># Clone repository\ngit clone https://github.com/v-grand/infra-k8s.git\ncd infra-k8s/environments/prod\n\n# Configure\ncp terraform.tfvars.example terraform.tfvars\n# Edit terraform.tfvars\n\n# Deploy\nterraform init\nterraform apply\n\n# Get kubeconfig\ngcloud container clusters get-credentials production-gke \\\n  --region=us-central1 \\\n  --project=my-project\n</code></pre>"},{"location":"en/infra-k8s/#deploy-eks-cluster","title":"Deploy EKS Cluster","text":"<pre><code>cd infra-k8s/environments/prod\n\n# Configure\ncp terraform.tfvars.example terraform.tfvars\n# Edit terraform.tfvars\n\n# Deploy\nterraform init\nterraform apply\n\n# Get kubeconfig\naws eks update-kubeconfig \\\n  --name production-eks \\\n  --region us-east-1\n</code></pre>"},{"location":"en/infra-k8s/#install-system-components","title":"Install System Components","text":"<pre><code># Install NGINX Ingress\nkubectl apply -f manifests/nginx-ingress.yaml\n\n# Install Cert-Manager\nkubectl apply -f manifests/cert-manager.yaml\n\n# Install External-DNS\nkubectl apply -f manifests/external-dns.yaml\n\n# Install Prometheus Stack\nhelm install kube-prometheus-stack prometheus-community/kube-prometheus-stack \\\n  -f helm-values/prometheus-stack.yaml \\\n  -n monitoring --create-namespace\n</code></pre>"},{"location":"en/infra-k8s/#best-practices","title":"\ud83d\udcda Best Practices","text":"<ol> <li>Resource Limits - Always set resource requests/limits</li> <li>Pod Disruption Budgets - Ensure high availability</li> <li>Network Policies - Implement zero-trust networking</li> <li>RBAC - Use least privilege access</li> <li>Image Security - Scan images, use admission controllers</li> <li>Secrets Management - Use external secrets operators</li> <li>Backup - Regular etcd/cluster backups</li> <li>Multi-AZ - Deploy across availabil zones</li> </ol>"},{"location":"en/infra-k8s/#integration-examples","title":"\ud83d\udd17 Integration Examples","text":""},{"location":"en/infra-k8s/#with-infra-monitoring","title":"With infra-monitoring","text":"<pre><code># Deploy monitoring to K8s\nmodule \"monitoring\" {\n  source = \"github.com/v-grand/infra-monitoring//modules/prometheus\"\n\n  deploy_to_k8s = true\n  k8s_namespace = \"monitoring\"\n\n  # Use K8s service discovery\n  prometheus_config = templatefile(\"prometheus-k8s.yaml\", {\n    cluster_name = module.gke_cluster.cluster_name\n  })\n}\n</code></pre>"},{"location":"en/infra-k8s/#with-infra-secrets","title":"With infra-secrets","text":"<pre><code># Integrate Vault with K8s\nmodule \"vault_k8s\" {\n  source = \"github.com/v-grand/infra-secrets//modules/vault-k8s\"\n\n  vault_address = \"https://vault.example.com\"\n\n  # Create Kubernetes auth backend\n  k8s_host = module.gke_cluster.endpoint\n  k8s_ca_cert = module.gke_cluster.ca_certificate\n}\n</code></pre>"},{"location":"en/infra-k8s/#documentation","title":"\ud83d\udcd6 Documentation","text":"<ul> <li>Kubernetes Documentation</li> <li>GKE Documentation</li> <li>EKS Documentation</li> <li>K3s Documentation</li> </ul>"},{"location":"en/infra-k8s/#related-repositories","title":"\ud83d\udd17 Related Repositories","text":"<ul> <li>infra-core - Infrastructure modules</li> <li>infra-network - Network configuration</li> <li>infra-monitoring - Monitoring integration</li> <li>infra-secrets - Secrets management</li> </ul>"},{"location":"en/infra-monitoring/","title":"Monitoring","text":""},{"location":"en/infra-monitoring/#infra-monitoring-observability-stack","title":"infra-monitoring: Observability Stack","text":"<p>infra-monitoring provides a complete observability solution with metrics collection, logging, and visualization for cloud infrastructure.</p>"},{"location":"en/infra-monitoring/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Deploy and manage a comprehensive monitoring stack:</p> <ul> <li>Prometheus - Metrics collection and alerting</li> <li>Grafana - Visualization and dashboards</li> <li>Loki - Log aggregation and querying</li> <li>Exporters - Node, cloud, and application metrics</li> </ul>"},{"location":"en/infra-monitoring/#repository-structure","title":"\ud83d\udcc1 Repository Structure","text":"<pre><code>infra-monitoring/\n\u251c\u2500\u2500 modules/\n\u2502   \u251c\u2500\u2500 prometheus/         # Prometheus setup\n\u2502   \u251c\u2500\u2500 grafana/            # Grafana with dashboards\n\u2502   \u251c\u2500\u2500 loki/               # Loki log aggregation\n\u2502   \u2514\u2500\u2500 exporters/          # Various exporters\n\u251c\u2500\u2500 environments/\n\u2502   \u251c\u2500\u2500 dev/\n\u2502   \u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u2502   \u251c\u2500\u2500 variables.tf\n\u2502   \u2502   \u251c\u2500\u2500 terraform.tfvars.example\n\u2502   \u2502   \u2514\u2500\u2500 backend.tf\n\u2502   \u2514\u2500\u2500 prod/\n\u2502       \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 dashboards/             # Pre-configured Grafana dashboards\n\u251c\u2500\u2500 alert_rules.yml         # Prometheus alerting rules\n\u251c\u2500\u2500 docker-compose.yml      # Local development setup\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"en/infra-monitoring/#components","title":"\ud83d\udcca Components","text":""},{"location":"en/infra-monitoring/#1-prometheus","title":"1. Prometheus","text":"<p>Time-series metrics database with powerful querying and alerting.</p> <p>Features: - Multi-dimensional metrics - PromQL query language - Alert manager integration - Service discovery - Long-term storage</p> <p>Example Configuration:</p> <pre><code># prometheus.yml\nglobal:\n  scrape_interval: 15s\n  evaluation_interval: 15s\n\nscrape_configs:\n  - job_name: 'prometheus'\n    static_configs:\n      - targets: ['localhost:9090']\n\n  - job_name: 'node-exporter'\n    static_configs:\n      - targets: ['node-exporter:9100']\n\n  - job_name: 'gcp-monitoring'\n    static_configs:\n      - targets: ['gcp-exporter:9090']\n</code></pre>"},{"location":"en/infra-monitoring/#2-grafana","title":"2. Grafana","text":"<p>Visualization and analytics platform.</p> <p>Features: - Rich dashboards - Multiple data sources - Alerting - User management - Dashboard versioning</p> <p>Pre-configured Dashboards: - Infrastructure Overview - CPU, Memory, Disk, Network - Application Metrics - Request rates, latencies, errors - Kubernetes Monitoring - Pod/node metrics - Database Performance - Query performance, connections - Cloud Costs - Cost tracking and optimization</p>"},{"location":"en/infra-monitoring/#3-loki","title":"3. Loki","text":"<p>Horizontally-scalable log aggregation system.</p> <p>Features: - Label-based indexing - LogQL query language - Integration with Grafana - Low cost storage - Promtail agent</p> <p>Example Configuration:</p> <pre><code># loki-config.yaml\nauth_enabled: false\n\nserver:\n  http_listen_port: 3100\n\ningester:\n  lifecycler:\n    address: 127.0.0.1\n    ring:\n      kvstore:\n        store: inmemory\n      replication_factor: 1\n  chunk_idle_period: 5m\n  chunk_retain_period: 30s\n\nschema_config:\n  configs:\n    - from: 2020-10-24\n      store: boltdb\n      object_store: filesystem\n      schema: v11\n      index:\n        prefix: index_\n        period: 168h\n</code></pre>"},{"location":"en/infra-monitoring/#4-exporters","title":"4. Exporters","text":"<p>Collect metrics from various sources.</p> <p>Available Exporters: - Node Exporter - System metrics (CPU, memory, disk) - cAdvisor - Container metrics - Blackbox Exporter - Endpoint monitoring - Cloud Exporters - AWS CloudWatch, GCP Monitoring - Database Exporters - PostgreSQL, MySQL, Redis</p>"},{"location":"en/infra-monitoring/#quick-start","title":"\ud83d\ude80 Quick Start","text":""},{"location":"en/infra-monitoring/#local-development-with-docker-compose","title":"Local Development with Docker Compose","text":"<pre><code># Clone repository\ngit clone https://github.com/v-grand/infra-monitoring.git\ncd infra-monitoring\n\n# Configure environment\ncp .env.example .env\n# Edit .env with your settings\n\n# Start stack\ndocker-compose up -d\n\n# Access services\n# Grafana: http://localhost:3000 (admin/admin)\n# Prometheus: http://localhost:9090\n# Loki: http://localhost:3100\n</code></pre>"},{"location":"en/infra-monitoring/#production-deployment-with-terraform","title":"Production Deployment with Terraform","text":"<pre><code>cd environments/prod\ncp terraform.tfvars.example terraform.tfvars\n\n# Edit terraform.tfvars\nterraform init\nterraform plan\nterraform apply\n</code></pre>"},{"location":"en/infra-monitoring/#grafana-dashboards","title":"\ud83d\udcc8 Grafana Dashboards","text":""},{"location":"en/infra-monitoring/#1-infrastructure-overview-dashboard","title":"1. Infrastructure Overview Dashboard","text":"<p>Monitors overall infrastructure health: - CPU usage across all instances - Memory utilization - Disk I/O and capacity - Network traffic - System load averages</p> <p>Import ID: <code>1860</code> (Node Exporter Full)</p>"},{"location":"en/infra-monitoring/#2-application-performance-dashboard","title":"2. Application Performance Dashboard","text":"<p>Tracks application metrics: - Request rate and latency - Error rates (4xx, 5xx) - Database query performance - Cache hit ratios - Queue depths</p>"},{"location":"en/infra-monitoring/#3-kubernetes-dashboard","title":"3. Kubernetes Dashboard","text":"<p>Kubernetes cluster monitoring: - Node status and resources - Pod health and restarts - Deployment status - Resource quotas - Persistent volume usage</p> <p>Import ID: <code>15759</code> (Kubernetes cluster monitoring)</p>"},{"location":"en/infra-monitoring/#4-cost-monitoring-dashboard","title":"4. Cost Monitoring Dashboard","text":"<p>Track cloud spending: - Daily/monthly costs by service - Resource utilization vs. cost - Cost predictions - Budget alerts</p>"},{"location":"en/infra-monitoring/#alerting-rules","title":"\ud83d\udd14 Alerting Rules","text":""},{"location":"en/infra-monitoring/#example-alert-rules","title":"Example Alert Rules","text":"<pre><code># alert_rules.yml\ngroups:\n  - name: infrastructure_alerts\n    interval: 30s\n    rules:\n      - alert: HighCPUUsage\n        expr: 100 - (avg by(instance) (irate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100) &gt; 80\n        for: 5m\n        labels:\n          severity: warning\n        annotations:\n          summary: \"High CPU usage on {{ $labels.instance }}\"\n          description: \"CPU usage is above 80% (current value: {{ $value }}%)\"\n\n      - alert: HighMemoryUsage\n        expr: (node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) / node_memory_MemTotal_bytes * 100 &gt; 90\n        for: 5m\n        labels:\n          severity: critical\n        annotations:\n          summary: \"High memory usage on {{ $labels.instance }}\"\n          description: \"Memory usage is above 90% (current value: {{ $value }}%)\"\n\n      - alert: DiskSpaceLow\n        expr: (node_filesystem_avail_bytes / node_filesystem_size_bytes) * 100 &lt; 10\n        for: 5m\n        labels:\n          severity: warning\n        annotations:\n          summary: \"Low disk space on {{ $labels.instance }}\"\n          description: \"Disk space is below 10% (current value: {{ $value }}%)\"\n\n      - alert: ServiceDown\n        expr: up == 0\n        for: 2m\n        labels:\n          severity: critical\n        annotations:\n          summary: \"Service {{ $labels.job }} is down\"\n          description: \"{{ $labels.instance }} has been down for more than 2 minutes\"\n</code></pre>"},{"location":"en/infra-monitoring/#alertmanager-configuration","title":"AlertManager Configuration","text":"<pre><code># alertmanager.yml\nglobal:\n  resolve_timeout: 5m\n\nroute:\n  group_by: ['alertname', 'cluster', 'service']\n  group_wait: 10s\n  group_interval: 10s\n  repeat_interval: 12h\n  receiver: 'default'\n  routes:\n    - match:\n        severity: critical\n      receiver: 'critical-alerts'\n    - match:\n        severity: warning\n      receiver: 'warning-alerts'\n\nreceivers:\n  - name: 'default'\n    slack_configs:\n      - api_url: 'YOUR_SLACK_WEBHOOK_URL'\n        channel: '#alerts'\n\n  - name: 'critical-alerts'\n    slack_configs:\n      - api_url: 'YOUR_SLACK_WEBHOOK_URL'\n        channel: '#critical-alerts'\n    pagerduty_configs:\n      - service_key: 'YOUR_PAGERDUTY_KEY'\n\n  - name: 'warning-alerts'\n    slack_configs:\n      - api_url: 'YOUR_SLACK_WEBHOOK_URL'\n        channel: '#warnings'\n</code></pre>"},{"location":"en/infra-monitoring/#integration-examples","title":"\ud83d\udd17 Integration Examples","text":""},{"location":"en/infra-monitoring/#with-infra-aws","title":"With infra-aws","text":"<pre><code># Deploy monitoring to AWS\nmodule \"monitoring\" {\n  source = \"github.com/v-grand/infra-monitoring//modules/prometheus\"\n\n  vpc_id    = module.vpc.vpc_id\n  subnet_id = module.vpc.private_subnet_ids[0]\n\n  instance_type = \"t3.medium\"\n\n  scrape_targets = [\n    \"http://app-server-1:9100\",\n    \"http://app-server-2:9100\"\n  ]\n}\n</code></pre>"},{"location":"en/infra-monitoring/#with-infra-k8s","title":"With infra-k8s","text":"<pre><code># Deploy to Kubernetes\nmodule \"prometheus_helm\" {\n  source = \"github.com/v-grand/infra-monitoring//modules/prometheus\"\n\n  deploy_to_k8s = true\n  namespace      = \"monitoring\"\n\n  storage_class = \"standard\"\n  storage_size  = \"50Gi\"\n\n  grafana_enabled     = true\n  alertmanager_enabled = true\n}\n</code></pre>"},{"location":"en/infra-monitoring/#with-infra-gcp","title":"With infra-gcp","text":"<pre><code># Integrate with GCP monitoring\nmodule \"gcp_monitoring\" {\n  source = \"github.com/v-grand/infra-monitoring//modules/gcp-exporter\"\n\n  project_id = var.gcp_project_id\n\n  export_metrics = [\n    \"compute.googleapis.com/instance/cpu/utilization\",\n    \"compute.googleapis.com/instance/network/received_bytes_count\"\n  ]\n}\n</code></pre>"},{"location":"en/infra-monitoring/#security-configuration","title":"\ud83d\udee1\ufe0f Security Configuration","text":""},{"location":"en/infra-monitoring/#authentication","title":"Authentication","text":"<pre><code># Grafana authentication\nenvironment = {\n  GF_AUTH_GENERIC_OAUTH_ENABLED      = \"true\"\n  GF_AUTH_GENERIC_OAUTH_CLIENT_ID    = var.oauth_client_id\n  GF_AUTH_GENERIC_OAUTH_CLIENT_SECRET = var.oauth_client_secret\n  GF_AUTH_GENERIC_OAUTH_SCOPES       = \"openid email profile\"\n}\n</code></pre>"},{"location":"en/infra-monitoring/#tlsssl","title":"TLS/SSL","text":"<pre><code># Prometheus with TLS\ntls_config:\n  cert_file: /etc/prometheus/certs/prometheus.crt\n  key_file: /etc/prometheus/certs/prometheus.key\n  client_ca_file: /etc/prometheus/certs/ca.crt\n</code></pre>"},{"location":"en/infra-monitoring/#best-practices","title":"\ud83d\udcda Best Practices","text":"<ol> <li>Retention Policies - Configure appropriate data retention</li> <li>High Availability - Deploy redundant Prometheus instances</li> <li>Storage - Use persistent volumes for data</li> <li>Scrape Intervals - Balance between granularity and load</li> <li>Label Cardinality - Avoid high-cardinality labels</li> <li>Dashboard Organization - Use folders and tags</li> </ol>"},{"location":"en/infra-monitoring/#documentation","title":"\ud83d\udcd6 Documentation","text":"<ul> <li>Prometheus Documentation</li> <li>Grafana Documentation</li> <li>Loki Documentation</li> </ul>"},{"location":"en/infra-monitoring/#related-repositories","title":"\ud83d\udd17 Related Repositories","text":"<ul> <li>infra-core - Infrastructure modules</li> <li>infra-k8s - Kubernetes integration</li> <li>infra-network - Network configuration</li> </ul>"},{"location":"en/infra-network/","title":"Network","text":""},{"location":"en/infra-network/#infra-network-network-infrastructure","title":"infra-network: Network Infrastructure","text":"<p>infra-network provides comprehensive network infrastructure modules including VPC configuration, VPN setup, and Tailscale mesh networking across cloud providers.</p>"},{"location":"en/infra-network/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>This repository manages network infrastructure:</p> <ul> <li>VPC Configuration - Virtual Private Clouds for AWS and GCP</li> <li>VPN Setup - Site-to-site and client VPN configurations</li> <li>Tailscale Integration - Zero-config mesh networking</li> <li>Multi-Cloud Networking - Consistent networking across clouds</li> </ul>"},{"location":"en/infra-network/#repository-structure","title":"\ud83d\udcc1 Repository Structure","text":"<pre><code>infra-network/\n\u251c\u2500\u2500 modules/\n\u2502   \u251c\u2500\u2500 vpc-aws/              # AWS VPC module\n\u2502   \u251c\u2500\u2500 vpc-gcp/              # GCP VPC module\n\u2502   \u251c\u2500\u2500 vpn/                  # VPN configurations\n\u2502   \u2514\u2500\u2500 tailscale/            # Tailscale mesh networking\n\u251c\u2500\u2500 environments/\n\u2502   \u251c\u2500\u2500 dev/\n\u2502   \u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u2502   \u251c\u2500\u2500 variables.tf\n\u2502   \u2502   \u251c\u2500\u2500 terraform.tfvars.example\n\u2502   \u2502   \u2514\u2500\u2500 backend.tf\n\u2502   \u2514\u2500\u2500 prod/\n\u2502       \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 .github/\n\u2502   \u2514\u2500\u2500 workflows/\n\u2502       \u2514\u2500\u2500 deploy.yml        # CI/CD pipeline\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"en/infra-network/#modules","title":"\ud83c\udf10 Modules","text":""},{"location":"en/infra-network/#1-vpc-module-aws","title":"1. VPC Module (AWS)","text":"<p>Create AWS Virtual Private Clouds with subnets, route tables, and internet gateways.</p> <p>Example Usage:</p> <pre><code>module \"vpc_aws\" {\n  source = \"github.com/v-grand/infra-network//modules/vpc-aws\"\n\n  vpc_cidr             = \"10.0.0.0/16\"\n  availability_zones   = [\"us-east-1a\", \"us-east-1b\"]\n  public_subnet_cidrs  = [\"10.0.1.0/24\", \"10.0.2.0/24\"]\n  private_subnet_cidrs = [\"10.0.10.0/24\", \"10.0.11.0/24\"]\n\n  enable_nat_gateway = true\n  enable_dns_hostnames = true\n\n  tags = {\n    Environment = \"production\"\n    ManagedBy   = \"terraform\"\n  }\n}\n</code></pre>"},{"location":"en/infra-network/#2-vpc-module-gcp","title":"2. VPC Module (GCP)","text":"<p>Create GCP Virtual Private Clouds with custom subnets and firewall rules.</p> <p>Example Usage:</p> <pre><code>module \"vpc_gcp\" {\n  source = \"github.com/v-grand/infra-network//modules/vpc-gcp\"\n\n  project_id   = \"my-gcp-project\"\n  network_name = \"main-vpc\"\n\n  subnets = [\n    {\n      subnet_name   = \"subnet-01\"\n      subnet_ip     = \"10.10.10.0/24\"\n      subnet_region = \"us-central1\"\n    },\n    {\n      subnet_name   = \"subnet-02\"\n      subnet_ip     = \"10.10.20.0/24\"\n      subnet_region = \"us-east1\"\n    }\n  ]\n\n  firewall_rules = [\n    {\n      name        = \"allow-ssh\"\n      direction   = \"INGRESS\"\n      ranges      = [\"0.0.0.0/0\"]\n      allow_ports = [\"22\"]\n      protocol    = \"tcp\"\n    }\n  ]\n}\n</code></pre>"},{"location":"en/infra-network/#3-vpn-module","title":"3. VPN Module","text":"<p>Configure site-to-site VPN connections between clouds.</p> <p>Example Usage:</p> <pre><code>module \"vpn\" {\n  source = \"github.com/v-grand/infra-network//modules/vpn\"\n\n  vpn_type = \"site-to-site\"\n\n  local_network  = \"10.0.0.0/16\"\n  remote_network = \"10.10.0.0/16\"\n\n  peer_ip_address = \"203.0.113.1\"\n  shared_secret   = var.vpn_shared_secret\n\n  tags = {\n    Environment = \"production\"\n  }\n}\n</code></pre>"},{"location":"en/infra-network/#4-tailscale-module","title":"4. Tailscale Module","text":"<p>Deploy Tailscale for zero-config mesh networking.</p> <p>Example Usage:</p> <pre><code>module \"tailscale\" {\n  source = \"github.com/v-grand/infra-network//modules/tailscale\"\n\n  auth_key    = var.tailscale_auth_key\n  hostname    = \"app-server-01\"\n  advertise_routes = [\"10.0.0.0/16\"]\n  accept_routes    = true\n\n  enable_ssh = true\n}\n</code></pre>"},{"location":"en/infra-network/#quick-start","title":"\ud83d\ude80 Quick Start","text":""},{"location":"en/infra-network/#1-clone-the-repository","title":"1. Clone the Repository","text":"<pre><code>git clone https://github.com/v-grand/infra-network.git\ncd infra-network\n</code></pre>"},{"location":"en/infra-network/#2-configure-environment","title":"2. Configure Environment","text":"<pre><code>cd environments/dev\ncp terraform.tfvars.example terraform.tfvars\n</code></pre> <p>Edit <code>terraform.tfvars</code>:</p> <pre><code># AWS Configuration\naws_region = \"us-east-1\"\nvpc_cidr   = \"10.0.0.0/16\"\n\n# GCP Configuration\ngcp_project = \"my-project-id\"\ngcp_region  = \"us-central1\"\n\n# Tailscale\ntailscale_auth_key = \"tskey-xxxxxxxxxxxxx\"\n</code></pre>"},{"location":"en/infra-network/#3-deploy","title":"3. Deploy","text":"<pre><code>terraform init\nterraform plan\nterraform apply\n</code></pre>"},{"location":"en/infra-network/#security-configuration","title":"\ud83d\udd10 Security Configuration","text":""},{"location":"en/infra-network/#firewall-rules","title":"Firewall Rules","text":"<p>AWS Security Groups:</p> <pre><code>resource \"aws_security_group\" \"web\" {\n  name        = \"web-server\"\n  description = \"Allow HTTP/HTTPS inbound traffic\"\n  vpc_id      = module.vpc_aws.vpc_id\n\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n</code></pre> <p>GCP Firewall Rules:</p> <pre><code>resource \"google_compute_firewall\" \"web\" {\n  name    = \"allow-web\"\n  network = module.vpc_gcp.network_name\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"80\", \"443\"]\n  }\n\n  source_ranges = [\"0.0.0.0/0\"]\n  target_tags   = [\"web-server\"]\n}\n</code></pre>"},{"location":"en/infra-network/#network-architecture","title":"\ud83d\udcca Network Architecture","text":""},{"location":"en/infra-network/#multi-cloud-design","title":"Multi-Cloud Design","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502             Tailscale Mesh Network              \u2502\n\u2502                 (10.100.0.0/16)                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                    \u25b2         \u25b2\n                    \u2502         \u2502\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502                                \u2502\n    \u250c\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2510                    \u250c\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502   AWS    \u2502                    \u2502   GCP    \u2502\n    \u2502   VPC    \u2502\u25c4\u2500\u2500\u2500\u2500\u2500 VPN \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502   VPC    \u2502\n    \u250210.0.0.0/16                    \u250210.10.0.0/16\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"en/infra-network/#integration-examples","title":"\ud83d\udd17 Integration Examples","text":""},{"location":"en/infra-network/#with-infra-aws","title":"With infra-aws","text":"<pre><code># infra-aws/main.tf\nmodule \"network\" {\n  source = \"github.com/v-grand/infra-network//modules/vpc-aws\"\n\n  vpc_cidr = var.vpc_cidr\n  # ... configuration\n}\n\nmodule \"app_server\" {\n  source = \"github.com/v-grand/infra-core//modules/vm\"\n\n  subnet_id         = module.network.public_subnet_ids[0]\n  security_group_id = module.network.default_security_group_id\n  # ... configuration\n}\n</code></pre>"},{"location":"en/infra-network/#with-infra-gcp","title":"With infra-gcp","text":"<pre><code># infra-gcp/main.tf\nmodule \"network\" {\n  source = \"github.com/v-grand/infra-network//modules/vpc-gcp\"\n\n  project_id = var.gcp_project_id\n  # ... configuration\n}\n\nmodule \"app_server\" {\n  source = \"github.com/v-grand/infra-core//modules/vm\"\n\n  network    = module.network.network_name\n  subnetwork = module.network.subnet_names[0]\n  # ... configuration\n}\n</code></pre>"},{"location":"en/infra-network/#best-practices","title":"\ud83d\udcda Best Practices","text":"<ol> <li>CIDR Planning - Plan IP ranges carefully to avoid conflicts</li> <li>Subnet Segmentation - Separate public/private/data subnets</li> <li>NAT Gateways - Use NAT for private subnet internet access</li> <li>VPN Encryption - Always use strong encryption for VPN</li> <li>Tailscale ACLs - Configure access control lists properly</li> <li>Transit Gateways - For complex multi-VPC architectures</li> </ol>"},{"location":"en/infra-network/#variables","title":"\ud83d\udee0\ufe0f Variables","text":""},{"location":"en/infra-network/#common-variables","title":"Common Variables","text":"Variable Description Default <code>vpc_cidr</code> CIDR block for VPC <code>10.0.0.0/16</code> <code>availability_zones</code> List of AZs <code>[]</code> <code>enable_nat_gateway</code> Enable NAT gateway <code>true</code> <code>enable_vpn_gateway</code> Enable VPN gateway <code>false</code> <code>tailscale_auth_key</code> Tailscale authentication key <code>\"\"</code>"},{"location":"en/infra-network/#documentation","title":"\ud83d\udcd6 Documentation","text":"<ul> <li>VPC Design Patterns</li> <li>GCP Networking</li> <li>Tailscale Documentation</li> </ul>"},{"location":"en/infra-network/#related-repositories","title":"\ud83d\udd17 Related Repositories","text":"<ul> <li>infra-core - Reusable Terraform modules</li> <li>infra-aws - AWS infrastructure</li> <li>infra-gcp - GCP infrastructure</li> <li>infra-monitoring - Connect monitoring across networks</li> </ul>"},{"location":"en/infra-secrets/","title":"Secrets Management","text":""},{"location":"en/infra-secrets/#infra-secrets-secrets-management","title":"infra-secrets: Secrets Management","text":"<p>infra-secrets provides centralized, secure secrets management using HashiCorp Vault, SOPS, and cloud-native secret managers.</p>"},{"location":"en/infra-secrets/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Centralize and secure sensitive data:</p> <ul> <li>HashiCorp Vault - Dynamic secrets and encryption</li> <li>SOPS - Encrypted file storage with version control</li> <li>GCP Secret Manager - Native GCP secrets integration</li> <li>AWS Secrets Manager - Native AWS secrets integration</li> </ul>"},{"location":"en/infra-secrets/#repository-structure","title":"\ud83d\udcc1 Repository Structure","text":"<pre><code>infra-secrets/\n\u251c\u2500\u2500 modules/\n\u2502   \u251c\u2500\u2500 vault/              # HashiCorp Vault deployment\n\u2502   \u251c\u2500\u2500 sops/               # SOPS integration\n\u2502   \u251c\u2500\u2500 gcp-secrets/        # GCP Secret Manager\n\u2502   \u2514\u2500\u2500 aws-secrets/        # AWS Secrets Manager\n\u251c\u2500\u2500 environments/\n\u2502   \u251c\u2500\u2500 dev/\n\u2502   \u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u2502   \u251c\u2500\u2500 variables.tf\n\u2502   \u2502   \u251c\u2500\u2500 terraform.tfvars.example\n\u2502   \u2502   \u251c\u2500\u2500 backend.tf\n\u2502   \u2502   \u2514\u2500\u2500 secrets.enc.yaml  # Encrypted secrets\n\u2502   \u2514\u2500\u2500 prod/\n\u2502       \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 policies/               # Vault policies\n\u251c\u2500\u2500 scripts/\n\u2502   \u251c\u2500\u2500 vault-init.sh       # Vault initialization\n\u2502   \u251c\u2500\u2500 sops-encrypt.sh     # SOPS encryption helper\n\u2502   \u2514\u2500\u2500 sops-decrypt.sh     # SOPS decryption helper\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"en/infra-secrets/#modules","title":"\ud83d\udd10 Modules","text":""},{"location":"en/infra-secrets/#1-hashicorp-vault","title":"1. HashiCorp Vault","text":"<p>Enterprise-grade secrets management with dynamic secrets.</p> <p>Features: - KV Secrets Engine (v2) - Dynamic secrets (AWS, GCP, databases) - Transit encryption engine - AppRole authentication - Token-based auth - Audit logging</p> <p>Example Deployment:</p> <pre><code>module \"vault\" {\n  source = \"github.com/v-grand/infra-secrets//modules/vault\"\n\n  mode = \"ha\"  # or \"dev\" for development\n\n  # HA configuration\n  storage_backend = \"consul\"\n  consul_address  = \"consul.example.com:8500\"\n\n  # Auto-unseal with GCP KMS\n  auto_unseal = true\n  kms_project = var.gcp_project\n  kms_region  = \"global\"\n  kms_keyring = \"vault-keyring\"\n  kms_key     = \"vault-key\"\n\n  # TLS configuration\n  tls_cert_file = \"/vault/tls/vault.crt\"\n  tls_key_file  = \"/vault/tls/vault.key\"\n\n  tags = {\n    Environment = \"production\"\n    ManagedBy   = \"terraform\"\n  }\n}\n</code></pre> <p>Vault Policy Example:</p> <pre><code># policies/app-policy.hcl\npath \"secret/data/app/*\" {\n  capabilities = [\"read\", \"list\"]\n}\n\npath \"database/creds/app-db\" {\n  capabilities = [\"read\"]\n}\n\npath \"transit/encrypt/app\" {\n  capabilities = [\"update\"]\n}\n\npath \"transit/decrypt/app\" {\n  capabilities = [\"update\"]\n}\n</code></pre>"},{"location":"en/infra-secrets/#2-sops-secrets-operations","title":"2. SOPS (Secrets OPerationS)","text":"<p>Encrypt files with AWS KMS, GCP KMS, or Age.</p> <p>Features: - YAML/JSON/ENV file encryption - Partial encryption (only values) - Multiple KMS support - Git-friendly diffs - CI/CD integration</p> <p>Example Usage:</p> <p>Create <code>.sops.yaml</code>:</p> <pre><code>creation_rules:\n  - path_regex: environments/prod/.*\\.yaml$\n    kms: 'arn:aws:kms:us-east-1:123456789:key/12345678-1234-1234-1234-123456789012'\n    pgp: 'FBC7B9E2A4F9289AC0C1D4843D16CEE4A27381B4'\n\n  - path_regex: environments/dev/.*\\.yaml$\n    age: 'age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p'\n</code></pre> <p>Encrypt secrets:</p> <pre><code># Create secrets file\ncat &gt; secrets.yaml &lt;&lt; EOF\ndatabase:\n  host: db.example.com\n  username: admin\n  password: super-secret-password\n\napi_keys:\n  stripe: sk_live_xxxxxxxxxxxxx\n  sendgrid: SG.xxxxxxxxxxxxx\nEOF\n\n# Encrypt with SOPS\nsops -e secrets.yaml &gt; secrets.enc.yaml\n\n# Commit encrypted file\ngit add secrets.enc.yaml\ngit commit -m \"Add encrypted secrets\"\n</code></pre> <p>Decrypt and use:</p> <pre><code># Decrypt in CI/CD\nsops -d secrets.enc.yaml &gt; secrets.yaml\n\n# Or export as environment variables\nexport $(sops -d --output-type dotenv secrets.enc.yaml)\n</code></pre>"},{"location":"en/infra-secrets/#3-gcp-secret-manager","title":"3. GCP Secret Manager","text":"<p>Native GCP secrets management.</p> <p>Example:</p> <pre><code>module \"gcp_secrets\" {\n  source = \"github.com/v-grand/infra-secrets//modules/gcp-secrets\"\n\n  project_id = var.gcp_project_id\n\n  secrets = {\n    database_password = {\n      secret_data = var.database_password\n      replication = \"automatic\"\n\n      iam_members = [\n        \"serviceAccount:app@project.iam.gserviceaccount.com\"\n      ]\n    }\n\n    api_key = {\n      secret_data = var.api_key\n      replication = \"automatic\"\n      rotation_period = \"2592000s\"  # 30 days\n    }\n  }\n}\n</code></pre> <p>Access from Application:</p> <pre><code>from google.cloud import secretmanager\n\ndef access_secret(project_id, secret_id, version_id=\"latest\"):\n    client = secretmanager.SecretManagerServiceClient()\n    name = f\"projects/{project_id}/secrets/{secret_id}/versions/{version_id}\"\n    response = client.access_secret_version(request={\"name\": name})\n    return response.payload.data.decode(\"UTF-8\")\n\n# Usage\ndb_password = access_secret(\"my-project\", \"database_password\")\n</code></pre>"},{"location":"en/infra-secrets/#4-aws-secrets-manager","title":"4. AWS Secrets Manager","text":"<p>Native AWS secrets management.</p> <p>Example:</p> <pre><code>module \"aws_secrets\" {\n  source = \"github.com/v-grand/infra-secrets//modules/aws-secrets\"\n\n  secrets = {\n    database_credentials = {\n      secret_string = jsonencode({\n        username = \"admin\"\n        password = var.database_password\n        host     = \"db.example.com\"\n        port     = 5432\n      })\n\n      recovery_window_in_days = 30\n      rotation_enabled        = true\n      rotation_days           = 30\n    }\n\n    api_key = {\n      secret_string = var.api_key\n\n      policy = jsonencode({\n        Version = \"2012-10-17\"\n        Statement = [\n          {\n            Effect = \"Allow\"\n            Principal = {\n              AWS = \"arn:aws:iam::123456789:role/app-role\"\n            }\n            Action   = \"secretsmanager:GetSecretValue\"\n            Resource = \"*\"\n          }\n        ]\n      })\n    }\n  }\n}\n</code></pre>"},{"location":"en/infra-secrets/#quick-start","title":"\ud83d\ude80 Quick Start","text":""},{"location":"en/infra-secrets/#1-initialize-vault","title":"1. Initialize Vault","text":"<pre><code># Deploy Vault\ncd environments/prod\nterraform init\nterraform apply\n\n# Initialize Vault (first time only)\n./scripts/vault-init.sh\n\n# Save root token and unseal keys securely!\n</code></pre>"},{"location":"en/infra-secrets/#2-configure-sops","title":"2. Configure SOPS","text":"<pre><code># Generate Age key\nage-keygen -o ~/.config/sops/age/keys.txt\n\n# Or use existing KMS keys\nexport SOPS_KMS_ARN=\"arn:aws:kms:us-east-1:123456789:key/xxxxx\"\nexport SOPS_GCP_KMS=\"projects/my-project/locations/global/keyRings/my-keyring/cryptoKeys/my-key\"\n</code></pre>"},{"location":"en/infra-secrets/#3-store-secrets","title":"3. Store Secrets","text":"<p>Using Vault:</p> <pre><code># Write secret\nvault kv put secret/app/database \\\n  username=admin \\\n  password=super-secret\n\n# Read secret\nvault kv get secret/app/database\n</code></pre> <p>Using SOPS:</p> <pre><code># Encrypt file\nsops -e config.yaml &gt; config.enc.yaml\n\n# Edit encrypted file\nsops config.enc.yaml\n\n# Decrypt\nsops -d config.enc.yaml\n</code></pre>"},{"location":"en/infra-secrets/#cicd-integration","title":"\ud83d\udd17 CI/CD Integration","text":""},{"location":"en/infra-secrets/#github-actions-with-sops","title":"GitHub Actions with SOPS","text":"<pre><code>name: Deploy with Secrets\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Install SOPS\n        run: |\n          wget https://github.com/mozilla/sops/releases/download/v3.7.3/sops-v3.7.3.linux\n          chmod +x sops-v3.7.3.linux\n          sudo mv sops-v3.7.3.linux /usr/local/bin/sops\n\n      - name: Decrypt Secrets\n        env:\n          SOPS_AGE_KEY: ${{ secrets.SOPS_AGE_KEY }}\n        run: |\n          sops -d environments/prod/secrets.enc.yaml &gt; secrets.yaml\n\n      - name: Deploy\n        run: |\n          terraform init\n          terraform apply -auto-approve\n</code></pre>"},{"location":"en/infra-secrets/#using-vault-in-cicd","title":"Using Vault in CI/CD","text":"<pre><code>name: Deploy with Vault\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Import Secrets from Vault\n        uses: hashicorp/vault-action@v2\n        with:\n          url: https://vault.example.com\n          token: ${{ secrets.VAULT_TOKEN }}\n          secrets: |\n            secret/data/app/database username | DATABASE_USERNAME ;\n            secret/data/app/database password | DATABASE_PASSWORD ;\n            secret/data/app/api apikey | API_KEY\n\n      - name: Deploy\n        run: |\n          terraform apply -auto-approve\n</code></pre>"},{"location":"en/infra-secrets/#security-best-practices","title":"\ud83d\udd10 Security Best Practices","text":"<ol> <li>Never commit unencrypted secrets to version control</li> <li>Rotate secrets regularly - Implement automatic rotation</li> <li>Use least privilege - Grant minimal necessary access</li> <li>Audit access - Enable and monitor audit logs</li> <li>Encrypt in transit - Always use TLS/HTTPS</li> <li>Backup securely - Encrypt Vault backups</li> <li>Multi-factor auth - Enable MFA for Vault access</li> </ol>"},{"location":"en/infra-secrets/#integration-examples","title":"\ud83d\udcca Integration Examples","text":""},{"location":"en/infra-secrets/#with-infra-aws","title":"With infra-aws","text":"<pre><code># Retrieve secrets from Vault for AWS deployment\ndata \"vault_generic_secret\" \"aws_credentials\" {\n  path = \"secret/aws/credentials\"\n}\n\nmodule \"app_server\" {\n  source = \"github.com/v-grand/infra-core//modules/vm\"\n\n  # Use dynamic credentials\n  aws_access_key = data.vault_generic_secret.aws_credentials.data[\"access_key\"]\n  aws_secret_key = data.vault_generic_secret.aws_credentials.data[\"secret_key\"]\n}\n</code></pre>"},{"location":"en/infra-secrets/#with-infra-monitoring","title":"With infra-monitoring","text":"<pre><code># Store Grafana admin password in Vault\nresource \"vault_generic_secret\" \"grafana_admin\" {\n  path = \"secret/monitoring/grafana\"\n\n  data_json = jsonencode({\n    admin_password = random_password.grafana_admin.result\n  })\n}\n\nmodule \"monitoring\" {\n  source = \"github.com/v-grand/infra-monitoring//modules/grafana\"\n\n  admin_password = vault_generic_secret.grafana_admin.data[\"admin_password\"]\n}\n</code></pre>"},{"location":"en/infra-secrets/#documentation","title":"\ud83d\udcda Documentation","text":"<ul> <li>HashiCorp Vault</li> <li>SOPS</li> <li>GCP Secret Manager</li> <li>AWS Secrets Manager</li> </ul>"},{"location":"en/infra-secrets/#related-repositories","title":"\ud83d\udd17 Related Repositories","text":"<ul> <li>infra-ci - CI/CD integration</li> <li>infra-core - Infrastructure modules</li> <li>infra-aws - AWS integration</li> <li>infra-gcp - GCP integration</li> </ul>"},{"location":"en/infra-template/","title":"Infra Template","text":""},{"location":"en/infra-template/#infra-template-project-template","title":"infra-template: Project Template","text":"<p>infra-template provides a standardized starting point for new infrastructure projects with best practices, CI/CD integration, and consistent structure.</p>"},{"location":"en/infra-template/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>Bootstrap new infrastructure projects:</p> <ul> <li>Standardized Structure - Consistent project layout</li> <li>Best Practices - Security, modularity, documentation</li> <li>CI/CD Ready - Pre-configured GitHub Actions</li> <li>Multi-Cloud - Support for AWS and GCP</li> <li>Documentation - Comprehensive templates</li> </ul>"},{"location":"en/infra-template/#repository-structure","title":"\ud83d\udcc1 Repository Structure","text":"<pre><code>infra-template/\n\u251c\u2500\u2500 .github/\n\u2502   \u2514\u2500\u2500 workflows/\n\u2502       \u251c\u2500\u2500 validate.yml       # Terraform validation\n\u2502       \u2514\u2500\u2500 deploy.yml         # Automated deployment\n\u251c\u2500\u2500 modules/\n\u2502   \u2514\u2500\u2500 vm/                    # Example local module\n\u2502       \u251c\u2500\u2500 main.tf\n\u2502       \u251c\u2500\u2500 variables.tf\n\u2502       \u251c\u2500\u2500 outputs.tf\n\u2502       \u2514\u2500\u2500 README.md\n\u251c\u2500\u2500 examples/\n\u2502   \u251c\u2500\u2500 simple-vm/             # Basic VM deployment\n\u2502   \u2514\u2500\u2500 multi-tier/            # Multi-tier architecture\n\u251c\u2500\u2500 docs/\n\u2502   \u251c\u2500\u2500 README.md              # Detailed documentation\n\u2502   \u251c\u2500\u2500 ARCHITECTURE.md        # Architecture decisions\n\u2502   \u2514\u2500\u2500 DEPLOYMENT.md          # Deployment guide\n\u251c\u2500\u2500 main.tf                    # Root Terraform configuration\n\u251c\u2500\u2500 variables.tf               # Input variables\n\u251c\u2500\u2500 outputs.tf                 # Output values\n\u251c\u2500\u2500 terraform.tfvars.example   # Example variables\n\u251c\u2500\u2500 backend.tf                 # Backend configuration\n\u251c\u2500\u2500 versions.tf                # Provider versions\n\u251c\u2500\u2500 .gitignore                 # Git ignore rules\n\u251c\u2500\u2500 .terraform-docs.yml        # terraform-docs config\n\u251c\u2500\u2500 .pre-commit-config.yaml    # Pre-commit hooks\n\u2514\u2500\u2500 README.md                  # Project overview\n</code></pre>"},{"location":"en/infra-template/#getting-started","title":"\ud83d\ude80 Getting Started","text":""},{"location":"en/infra-template/#1-create-new-project-from-template","title":"1. Create New Project from Template","text":"<p>Using GitHub:</p> <pre><code># Click \"Use this template\" on GitHub\n# Or clone directly:\ngit clone https://github.com/v-grand/infra-template.git my-new-project\ncd my-new-project\n\n# Remove git history\nrm -rf .git\ngit init\ngit add .\ngit commit -m \"Initial commit from template\"\n</code></pre>"},{"location":"en/infra-template/#2-configure-project","title":"2. Configure Project","text":"<pre><code># Copy example configuration\ncp terraform.tfvars.example terraform.tfvars\n\n# Edit with your settings\nnano terraform.tfvars\n</code></pre> <p>terraform.tfvars example:</p> <pre><code># Project Configuration\nproject_name = \"my-app\"\nenvironment  = \"dev\"\n\n# Cloud Provider (aws or gcp)\ncloud = \"gcp\"\n\n# GCP Configuration\ngcp_project = \"my-gcp-project\"\ngcp_region  = \"us-central1\"\ngcp_zone    = \"us-central1-a\"\n\n# AWS Configuration\naws_region = \"us-east-1\"\n\n# Network Configuration\nvpc_cidr = \"10.0.0.0/16\"\n\n# Compute Configuration\ninstance_type = \"e2-medium\"  # GCP\n# instance_type = \"t3.medium\"  # AWS\n\n# Tags\ntags = {\n  Environment = \"dev\"\n  ManagedBy   = \"terraform\"\n  Project     = \"my-app\"\n}\n</code></pre>"},{"location":"en/infra-template/#3-initialize-and-deploy","title":"3. Initialize and Deploy","text":"<pre><code># Initialize Terraform\nterraform init\n\n# Review plan\nterraform plan\n\n# Apply configuration\nterraform apply\n</code></pre>"},{"location":"en/infra-template/#template-files","title":"\ud83d\udcdd Template Files","text":""},{"location":"en/infra-template/#maintf","title":"main.tf","text":"<pre><code># Main Terraform configuration\nterraform {\n  required_version = \"&gt;= 1.5.0\"\n\n  required_providers {\n    google = {\n      source  = \"hashicorp/google\"\n      version = \"~&gt; 5.0\"\n    }\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~&gt; 5.0\"\n    }\n  }\n}\n\n# Provider configuration\nprovider \"google\" {\n  project = var.gcp_project\n  region  = var.gcp_region\n}\n\nprovider \"aws\" {\n  region = var.aws_region\n}\n\n# Example: Use infra-core modules\nmodule \"vm\" {\n  source = \"github.com/v-grand/infra-core//modules/vm\"\n\n  cloud         = var.cloud\n  instance_name = \"${var.project_name}-${var.environment}\"\n  instance_type = var.instance_type\n\n  # GCP specific\n  project = var.cloud == \"gcp\" ? var.gcp_project : null\n  zone    = var.cloud == \"gcp\" ? var.gcp_zone : null\n\n  # AWS specific\n  subnet_id = var.cloud == \"aws\" ? var.aws_subnet_id : null\n\n  tags = var.tags\n}\n</code></pre>"},{"location":"en/infra-template/#variablestf","title":"variables.tf","text":"<pre><code>variable \"project_name\" {\n  description = \"Name of the project\"\n  type        = string\n}\n\nvariable \"environment\" {\n  description = \"Environment (dev, staging, prod)\"\n  type        = string\n  default     = \"dev\"\n\n  validation {\n    condition     = contains([\"dev\", \"staging\", \"prod\"], var.environment)\n    error_message = \"Environment must be dev, staging, or prod.\"\n  }\n}\n\nvariable \"cloud\" {\n  description = \"Cloud provider (aws or gcp)\"\n  type        = string\n  default     = \"gcp\"\n\n  validation {\n    condition     = contains([\"aws\", \"gcp\"], var.cloud)\n    error_message = \"Cloud must be aws or gcp.\"\n  }\n}\n\nvariable \"gcp_project\" {\n  description = \"GCP project ID\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"gcp_region\" {\n  description = \"GCP region\"\n  type        = string\n  default     = \"us-central1\"\n}\n\nvariable \"tags\" {\n  description = \"Tags to apply to resources\"\n  type        = map(string)\n  default     = {}\n}\n</code></pre>"},{"location":"en/infra-template/#outputstf","title":"outputs.tf","text":"<pre><code>output \"instance_id\" {\n  description = \"ID of the created instance\"\n  value       = module.vm.instance_id\n}\n\noutput \"instance_ip\" {\n  description = \"IP address of the instance\"\n  value       = module.vm.instance_ip\n}\n\noutput \"instance_name\" {\n  description = \"Name of the instance\"\n  value       = module.vm.instance_name\n}\n</code></pre>"},{"location":"en/infra-template/#backendtf","title":"backend.tf","text":"<pre><code># Terraform state backend configuration\nterraform {\n  backend \"gcs\" {\n    bucket  = \"my-terraform-state-bucket\"\n    prefix  = \"terraform/state\"\n  }\n\n  # Alternative: AWS S3 backend\n  # backend \"s3\" {\n  #   bucket         = \"my-terraform-state-bucket\"\n  #   key            = \"terraform.tfstate\"\n  #   region         = \"us-east-1\"\n  #   dynamodb_table = \"terraform-locks\"\n  #   encrypt        = true\n  # }\n}\n</code></pre>"},{"location":"en/infra-template/#cicd-configuration","title":"\ud83d\udd04 CI/CD Configuration","text":""},{"location":"en/infra-template/#githubworkflowsvalidateyml","title":".github/workflows/validate.yml","text":"<pre><code>name: Terraform Validation\non:\n [pull_request, push]\n\njobs:\n  validate:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Setup Terraform\n        uses: hashicorp/setup-terraform@v2\n        with:\n          terraform_version: 1.5.0\n\n      - name: Terraform Format\n        run: terraform fmt -check -recursive\n\n      - name: Terraform Init\n        run: terraform init -backend=false\n\n      - name: Terraform Validate\n        run: terraform validate\n</code></pre>"},{"location":"en/infra-template/#githubworkflowsdeployyml","title":".github/workflows/deploy.yml","text":"<pre><code>name: Deploy Infrastructure\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    uses: v-grand/infra-ci/.github/workflows/reusable/terraform-apply.yml@main\n    with:\n      working-directory: ./\n      environment: dev\n    secrets:\n      GCP_CREDENTIALS: ${{ secrets.GCP_CREDENTIALS }}\n</code></pre>"},{"location":"en/infra-template/#pre-commit-hooks","title":"\ud83d\udd27 Pre-commit Hooks","text":""},{"location":"en/infra-template/#pre-commit-configyaml","title":".pre-commit-config.yaml","text":"<pre><code>repos:\n  - repo: https://github.com/antonbabenko/pre-commit-terraform\n    rev: v1.83.5\n    hooks:\n      - id: terraform_fmt\n      - id: terraform_validate\n      - id: terraform_docs\n        args:\n          - --hook-config=--path-to-file=README.md\n          - --hook-config=--add-to-existing-file=true\n          - --hook-config=--create-file-if-not-exist=true\n      - id: terraform_tflint\n        args:\n          - --args=--config=__GIT_WORKING_DIR__/.tflint.hcl\n</code></pre> <p>Setup:</p> <pre><code># Install pre-commit\npip install pre-commit\n\n# Install hooks\npre-commit install\n\n# Run manually\npre-commit run --all-files\n</code></pre>"},{"location":"en/infra-template/#documentation-templates","title":"\ud83d\udcda Documentation Templates","text":""},{"location":"en/infra-template/#readmemd-template","title":"README.md Template","text":"<pre><code># Project Name\n\nBrief description of what this infrastructure deploys.\n\n## Architecture\n\n[Add architecture diagram here]\n\n## Prerequisites\n\n- Terraform &gt;= 1.5.0\n- GCP/AWS account with appropriate permissions\n- [Other requirements]\n\n## Quick Start\n\n1. Clone repository\n2. Copy `terraform.tfvars.example` to `terraform.tfvars`\n3. Edit `terraform.tfvars` with your configuration\n4. Run `terraform init &amp;&amp; terraform apply`\n\n## Configuration\n\n[Document key variables and their purposes]\n\n## Deployment\n\n[Step-by-step deployment instructions]\n\n## Maintenance\n\n[Ongoing maintenance tasks]\n\n## Troubleshooting\n\n[Common issues and solutions]\n</code></pre>"},{"location":"en/infra-template/#customization","title":"\ud83c\udfa8 Customization","text":""},{"location":"en/infra-template/#add-custom-modules","title":"Add Custom Modules","text":"<pre><code># Create new module\nmkdir -p modules/my-module\ncd modules/my-module\n\n# Create module files\ncat &gt; main.tf &lt;&lt; EOF\n# Module implementation\nEOF\n\ncat &gt; variables.tf &lt;&lt; EOF\n# Module variables\nEOF\n\ncat &gt; outputs.tf &lt;&lt; EOF\n# Module outputs\nEOF\n\ncat &gt; README.md &lt;&lt; EOF\n# My Module\n\nDescription of the module\nEOF\n</code></pre>"},{"location":"en/infra-template/#integrate-with-infra-core","title":"Integrate with infra-core","text":"<pre><code># Use existing infra-core modules\nmodule \"database\" {\n  source = \"github.com/v-grand/infra-core//modules/db\"\n\n  # Configuration\n}\n\nmodule \"network\" {\n  source = \"github.com/v-grand/infra-network//modules/vpc-gcp\"\n\n  # Configuration\n}\n</code></pre>"},{"location":"en/infra-template/#best-practices-included","title":"\u2705 Best Practices Included","text":"<ol> <li>Version Pinning - Terraform and provider versions locked</li> <li>Input Validation - Variable validation rules</li> <li>Output Documentation - Descriptive output values</li> <li>Code Formatting - automated with pre-commit</li> <li>Security - .gitignore prevents secret commits</li> <li>CI/CD - Automated validation and deployment</li> <li>Documentation - terraform-docs integration</li> <li>State Management - Remote backend configuration</li> </ol>"},{"location":"en/infra-template/#integration","title":"\ud83d\udd17 Integration","text":""},{"location":"en/infra-template/#with-other-repositories","title":"With Other Repositories","text":"<pre><code># Reference infra-core modules\nmodule \"vm\" {\n  source = \"github.com/v-grand/infra-core//modules/vm\"\n}\n\n# Use infra-network modules\nmodule \"vpc\" {\n  source = \"github.com/v-grand/infra-network//modules/vpc-gcp\"\n}\n\n# Integrate monitoring\nmodule \"monitoring\" {\n  source = \"github.com/v-grand/infra-monitoring//modules/prometheus\"\n}\n</code></pre>"},{"location":"en/infra-template/#documentation","title":"\ud83d\udcd6 Documentation","text":"<ul> <li>Terraform Best Practices</li> <li>infra-core Modules</li> <li>CI/CD Workflows</li> </ul>"},{"location":"en/infra-template/#related-repositories","title":"\ud83d\udd17 Related Repositories","text":"<ul> <li>infra-core - Reusable modules</li> <li>infra-ci - CI/CD workflows</li> <li>infra-docs - Documentation</li> </ul>"},{"location":"en/tailscale/","title":"Tailscale","text":""},{"location":"en/tailscale/#tailscale-mesh-network","title":"Tailscale Mesh Network","text":"<p>Tailscale creates a secure mesh network (VPN) between your devices and infrastructure using WireGuard protocol. It's perfect for connecting your development machines, CI/CD runners, and cloud resources.</p>"},{"location":"en/tailscale/#features","title":"Features","text":"<ul> <li>Zero-config VPN: Automatic peer discovery and connection</li> <li>End-to-end encryption: Using WireGuard protocol</li> <li>Cross-platform: Works on Linux, Windows, macOS, iOS, Android</li> <li>ACLs: Fine-grained access control</li> <li>MagicDNS: Automatic DNS resolution for devices</li> <li>Subnet routing: Access to entire networks through exit nodes</li> </ul>"},{"location":"en/tailscale/#installation","title":"Installation","text":""},{"location":"en/tailscale/#linux-ubuntudebian","title":"Linux (Ubuntu/Debian)","text":"<pre><code>curl -fsSL https://tailscale.com/install.sh | sh\n</code></pre>"},{"location":"en/tailscale/#macos","title":"macOS","text":"<pre><code>brew install tailscale\n</code></pre>"},{"location":"en/tailscale/#windows","title":"Windows","text":"<p>Download and install from tailscale.com/download</p>"},{"location":"en/tailscale/#quick-start","title":"Quick Start","text":""},{"location":"en/tailscale/#1-authenticate","title":"1. Authenticate","text":"<pre><code>sudo tailscale up\n</code></pre> <p>This will open a browser window for authentication. After logging in, your device will join your tailnet.</p>"},{"location":"en/tailscale/#2-check-status","title":"2. Check Status","text":"<pre><code>tailscale status\n</code></pre>"},{"location":"en/tailscale/#3-get-your-ip","title":"3. Get Your IP","text":"<pre><code>tailscale ip -4\n</code></pre>"},{"location":"en/tailscale/#infrastructure-integration","title":"Infrastructure Integration","text":""},{"location":"en/tailscale/#using-with-terraform","title":"Using with Terraform","text":"<pre><code>resource \"tailscale_tailnet_key\" \"ci_cd\" {\n  reusable      = true\n  ephemeral     = false\n  preauthorized = true\n  expiry        = 7776000  # 90 days\n  description   = \"CI/CD authentication key\"\n}\n\noutput \"tailscale_key\" {\n  value     = tailscale_tailnet_key.ci_cd.key\n  sensitive = true\n}\n</code></pre>"},{"location":"en/tailscale/#github-actions-integration","title":"GitHub Actions Integration","text":"<pre><code>- name: Connect to Tailscale\n  uses: tailscale/github-action@v2\n  with:\n    oauth-client-id: ${{ secrets.TS_OAUTH_CLIENT_ID }}\n    oauth-secret: ${{ secrets.TS_OAUTH_SECRET }}\n    tags: tag:ci\n\n- name: Access internal resources\n  run: |\n    curl http://internal-service.tail-scale.ts.net\n</code></pre>"},{"location":"en/tailscale/#subnet-routing","title":"Subnet Routing","text":"<p>To expose an entire subnet through a Tailscale node:</p> <pre><code>echo 'net.ipv4.ip_forward = 1' | sudo tee -a /etc/sysctl.conf\nsudo sysctl -p /etc/sysctl.conf\n\nsudo tailscale up --advertise-routes=10.0.0.0/24\n</code></pre> <p>Then approve the routes in the Tailscale admin console.</p>"},{"location":"en/tailscale/#access-control-lists-acls","title":"Access Control Lists (ACLs)","text":"<p>Example ACL configuration:</p> <pre><code>{\n  \"acls\": [\n    {\n      \"action\": \"accept\",\n      \"src\": [\"tag:ci\"],\n      \"dst\": [\"tag:production:*\"]\n    },\n    {\n      \"action\": \"accept\",\n      \"src\": [\"group:developers\"],\n      \"dst\": [\"tag:development:*\"]\n    }\n  ],\n  \"tagOwners\": {\n    \"tag:ci\": [\"autogroup:admin\"],\n    \"tag:production\": [\"autogroup:admin\"],\n    \"tag:development\": [\"autogroup:admin\"]\n  }\n}\n</code></pre>"},{"location":"en/tailscale/#magicdns","title":"MagicDNS","text":"<p>Enable MagicDNS in your tailnet settings to use hostnames instead of IPs:</p> <pre><code># Instead of:\nssh 100.64.1.2\n\n# Use:\nssh my-server.tail-scale.ts.net\n</code></pre>"},{"location":"en/tailscale/#best-practices","title":"Best Practices","text":"<ol> <li>Use tags for infrastructure nodes instead of user accounts</li> <li>Enable MagicDNS for easier service discovery</li> <li>Set up subnet routing for accessing entire networks</li> <li>Use ACLs to restrict access between different environments</li> <li>Rotate auth keys regularly for CI/CD</li> <li>Enable HTTPS for Tailscale admin console access</li> </ol>"},{"location":"en/tailscale/#troubleshooting","title":"Troubleshooting","text":""},{"location":"en/tailscale/#connection-issues","title":"Connection Issues","text":"<pre><code># Check connectivity\ntailscale ping &lt;device-name&gt;\n\n# View detailed status\ntailscale status --json\n\n# Check logs\nsudo journalctl -u tailscaled\n</code></pre>"},{"location":"en/tailscale/#reset-connection","title":"Reset Connection","text":"<pre><code>sudo tailscale down\nsudo tailscale up\n</code></pre>"},{"location":"en/tailscale/#resources","title":"Resources","text":"<ul> <li>Official Documentation</li> <li>Terraform Provider</li> <li>GitHub Action</li> </ul>"},{"location":"en/template-frontend/","title":"Template Frontend","text":""},{"location":"en/template-frontend/#template-frontend","title":"template-frontend","text":"<p><code>template-frontend</code> is a standardized project template for frontend applications.</p>"},{"location":"en/template-frontend/#overview","title":"Overview","text":"<p>This repository provides a starting point for building modern frontend applications, with a focus on best practices and a consistent development experience.</p> <p>(Further documentation to be added once the submodule is initialized and its contents are available.)</p>"},{"location":"en/template-platform/","title":"Template Platform","text":""},{"location":"en/template-platform/#template-platform","title":"Template Platform","text":"<p>Template Platform is a foundational backend service designed to provide a ready-to-use, scalable, and maintainable starting point for new applications. It integrates seamlessly with the infrastructure components provided by <code>infra-core</code> and <code>infra-template</code>, and its deployment is managed by pipelines from <code>infra-ci</code>.</p>"},{"location":"en/template-platform/#core-purpose","title":"Core Purpose","text":"<p>The primary goal of <code>template-platform</code> is to accelerate development by offering a pre-configured environment that includes:</p> <ul> <li>API Scaffolding: A basic structure for creating RESTful or GraphQL APIs.</li> <li>Database Integration: Pre-configured connections to standard databases.</li> <li>CI/CD Integration: Ready to be deployed to <code>dev</code> and <code>stage</code> environments out-of-the-box using <code>infra-ci</code>.</li> <li>Observability: Hooks for logging, metrics, and tracing.</li> </ul>"},{"location":"en/template-platform/#getting-started","title":"Getting Started","text":"<p>To begin working with <code>template-platform</code>, ensure you have cloned the repository and initialized its submodules:</p> <pre><code>git clone &lt;your-repo-url&gt;/template-platform.git\ncd template-platform\ngit submodule update --init --recursive\n</code></pre> <p>The service can be run locally using Docker Compose:</p> <pre><code>docker-compose up --build\n</code></pre>"},{"location":"en/template-platform/#deployment","title":"Deployment","text":"<p>Deployments are handled automatically by GitHub Actions upon pushing to the <code>main</code> branch (for the <code>dev</code> environment) or can be triggered manually (for the <code>stage</code> environment). The pipeline uses Terraform configurations defined within the <code>template-platform</code> repository, which in turn utilize modules from <code>infra-template</code>.</p>"},{"location":"en/examples/aws-dev/","title":"AWS Dev","text":""},{"location":"en/examples/aws-dev/#aws-development-environment-example","title":"AWS Development Environment Example","text":"<p>This example demonstrates how to set up a complete development environment on AWS using <code>infra-core</code> modules.</p> <p>It includes: - A VPC with subnets - An EC2 instance (VM) - An RDS MySQL database - Tailscale integration for secure access</p>"},{"location":"en/examples/aws-dev/#configuration-maintf","title":"Configuration (<code>main.tf</code>)","text":"<pre><code># main.tf for aws-dev example\n\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\nmodule \"vpc\" {\n  source = \"../../modules/vpc\"\n\n  provider          = \"aws\"\n  cidr_block        = \"10.0.0.0/16\"\n  subnet_cidr_block = \"10.0.1.0/24\"\n  tags = {\n    Name = \"aws-dev-vpc\"\n  }\n}\n\nmodule \"vm\" {\n  source = \"../../modules/vm\"\n\n  provider      = \"aws\"\n  ami           = \"ami-0c55b159cbfafe1f0\" # us-east-1\n  instance_type = \"t2.micro\"\n  tags = {\n    Name = \"aws-dev-vm\"\n  }\n}\n\nmodule \"db\" {\n  source = \"../../modules/db\"\n\n  provider          = \"aws\"\n  allocated_storage = 20\n  engine            = \"mysql\"\n  engine_version    = \"8.0\"\n  instance_class    = \"db.t2.micro\"\n  db_name           = \"awsdevdb\"\n  username          = \"user\"\n  password          = \"password\" # Replace with a secure password\n  tags = {\n    Name = \"aws-dev-db\"\n  }\n}\n\nmodule \"tailscale\" {\n  source = \"../../modules/tailscale\"\n\n  instance_id      = module.vm.instance_id\n  auth_key         = \"your-tailscale-auth-key\" # Replace with your auth key\n  ssh_user         = \"ec2-user\"\n  private_key_path = \"~/.ssh/id_rsa\" # Replace with your private key path\n  host             = module.vm.public_ip\n}\n\noutput \"vpc_id\" {\n  value = module.vpc.vpc_id\n}\n\noutput \"vm_id\" {\n  value = module.vm.instance_id\n}\n\noutput \"db_id\" {\n  value = module.db.db_instance_id\n}\n</code></pre>"},{"location":"en/gcp/","title":"Home","text":""},{"location":"en/gcp/#google-cloud-platform-gcp","title":"Google Cloud Platform (GCP)","text":"<p>This section contains documentation related to Google Cloud Platform.</p>"},{"location":"en/gcp/db/","title":"DB","text":""},{"location":"en/gcp/db/#database-documentation","title":"Database Documentation","text":""},{"location":"en/gcp/db/#overview","title":"Overview","text":"<ul> <li>Instance Name: [Enter DB Instance Name]</li> <li>Project: [Enter GCP Project ID]</li> <li>Region: [Enter GCP Region]</li> <li>Database Type: [e.g., PostgreSQL 13, MySQL 8]</li> <li>Instance Size: [e.g., db-n1-standard-1]</li> </ul>"},{"location":"en/gcp/db/#connection-details","title":"Connection Details","text":"<ul> <li>Connection Name: [Enter Instance Connection Name]</li> <li>Public IP: [Enter Public IP or \"Disabled\"]</li> <li>Private IP: [Enter Private IP or \"Disabled\"]</li> </ul>"},{"location":"en/gcp/db/#backup-and-maintenance","title":"Backup and Maintenance","text":"<ul> <li>Backup Schedule: [e.g., Daily at 01:00 UTC]</li> <li>Maintenance Window: [e.g., Sunday 03:00-04:00 UTC]</li> </ul>"},{"location":"en/gcp/db/#notes","title":"Notes","text":"<p>[Add any additional notes here]</p>"},{"location":"en/gcp/k8s/","title":"K8s","text":""},{"location":"en/gcp/k8s/#kubernetes-cluster-documentation","title":"Kubernetes Cluster Documentation","text":""},{"location":"en/gcp/k8s/#overview","title":"Overview","text":"<ul> <li>Cluster Name: [Enter Cluster Name]</li> <li>Project: [Enter GCP Project ID]</li> <li>Location: [Enter GCP Zone or Region]</li> <li>Kubernetes Version: [e.g., 1.23]</li> </ul>"},{"location":"en/gcp/k8s/#node-pools","title":"Node Pools","text":"Node Pool Name Machine Type Node Count Autoscaling [e.g., default-pool] [e.g., e2-medium] [e.g., 3] [e.g., Enabled]"},{"location":"en/gcp/k8s/#networking","title":"Networking","text":"<ul> <li>VPC: [Enter VPC Name]</li> <li>Subnet: [Enter Subnet Name]</li> <li>Pod Address Range: [Enter Pod CIDR]</li> <li>Service Address Range: [Enter Service CIDR]</li> </ul>"},{"location":"en/gcp/k8s/#security","title":"Security","text":"<ul> <li>RBAC: [Enabled/Disabled]</li> <li>Workload Identity: [Enabled/Disabled]</li> </ul>"},{"location":"en/gcp/k8s/#notes","title":"Notes","text":"<p>[Add any additional notes here]</p>"},{"location":"en/gcp/vm/","title":"VM","text":""},{"location":"en/gcp/vm/#virtual-machine-documentation","title":"Virtual Machine Documentation","text":""},{"location":"en/gcp/vm/#overview","title":"Overview","text":"<ul> <li>VM Name: [Enter VM Name]</li> <li>Project: [Enter GCP Project ID]</li> <li>Zone: [Enter GCP Zone]</li> <li>Instance Type: [e.g., e2-medium]</li> <li>Operating System: [e.g., Debian 11]</li> </ul>"},{"location":"en/gcp/vm/#network-configuration","title":"Network Configuration","text":"<ul> <li>VPC: [Enter VPC Name]</li> <li>Subnet: [Enter Subnet Name]</li> <li>Internal IP: [Enter Internal IP]</li> <li>External IP: [Enter External IP or \"None\"]</li> </ul>"},{"location":"en/gcp/vm/#security","title":"Security","text":"<ul> <li>Firewall Rules:</li> <li>[List of firewall rules]</li> <li>Service Account: [Enter Service Account Name]</li> </ul>"},{"location":"en/gcp/vm/#notes","title":"Notes","text":"<p>[Add any additional notes here]</p>"},{"location":"en/secure-access/aws-oidc/","title":"AWS OIDC","text":""},{"location":"en/secure-access/aws-oidc/#secure-aws-access-with-oidc","title":"Secure AWS Access with OIDC","text":"<p>This method is recommended for setting up CI/CD (e.g., GitHub Actions) and allows you to obtain temporary AWS credentials without needing to store long-lived <code>AWS_ACCESS_KEY_ID</code> and <code>AWS_SECRET_ACCESS_KEY</code> in secrets.</p>"},{"location":"en/secure-access/aws-oidc/#how-it-works","title":"How It Works","text":"<ol> <li>GitHub generates a unique OIDC token for each run of your workflow.</li> <li>AWS IAM trusts GitHub as an identity provider.</li> <li>GitHub Action passes its OIDC token to AWS.</li> <li>AWS STS (Security Token Service) validates the token and, if valid, issues temporary credentials to your workflow to assume the specified role.</li> </ol>"},{"location":"en/secure-access/aws-oidc/#step-by-step-setup","title":"Step-by-Step Setup","text":""},{"location":"en/secure-access/aws-oidc/#step-1-configure-identity-provider-in-aws-iam","title":"Step 1: Configure Identity Provider in AWS IAM","text":"<ol> <li>Open the AWS console and navigate to the IAM service.</li> <li>In the left menu, select Identity providers.</li> <li>Click \"Add provider\".</li> <li>Select provider type \"OpenID Connect\".</li> <li>In the Provider URL field, enter <code>https://token.actions.githubusercontent.com</code>.</li> <li>Click \"Get thumbprint\" to allow AWS to automatically retrieve the certificate thumbprint.</li> <li>In the Audience field, enter <code>sts.amazonaws.com</code>.</li> <li>Click \"Add provider\".</li> </ol>"},{"location":"en/secure-access/aws-oidc/#step-2-create-iam-role","title":"Step 2: Create IAM Role","text":"<ol> <li>In IAM, navigate to Roles and click \"Create role\".</li> <li>For \"Trusted entity type\", select \"Web identity\".</li> <li>In the Identity provider dropdown, select the provider you created in the previous step (<code>token.actions.githubusercontent.com</code>).</li> <li>In the Audience field, select <code>sts.amazonaws.com</code>.</li> <li>Click \"Next\".</li> <li>On the next step, attach the necessary permission policies (e.g., <code>AdministratorAccess</code> for testing or more granular permissions for production).</li> <li>Give the role a name, for example, <code>GitHubActionsRole</code>.</li> </ol>"},{"location":"en/secure-access/aws-oidc/#step-3-configure-trust-policy","title":"Step 3: Configure Trust Policy","text":"<ol> <li>Open the role you created and go to the \"Trust relationships\" tab.</li> <li>Click \"Edit trust policy\".</li> <li> <p>Modify the <code>Condition</code> to restrict access only to your repository and branch. This is a critical security step.</p> <p>Example for repository <code>v-grand/my-project</code> and branch <code>main</code>:</p> <p><code>json {     \"Version\": \"2012-10-17\",     \"Statement\": [         {             \"Effect\": \"Allow\",             \"Principal\": {                 \"Federated\": \"arn:aws:iam::YOUR_AWS_ACCOUNT_ID:oidc-provider/token.actions.githubusercontent.com\"             },             \"Action\": \"sts:AssumeRoleWithWebIdentity\",             \"Condition\": {                 \"StringEquals\": {                     \"token.actions.githubusercontent.com:aud\": \"sts.amazonaws.com\"                 },                 \"StringLike\": {                     \"token.actions.githubusercontent.com:sub\": \"repo:v-grand/my-project:ref:refs/heads/main\"                 }             }         }     ] }</code> Don't forget to replace <code>YOUR_AWS_ACCOUNT_ID</code> and <code>v-grand/my-project:ref:refs/heads/main</code> with your values!</p> </li> </ol>"},{"location":"en/secure-access/aws-oidc/#step-4-update-github-actions-workflow","title":"Step 4: Update GitHub Actions Workflow","text":"<p>Now update your <code>.github/workflows/deploy-aws.yml</code> to use this role.</p> <pre><code>name: Deploy to AWS via OIDC\n\n# ...\n\njobs:\n  deploy:\n    name: Deploy to AWS\n    runs-on: ubuntu-latest\n    permissions:\n      id-token: write # Required to obtain OIDC token\n      contents: read\n\n    steps:\n    - name: Checkout code\n      uses: actions/checkout@v3\n\n    - name: Configure AWS Credentials\n      uses: aws-actions/configure-aws-credentials@v1\n      with:\n        role-to-assume: arn:aws:iam::YOUR_AWS_ACCOUNT_ID:role/GitHubActionsRole # Replace with your role ARN\n        aws-region: us-east-1\n\n    - name: Setup Terraform\n      uses: hashicorp/setup-terraform@v2\n      # ...\n</code></pre> <p>Now you no longer need <code>AWS_ACCESS_KEY_ID</code> and <code>AWS_SECRET_ACCESS_KEY</code> secrets in your repository!</p>"},{"location":"en/secure-access/gcp-wif/","title":"GCP WIF","text":""},{"location":"en/secure-access/gcp-wif/#secure-gcp-access-with-workload-identity-federation","title":"Secure GCP Access with Workload Identity Federation","text":"<p>This method is recommended for setting up CI/CD (e.g., GitHub Actions) and allows you to obtain temporary GCP credentials without needing to store long-lived service account keys.</p>"},{"location":"en/secure-access/gcp-wif/#how-it-works","title":"How It Works","text":"<ol> <li>GitHub generates a unique OIDC token for each run of your workflow.</li> <li>GCP IAM trusts GitHub as an identity provider through Workload Identity Federation.</li> <li>GitHub Action passes its OIDC token to GCP.</li> <li>GCP STS validates the token and, if valid, issues temporary credentials to your workflow to impersonate the specified service account.</li> </ol>"},{"location":"en/secure-access/gcp-wif/#step-by-step-setup","title":"Step-by-Step Setup","text":""},{"location":"en/secure-access/gcp-wif/#step-1-enable-required-apis","title":"Step 1: Enable Required APIs","text":"<pre><code>gcloud services enable iamcredentials.googleapis.com\ngcloud services enable sts.googleapis.com\n</code></pre>"},{"location":"en/secure-access/gcp-wif/#step-2-create-workload-identity-pool","title":"Step 2: Create Workload Identity Pool","text":"<pre><code>gcloud iam workload-identity-pools create \"github-pool\" \\\n  --project=\"YOUR_PROJECT_ID\" \\\n  --location=\"global\" \\\n  --display-name=\"GitHub Actions Pool\"\n</code></pre>"},{"location":"en/secure-access/gcp-wif/#step-3-create-workload-identity-provider","title":"Step 3: Create Workload Identity Provider","text":"<pre><code>gcloud iam workload-identity-pools providers create-oidc \"github-provider\" \\\n  --project=\"YOUR_PROJECT_ID\" \\\n  --location=\"global\" \\\n  --workload-identity-pool=\"github-pool\" \\\n  --display-name=\"GitHub Provider\" \\\n  --attribute-mapping=\"google.subject=assertion.sub,attribute.actor=assertion.actor,attribute.repository=assertion.repository\" \\\n  --issuer-uri=\"https://token.actions.githubusercontent.com\"\n</code></pre>"},{"location":"en/secure-access/gcp-wif/#step-4-create-service-account","title":"Step 4: Create Service Account","text":"<pre><code>gcloud iam service-accounts create github-actions-sa \\\n  --project=\"YOUR_PROJECT_ID\" \\\n  --display-name=\"GitHub Actions Service Account\"\n</code></pre> <p>Grant necessary permissions to the service account:</p> <pre><code>gcloud projects add-iam-policy-binding YOUR_PROJECT_ID \\\n  --member=\"serviceAccount:github-actions-sa@YOUR_PROJECT_ID.iam.gserviceaccount.com\" \\\n  --role=\"roles/editor\"\n</code></pre>"},{"location":"en/secure-access/gcp-wif/#step-5-allow-workload-identity-pool-to-impersonate-service-account","title":"Step 5: Allow Workload Identity Pool to Impersonate Service Account","text":"<pre><code>gcloud iam service-accounts add-iam-policy-binding \\\n  github-actions-sa@YOUR_PROJECT_ID.iam.gserviceaccount.com \\\n  --project=\"YOUR_PROJECT_ID\" \\\n  --role=\"roles/iam.workloadIdentityUser\" \\\n  --member=\"principalSet://iam.googleapis.com/projects/PROJECT_NUMBER/locations/global/workloadIdentityPools/github-pool/attribute.repository/v-grand/YOUR_REPO\"\n</code></pre> <p>Important: Replace <code>PROJECT_NUMBER</code> with your GCP project number (not ID) and <code>v-grand/YOUR_REPO</code> with your repository.</p>"},{"location":"en/secure-access/gcp-wif/#step-6-get-workload-identity-provider-resource-name","title":"Step 6: Get Workload Identity Provider Resource Name","text":"<pre><code>gcloud iam workload-identity-pools providers describe \"github-provider\" \\\n  --project=\"YOUR_PROJECT_ID\" \\\n  --location=\"global\" \\\n  --workload-identity-pool=\"github-pool\" \\\n  --format=\"value(name)\"\n</code></pre> <p>Save this value - you'll need it in your GitHub Actions workflow.</p>"},{"location":"en/secure-access/gcp-wif/#step-7-update-github-actions-workflow","title":"Step 7: Update GitHub Actions Workflow","text":"<pre><code>name: Deploy to GCP via WIF\n\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    name: Deploy to GCP\n    runs-on: ubuntu-latest\n    permissions:\n      id-token: write # Required to obtain OIDC token\n      contents: read\n\n    steps:\n    - name: Checkout code\n      uses: actions/checkout@v3\n\n    - name: Authenticate to Google Cloud\n      uses: google-github-actions/auth@v1\n      with:\n        workload_identity_provider: 'projects/PROJECT_NUMBER/locations/global/workloadIdentityPools/github-pool/providers/github-provider'\n        service_account: 'github-actions-sa@YOUR_PROJECT_ID.iam.gserviceaccount.com'\n\n    - name: Set up Cloud SDK\n      uses: google-github-actions/setup-gcloud@v1\n\n    - name: Use gcloud CLI\n      run: gcloud info\n</code></pre>"},{"location":"en/secure-access/gcp-wif/#security-best-practices","title":"Security Best Practices","text":"<ol> <li>Restrict by repository: Use attribute conditions to limit access to specific repositories</li> <li>Restrict by branch: Add branch conditions in the attribute mapping</li> <li>Least privilege: Grant only necessary permissions to the service account</li> <li>Audit logs: Enable and monitor Cloud Audit Logs for service account usage</li> </ol>"},{"location":"en/secure-access/gcp-wif/#troubleshooting","title":"Troubleshooting","text":""},{"location":"en/secure-access/gcp-wif/#error-permission-denied","title":"Error: \"Permission denied\"","text":"<ul> <li>Verify the service account has necessary permissions</li> <li>Check that the workload identity pool binding is correct</li> </ul>"},{"location":"en/secure-access/gcp-wif/#error-invalid-token","title":"Error: \"Invalid token\"","text":"<ul> <li>Ensure <code>id-token: write</code> permission is set in the workflow</li> <li>Verify the issuer URI is correct</li> </ul>"},{"location":"en/secure-access/gcp-wif/#error-workload-identity-pool-not-found","title":"Error: \"Workload identity pool not found\"","text":"<ul> <li>Check that the pool and provider names match exactly</li> <li>Verify the project ID and number are correct</li> </ul> <p>Now you no longer need service account key files in your repository!</p>"},{"location":"notebooks/ci-cd-pipeline/","title":"CI/CD Pipeline","text":"In\u00a0[\u00a0]: Copied! <pre># Example: A simple build script placeholder\nprint(\"Simulating a build process...\")\n# command_to_build_artifact = \"docker build -t my-app .\"\n# os.system(command_to_build_artifact)\nprint(\"Build process simulated successfully.\")\n\n# Example: A simple test script placeholder\nprint(\"Running automated tests...\")\n# command_to_run_tests = \"pytest\"\n# os.system(command_to_run_tests)\nprint(\"Tests passed.\")\n</pre> # Example: A simple build script placeholder print(\"Simulating a build process...\") # command_to_build_artifact = \"docker build -t my-app .\" # os.system(command_to_build_artifact) print(\"Build process simulated successfully.\")  # Example: A simple test script placeholder print(\"Running automated tests...\") # command_to_run_tests = \"pytest\" # os.system(command_to_run_tests) print(\"Tests passed.\")"},{"location":"notebooks/ci-cd-pipeline/#cicd-pipeline","title":"CI/CD Pipeline\u00b6","text":"<p>This notebook provides an overview and example of a Continuous Integration/Continuous Deployment (CI/CD) pipeline.</p>"},{"location":"notebooks/ci-cd-pipeline/#what-is-cicd","title":"What is CI/CD?\u00b6","text":"<p>CI/CD is a method to deliver apps frequently to customers by introducing automation into the stages of app development.</p> <ul> <li>Continuous Integration (CI): A development practice where developers regularly merge their code changes into a central repository, after which automated builds and tests are run.</li> <li>Continuous Delivery (CD): An extension of CI to ensure that software can be released reliably at any time.</li> <li>Continuous Deployment (CD): An advanced form of CD where every change that passes all stages of the production pipeline is released to the customers.</li> </ul>"},{"location":"notebooks/ci-cd-pipeline/#example-cicd-workflow","title":"Example CI/CD Workflow\u00b6","text":"<p>Here's a simplified example of a CI/CD workflow:</p> <ol> <li>Code Commit: Developer pushes code to a version control system (e.g., Git).</li> <li>Build: An automated system compiles the code and creates an artifact.</li> <li>Test: Automated tests (unit, integration, end-to-end) are run against the artifact.</li> <li>Deploy: If all tests pass, the artifact is deployed to a staging or production environment.</li> </ol>"},{"location":"notebooks/ci-cd-pipeline/#placeholder-for-a-code-example","title":"Placeholder for a Code Example\u00b6","text":"<p>This section could contain a code example demonstrating a part of a CI/CD pipeline, such as a script for building a Docker image or deploying to a cloud service.</p>"},{"location":"notebooks/example/","title":"Example Notebook","text":"In\u00a0[\u00a0]: Copied! <pre>print(\"Hello from the example notebook!\")\n\n# You can also define variables and perform calculations\nx = 10\ny = 20\nz = x + y\nprint(f\"The sum of x and y is: {z}\")\n</pre> print(\"Hello from the example notebook!\")  # You can also define variables and perform calculations x = 10 y = 20 z = x + y print(f\"The sum of x and y is: {z}\")"},{"location":"notebooks/example/#example-notebook","title":"Example Notebook\u00b6","text":"<p>This is an example notebook to demonstrate the basic structure and usage of Jupyter notebooks within this project.</p> <p>You can add markdown cells for documentation and code cells for executable code.</p>"},{"location":"notebooks/example/#markdown-example","title":"Markdown Example\u00b6","text":"<p>This is a paragraph in a markdown cell.</p> <ul> <li>Item 1</li> <li>Item 2</li> </ul>"},{"location":"notebooks/example/#code-example","title":"Code Example\u00b6","text":"<p>Here's a simple Python code cell.</p>"},{"location":"notebooks/infra-core-usage/","title":"Infrastructure as Code with infra-core","text":"In\u00a0[\u00a0]: Copied! <pre>!terraform --version\n</pre> !terraform --version In\u00a0[\u00a0]: Copied! <pre>%%writefile main.tf\n\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\nmodule \"aws_vm\" {\n  source        = \"./modules/vm\"\n  provider      = \"aws\"\n  instance_type = \"t3.micro\"\n  ami           = \"ami-0c55b159cbfafe1f0\" # Example AMI (Amazon Linux 2)\n  tags = {\n    Name        = \"demo-instance\"\n    Environment = \"notebook-demo\"\n  }\n}\n</pre> %%writefile main.tf  provider \"aws\" {   region = \"us-east-1\" }  module \"aws_vm\" {   source        = \"./modules/vm\"   provider      = \"aws\"   instance_type = \"t3.micro\"   ami           = \"ami-0c55b159cbfafe1f0\" # Example AMI (Amazon Linux 2)   tags = {     Name        = \"demo-instance\"     Environment = \"notebook-demo\"   } } In\u00a0[\u00a0]: Copied! <pre>!terraform init\n</pre> !terraform init In\u00a0[\u00a0]: Copied! <pre>!terraform plan\n</pre> !terraform plan In\u00a0[\u00a0]: Copied! <pre>%%writefile main.tf\n\nprovider \"google\" {\n  project = \"my-gcp-project-id\"\n  region  = \"us-central1\"\n}\n\nmodule \"gcp_vm\" {\n  source   = \"./modules/vm\"\n  provider = \"gcp\"\n  name     = \"gcp-demo-instance\"\n  zone     = \"us-central1-a\"\n  image    = \"debian-cloud/debian-11\"\n  instance_type = \"e2-micro\"\n}\n</pre> %%writefile main.tf  provider \"google\" {   project = \"my-gcp-project-id\"   region  = \"us-central1\" }  module \"gcp_vm\" {   source   = \"./modules/vm\"   provider = \"gcp\"   name     = \"gcp-demo-instance\"   zone     = \"us-central1-a\"   image    = \"debian-cloud/debian-11\"   instance_type = \"e2-micro\" } <p>Re-run init and plan to see the changes.</p> In\u00a0[\u00a0]: Copied! <pre>!terraform init\n!terraform plan\n</pre> !terraform init !terraform plan"},{"location":"notebooks/infra-core-usage/#infrastructure-as-code-with-infra-core","title":"Infrastructure as Code with infra-core\u00b6","text":"<p>Welcome to the interactive usage guide for <code>infra-core</code>. This notebook demonstrates how to use the provided Terraform modules to provision infrastructure across different cloud providers.</p>"},{"location":"notebooks/infra-core-usage/#prerequisites","title":"Prerequisites\u00b6","text":"<ul> <li>Terraform installed and in your PATH.</li> <li>AWS/GCP credentials configured (e.g., via <code>aws configure</code> or environment variables).</li> </ul>"},{"location":"notebooks/infra-core-usage/#example-1-provisioning-an-aws-ec2-instance","title":"Example 1: Provisioning an AWS EC2 Instance\u00b6","text":"<p>In this example, we will use the <code>vm</code> module to create a simple EC2 instance in AWS.</p>"},{"location":"notebooks/infra-core-usage/#initialize-terraform","title":"Initialize Terraform\u00b6","text":"<p>Initialize the working directory containing Terraform configuration files. This is the first command that should be run after writing a new Terraform configuration.</p>"},{"location":"notebooks/infra-core-usage/#plan-the-deployment","title":"Plan the Deployment\u00b6","text":"<p>Create an execution plan. Terraform performs a refresh, unless explicitly disabled, and then determines what actions are necessary to achieve the desired state specified in the configuration files.</p>"},{"location":"notebooks/infra-core-usage/#example-2-provisioning-a-gcp-compute-instance","title":"Example 2: Provisioning a GCP Compute Instance\u00b6","text":"<p>Now let's switch to Google Cloud Platform. We can reuse the same module structure but with different parameters.</p>"},{"location":"notebooks/tailscale-mesh/","title":"Tailscale Mesh","text":"In\u00a0[\u00a0]: Copied! <pre># Example: Check Tailscale status (requires Tailscale to be installed and running)\nimport subprocess\n\ntry:\n    result = subprocess.run([\"tailscale\", \"status\"], capture_output=True, text=True, check=True)\n    print(\"Tailscale Status:\")\n    print(result.stdout)\nexcept FileNotFoundError:\n    print(\"Tailscale command not found. Please ensure Tailscale is installed and in your PATH.\")\nexcept subprocess.CalledProcessError as e:\n    print(f\"Error running tailscale status: {e}\")\n    print(e.stderr)\n\n# Example: Placeholder for adding a device or configuring a subnet router via API or CLI\n# print(\"\\nSimulating Tailscale device addition...\")\n# command_to_add_device = \"tailscale up --authkey tskey-...\"\n# print(f\"Run '{command_to_add_device}' on a new device to add it to your network.\")\n</pre> # Example: Check Tailscale status (requires Tailscale to be installed and running) import subprocess  try:     result = subprocess.run([\"tailscale\", \"status\"], capture_output=True, text=True, check=True)     print(\"Tailscale Status:\")     print(result.stdout) except FileNotFoundError:     print(\"Tailscale command not found. Please ensure Tailscale is installed and in your PATH.\") except subprocess.CalledProcessError as e:     print(f\"Error running tailscale status: {e}\")     print(e.stderr)  # Example: Placeholder for adding a device or configuring a subnet router via API or CLI # print(\"\\nSimulating Tailscale device addition...\") # command_to_add_device = \"tailscale up --authkey tskey-...\" # print(f\"Run '{command_to_add_device}' on a new device to add it to your network.\")"},{"location":"notebooks/tailscale-mesh/#tailscale-mesh","title":"Tailscale Mesh\u00b6","text":"<p>This notebook explores the concept of a Tailscale mesh network and how to set it up.</p>"},{"location":"notebooks/tailscale-mesh/#what-is-tailscale","title":"What is Tailscale?\u00b6","text":"<p>Tailscale is a zero-config VPN based on WireGuard that installs on any device in minutes, enabling secure, encrypted connectivity between your servers, computers, and cloud instances. It creates a secure network mesh between your devices, regardless of their physical location or the networks they are on.</p>"},{"location":"notebooks/tailscale-mesh/#key-features-of-tailscale","title":"Key Features of Tailscale\u00b6","text":"<ul> <li>Zero Configuration: Easy setup without complex firewall rules or network configurations.</li> <li>WireGuard-based: Leverages the security and performance of the WireGuard protocol.</li> <li>Identity-based Security: Uses existing identity providers (e.g., Google, Microsoft, GitHub) for authentication.</li> <li>Access Control Lists (ACLs): Fine-grained control over which devices can connect to each other.</li> <li>Subnet Routers: Allows devices in your Tailscale network to access devices on your physical subnets that don't have Tailscale installed.</li> </ul>"},{"location":"notebooks/tailscale-mesh/#setting-up-a-tailscale-network","title":"Setting up a Tailscale Network\u00b6","text":"<p>Setting up Tailscale typically involves:</p> <ol> <li>Installing Tailscale: Install the client on your devices (laptops, servers, VMs).</li> <li>Authenticating Devices: Log in with your identity provider to add devices to your Tailscale network.</li> <li>Configuring ACLs: Optionally define access rules for your network.</li> </ol>"},{"location":"notebooks/tailscale-mesh/#placeholder-for-a-code-example","title":"Placeholder for a Code Example\u00b6","text":"<p>This section could contain a code example demonstrating how to interact with the Tailscale API, or how to use Tailscale commands to manage your network.</p>"},{"location":"notebooks/terraform-demo/","title":"Terraform Demo","text":"In\u00a0[\u00a0]: Copied! <pre># Example: A simple Terraform configuration for an AWS S3 bucket\n# This would typically be in a .tf file, but for demonstration, we'll show the content.\n\nterraform_config = \"\"\"\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\nresource \"aws_s3_bucket\" \"example_bucket\" {\n  bucket = \"my-unique-terraform-example-bucket-12345\" # Bucket names must be globally unique\n  acl    = \"private\"\n\n  tags = {\n    Name        = \"MyTerraformExampleBucket\"\n    Environment = \"Dev\"\n  }\n}\n\noutput \"bucket_name\" {\n  value = aws_s3_bucket.example_bucket.bucket\n}\n\"\"\"\n\nprint(\"Example Terraform Configuration (for a .tf file):\")\nprint(terraform_config)\n\n# To actually run this, you would save it to a file (e.g., main.tf)\n# and then execute 'terraform init', 'terraform plan', 'terraform apply' in your terminal.\n\n# import os\n# with open(\"main.tf\", \"w\") as f:\n#     f.write(terraform_config)\n# print(\"\\n'main.tf' created. You can now run 'terraform init', 'terraform plan', 'terraform apply'.\")\n</pre> # Example: A simple Terraform configuration for an AWS S3 bucket # This would typically be in a .tf file, but for demonstration, we'll show the content.  terraform_config = \"\"\" provider \"aws\" {   region = \"us-east-1\" }  resource \"aws_s3_bucket\" \"example_bucket\" {   bucket = \"my-unique-terraform-example-bucket-12345\" # Bucket names must be globally unique   acl    = \"private\"    tags = {     Name        = \"MyTerraformExampleBucket\"     Environment = \"Dev\"   } }  output \"bucket_name\" {   value = aws_s3_bucket.example_bucket.bucket } \"\"\"  print(\"Example Terraform Configuration (for a .tf file):\") print(terraform_config)  # To actually run this, you would save it to a file (e.g., main.tf) # and then execute 'terraform init', 'terraform plan', 'terraform apply' in your terminal.  # import os # with open(\"main.tf\", \"w\") as f: #     f.write(terraform_config) # print(\"\\n'main.tf' created. You can now run 'terraform init', 'terraform plan', 'terraform apply'.\")"},{"location":"notebooks/terraform-demo/#terraform-demo","title":"Terraform Demo\u00b6","text":"<p>This notebook provides a demonstration of Terraform, an Infrastructure as Code (IaC) tool.</p>"},{"location":"notebooks/terraform-demo/#what-is-terraform","title":"What is Terraform?\u00b6","text":"<p>Terraform is an open-source IaC tool created by HashiCorp. It allows you to define and provision infrastructure using a high-level configuration language. With Terraform, you can manage a wide range of resources, including virtual machines, networks, and databases, across various cloud providers (AWS, Azure, GCP, etc.) and on-premise solutions.</p>"},{"location":"notebooks/terraform-demo/#key-concepts-of-terraform","title":"Key Concepts of Terraform\u00b6","text":"<ul> <li>Infrastructure as Code (IaC): Managing and provisioning computer data centers through machine-readable definition files, rather than physical hardware configuration or interactive configuration tools.</li> <li>Providers: Terraform relies on providers to interact with cloud platforms and other services. Each provider offers resources that Terraform can manage.</li> <li>Resources: These are the infrastructure components (e.g., a virtual machine, a network interface, a database).</li> <li>Modules: Reusable, shareable, and composable infrastructure configurations.</li> <li>State: Terraform maintains a state file that maps real-world resources to your configuration, tracks metadata, and improves performance for large infrastructures.</li> </ul>"},{"location":"notebooks/terraform-demo/#basic-terraform-workflow","title":"Basic Terraform Workflow\u00b6","text":"<ol> <li>Write Configuration: Define your infrastructure in <code>.tf</code> files using HashiCorp Configuration Language (HCL).</li> <li>Initialize: Run <code>terraform init</code> to download necessary provider plugins.</li> <li>Plan: Run <code>terraform plan</code> to see what actions Terraform will take to achieve the desired state without making any changes.</li> <li>Apply: Run <code>terraform apply</code> to execute the planned actions and provision your infrastructure.</li> <li>Destroy: Run <code>terraform destroy</code> to tear down all the infrastructure managed by your Terraform configuration.</li> </ol>"},{"location":"notebooks/terraform-demo/#placeholder-for-a-code-example","title":"Placeholder for a Code Example\u00b6","text":"<p>This section could contain a code example demonstrating a simple Terraform configuration, such as provisioning a basic cloud resource.</p>"},{"location":"pl/","title":"Home","text":"<ul> <li>English</li> </ul>"},{"location":"pl/#witamy-w-infra-docs","title":"Witamy w Infra Docs","text":"<p>Witamy w pe\u0142nej dokumentacji ekosystemu infrastruktury v-grand. Ten zestaw repozytori\u00f3w zapewnia gotowe rozwi\u0105zanie produkcyjne dla wdro\u017ce\u0144 wielochmurowych.</p>"},{"location":"pl/#przeglad-architektury","title":"\ud83d\udcda Przegl\u0105d architektury","text":"<p>Ekosystem infrastruktury zbudowany jest na architekturze modu\u0142owej, gdzie ka\u017cde repozytorium s\u0142u\u017cy okre\u015blonemu celowi:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    infra-docs       \u2502  \u2190 Dokumentacja i przyk\u0142ady\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n          \u2502\n          \u251c\u2500\u25ba infra-core       (Modu\u0142y Terraform wielokrotnego u\u017cytku)\n          \u251c\u2500\u25ba infra-template   (Szablon projektu)\n          \u251c\u2500\u25ba infra-ci         (Przep\u0142ywy pracy CI/CD)\n          \u2502\n          \u2514\u2500\u25ba Repozytoria aplikacji:\n              \u251c\u2500\u25ba template-platform (Ten projekt)\n              \u251c\u2500\u25ba infra-aws        (Infrastruktura AWS)\n              \u251c\u2500\u25ba infra-gcp        (Infrastruktura GCP)\n              \u251c\u2500\u25ba infra-network    (Konfiguracja sieci)\n              \u251c\u2500\u25ba infra-monitoring (Stos monitorowania)\n              \u251c\u2500\u25ba infra-secrets    (Zarz\u0105dzanie sekretami)\n              \u2514\u2500\u25ba infra-k8s        (Klastry Kubernetes)\n</code></pre>"},{"location":"pl/#przewodnik-po-repozytoriach","title":"\ud83d\uddc2\ufe0f Przewodnik po repozytoriach","text":""},{"location":"pl/#gowne-biblioteki","title":"G\u0142\u00f3wne biblioteki","text":"Repozytorium Przeznaczenie Status infra-core Modu\u0142y Terraform wielokrotnego u\u017cytku (VM, VPC, DB, K8s, Tailscale) \u2705 Aktywny infra-template Standaryzowany szablon dla nowych projekt\u00f3w \u2705 Aktywny template-platform Fundamentalna us\u0142uga backendowa dla nowych aplikacji. \u2705 Aktywny infra-ci Przep\u0142ywy pracy GitHub Actions wielokrotnego u\u017cytku dla CI/CD \u2705 Aktywny infra-docs Strona dokumentacji (ta strona) \u2705 Aktywny"},{"location":"pl/#infrastruktura-chmurowa","title":"Infrastruktura chmurowa","text":"Repozytorium Przeznaczenie Obs\u0142ugiwane chmury infra-aws Wdra\u017canie infrastruktury AWS AWS infra-gcp Wdra\u017canie infrastruktury GCP GCP infra-network VPC, VPN, sie\u0107 mesh Tailscale AWS, GCP"},{"location":"pl/#usugi-platformowe","title":"Us\u0142ugi platformowe","text":"Repozytorium Przeznaczenie Kluczowe technologie infra-monitoring Stos obserwowalno\u015bci i logowania Prometheus, Grafana, Loki infra-secrets Scentralizowane zarz\u0105dzanie sekretami Vault, SOPS, GCP Secrets infra-k8s Zarz\u0105dzanie klastrami Kubernetes GKE, EKS, K3s"},{"location":"pl/#szybki-start","title":"\ud83d\ude80 Szybki start","text":""},{"location":"pl/#dla-nowych-projektow","title":"Dla nowych projekt\u00f3w","text":"<ol> <li> <p>Sklonuj szablon: <code>bash    git clone https://github.com/v-grand/infra-template.git my-new-project    cd my-new-project</code></p> </li> <li> <p>Skonfiguruj \u015brodowisko: <code>bash    cp terraform.tfvars.example terraform.tfvars    # Edytuj terraform.tfvars z w\u0142asnymi ustawieniami</code></p> </li> <li> <p>Wdr\u00f3\u017c: <code>bash    terraform init    terraform plan    terraform apply</code></p> </li> </ol>"},{"location":"pl/#dla-istniejacych-projektow","title":"Dla istniej\u0105cych projekt\u00f3w","text":"<p>Wybierz odpowiednie repozytorium:</p> <ul> <li>Wdro\u017cenie AWS \u2192 infra-aws</li> <li>Wdro\u017cenie GCP \u2192 infra-gcp</li> <li>Kubernetes \u2192 infra-k8s</li> <li>Monitorowanie \u2192 infra-monitoring</li> </ul>"},{"location":"pl/#struktura-dokumentacji","title":"\ud83d\udcd6 Struktura dokumentacji","text":"<ul> <li>Modu\u0142y Infra Core - Szczeg\u00f3\u0142owa dokumentacja modu\u0142\u00f3w</li> <li>Przyk\u0142ady AWS - Przyk\u0142ady wdro\u017ce\u0144 AWS</li> <li>Przewodniki GCP - Dokumentacja dla GCP</li> <li>Integracja Tailscale - Konfiguracja sieci mesh</li> <li>Notatniki - Interaktywne przyk\u0142ady i samouczki</li> </ul>"},{"location":"pl/#zasoby-zewnetrzne","title":"\ud83d\udd17 Zasoby zewn\u0119trzne","text":"<ul> <li>Dokumentacja Terraform</li> <li>Dokumentacja GitHub Actions</li> <li>AWS Well-Architected Framework</li> <li>Google Cloud Architecture Center</li> </ul>"},{"location":"pl/#wkad-w-projekt","title":"\ud83e\udd1d Wk\u0142ad w projekt","text":"<p>Zapraszamy do wsp\u00f3\u0142tworzenia projektu! Prosimy zapozna\u0107 si\u0119 z wytycznymi dotycz\u0105cymi wk\u0142adu w poszczeg\u00f3lnych repozytoriach.</p>"},{"location":"pl/#licencja","title":"\ud83d\udcc4 Licencja","text":"<p>Wszystkie repozytoria s\u0105 obj\u0119te licencj\u0105 MIT, chyba \u017ce zaznaczono inaczej.</p>"},{"location":"pl/aws/","title":"AWS (English)","text":""},{"location":"pl/aws/#infrastruktura-aws","title":"Infrastruktura AWS","text":"<p>Dokumentacja dotycz\u0105ca infrastruktury AWS.</p>"},{"location":"pl/infra-ci/","title":"Infra CI","text":""},{"location":"pl/infra-ci/#szybki-start-infra-ci","title":"Szybki start: infra-ci","text":"<p>Dokumentacja jest w trakcie t\u0142umaczenia.</p> <p>Zobacz wersj\u0119 angielsk\u0105 dla pe\u0142nej dokumentacji.</p>"},{"location":"pl/infra-ci/#krotki-opis","title":"Kr\u00f3tki opis","text":"<p>infra-ci - scentralizowane repozytorium z ponownie u\u017cywanymi przep\u0142ywami pracy GitHub Actions do automatyzacji proces\u00f3w CI/CD.</p>"},{"location":"pl/infra-ci/#gowne-mozliwosci","title":"G\u0142\u00f3wne mo\u017cliwo\u015bci","text":"<ul> <li>Ponownie u\u017cywane przep\u0142ywy pracy Terraform</li> <li>Automatyczna walidacja kodu</li> <li>Integracja z SOPS dla sekret\u00f3w</li> <li>Obs\u0142uga wdro\u017ce\u0144 multi-cloud</li> </ul>"},{"location":"pl/infra-ci/#szybkie-uzycie","title":"Szybkie u\u017cycie","text":"<pre><code># .github/workflows/deploy.yml\nname: Deploy Infrastructure\non:\n  push:\n    branches: [main]\n\njobs:\n  terraform:\n    uses: v-grand/infra-ci/.github/workflows/reusable/terraform-plan.yml@main\n    with:\n      working-directory: ./\n      environment: dev\n    secrets: inherit\n</code></pre> <p>Pe\u0142na dokumentacja: English version</p>"},{"location":"pl/infra-core/","title":"Infra Core","text":""},{"location":"pl/infra-core/#infra-core","title":"infra-core","text":"<p>Kompleksowa biblioteka modu\u0142\u00f3w Terraform wielokrotnego u\u017cytku, przeznaczona do zarz\u0105dzania infrastruktur\u0105 wielochmurow\u0105. Biblioteka ta obs\u0142uguje AWS, GCP, Hetzner i Contabo, umo\u017cliwiaj\u0105c elastyczne i niezale\u017cne od platformy wdra\u017canie infrastruktury.</p>"},{"location":"pl/infra-core/#funkcje","title":"\ud83d\ude80 Funkcje","text":"<ul> <li>Wsparcie dla wielu chmur: Bezproblemowe przydzielanie zasob\u00f3w u g\u0142\u00f3wnych dostawc\u00f3w chmurowych.</li> <li>Modu\u0142owa konstrukcja: Komponenty wielokrotnego u\u017cytku dla maszyn wirtualnych, VPC, baz danych i innych.</li> <li>Najlepsze praktyki: Zbudowane z my\u015bl\u0105 o bezpiecze\u0144stwie i skalowalno\u015bci.</li> <li>Integracja z Tailscale: \u0141atwa konfiguracja bezpiecznej sieci kratowej.</li> </ul>"},{"location":"pl/infra-core/#moduy","title":"\ud83d\udce6 Modu\u0142y","text":"Modu\u0142 Opis Obs\u0142ugiwani dostawcy <code>vm</code> Tworzenie maszyn wirtualnych (EC2, GCE) AWS, GCP <code>vpc</code> Konfiguracja sieci (VPC, podsieci) AWS, GCP <code>db</code> Zarz\u0105dzane bazy danych (RDS, Cloud SQL) AWS, GCP <code>tailscale</code> Sie\u0107 kratowa Tailscale Wszyscy <code>k8s</code> Klastry Kubernetes (EKS, GKE) AWS, GCP"},{"location":"pl/infra-core/#wymagania-wstepne","title":"\ud83d\udee0\ufe0f Wymagania wst\u0119pne","text":"<ul> <li>Terraform &gt;= 1.0</li> <li>Po\u015bwiadczenia dostawcy chmury (skonfigurowane za pomoc\u0105 zmiennych \u015brodowiskowych lub CLI)</li> </ul>"},{"location":"pl/infra-core/#uzycie","title":"\ud83d\udcd6 U\u017cycie","text":"<p>Oto podstawowy przyk\u0142ad u\u017cycia modu\u0142u <code>vm</code> w konfiguracji Terraform:</p> <pre><code>module \"my_web_server\" {\n  source        = \"./modules/vm\" # Lub \u017ar\u00f3d\u0142o z git\n  provider      = \"aws\"\n  instance_type = \"t3.micro\"\n  ami           = \"ami-0c55b159cbfafe1f0\"\n  tags = {\n    Environment = \"dev\"\n  }\n}\n</code></pre>"},{"location":"pl/infra-k8s/","title":"Kubernetes","text":""},{"location":"pl/infra-k8s/#rozpoczecie-pracy-infra-k8s","title":"Rozpocz\u0119cie pracy: infra-k8s","text":"<p>Dokumentacja jest w trakcie t\u0142umaczenia.</p> <p>Zobacz wersj\u0119 angielsk\u0105 dla pe\u0142nej dokumentacji.</p>"},{"location":"pl/infra-k8s/#krotki-opis","title":"Kr\u00f3tki opis","text":"<p>infra-k8s zarz\u0105dza klastrami Kubernetes w GKE, EKS i K3s.</p> <p>Pe\u0142na dokumentacja: English version</p>"},{"location":"pl/infra-monitoring/","title":"Monitoring","text":""},{"location":"pl/infra-monitoring/#rozpoczecie-pracy-infra-monitoring","title":"Rozpocz\u0119cie pracy: infra-monitoring","text":"<p>Dokumentacja jest w trakcie t\u0142umaczenia.</p> <p>Zobacz wersj\u0119 angielsk\u0105 dla pe\u0142nej dokumentacji.</p>"},{"location":"pl/infra-monitoring/#krotki-opis","title":"Kr\u00f3tki opis","text":"<p>infra-monitoring zapewnia pe\u0142ny stos monitorowania z Prometheus, Grafana i Loki.</p> <p>Pe\u0142na dokumentacja: English version</p>"},{"location":"pl/infra-network/","title":"Network","text":""},{"location":"pl/infra-network/#rozpoczecie-pracy-infra-network","title":"Rozpocz\u0119cie pracy: infra-network","text":"<p>Dokumentacja jest w trakcie t\u0142umaczenia.</p> <p>Zobacz wersj\u0119 angielsk\u0105 dla pe\u0142nej dokumentacji.</p>"},{"location":"pl/infra-network/#krotki-opis","title":"Kr\u00f3tki opis","text":"<p>infra-network zarz\u0105dza infrastruktur\u0105 sieciow\u0105, w tym VPC, VPN i sieci\u0105 mesh Tailscale.</p>"},{"location":"pl/infra-network/#gowne-moduy","title":"G\u0142\u00f3wne modu\u0142y","text":"<ul> <li>VPC AWS - Virtual Private Cloud dla AWS</li> <li>VPC GCP - Virtual Private Cloud dla GCP</li> <li>VPN - Konfiguracja VPN typu Site-to-site</li> <li>Tailscale - Sie\u0107 mesh bez konfiguracji</li> </ul> <p>Pe\u0142na dokumentacja: English version</p>"},{"location":"pl/infra-secrets/","title":"Secrets Management","text":""},{"location":"pl/infra-secrets/#rozpoczecie-pracy-infra-secrets","title":"Rozpocz\u0119cie pracy: infra-secrets","text":"<p>Dokumentacja jest w trakcie t\u0142umaczenia.</p> <p>Zobacz wersj\u0119 angielsk\u0105 dla pe\u0142nej dokumentacji.</p>"},{"location":"pl/infra-secrets/#krotki-opis","title":"Kr\u00f3tki opis","text":"<p>infra-secrets zapewnia scentralizowane zarz\u0105dzanie sekretami poprzez Vault, SOPS i rozwi\u0105zania cloud-native.</p> <p>Pe\u0142na dokumentacja: English version</p>"},{"location":"pl/infra-template/","title":"Infra Template","text":""},{"location":"pl/infra-template/#rozpoczecie-pracy-infra-template","title":"Rozpocz\u0119cie pracy: infra-template","text":"<p>Dokumentacja jest w trakcie t\u0142umaczenia.</p> <p>Zobacz wersj\u0119 angielsk\u0105 dla pe\u0142nej dokumentacji.</p>"},{"location":"pl/infra-template/#krotki-opis","title":"Kr\u00f3tki opis","text":"<p>infra-template - ustandaryzowany szablon dla nowych projekt\u00f3w infrastrukturalnych.</p> <p>Pe\u0142na dokumentacja: English version</p>"},{"location":"pl/tailscale/","title":"Tailscale","text":""},{"location":"pl/tailscale/#siec-kratowa-tailscale","title":"Sie\u0107 kratowa Tailscale","text":"<p>Dokumentacja dotycz\u0105ca sieci kratowej Tailscale.</p>"},{"location":"pl/template-platform/","title":"Template Platform","text":""},{"location":"pl/template-platform/#template-platform","title":"Template Platform","text":"<p>Template Platform to fundamentalna us\u0142uga backendowa, zaprojektowana jako gotowy do u\u017cycia, skalowalny i \u0142atwy w utrzymaniu punkt wyj\u015bcia \u0434\u043b\u044f nowych aplikacji. Integruje si\u0119 bezproblemowo z komponentami infrastruktury dostarczanymi przez <code>infra-core</code> i <code>infra-template</code>, a jej wdro\u017cenie jest zarz\u0105dzane przez potoki z <code>infra-ci</code>.</p>"},{"location":"pl/template-platform/#gowny-cel","title":"G\u0142\u00f3wny cel","text":"<p>G\u0142\u00f3wnym celem <code>template-platform</code> jest przyspieszenie rozwoju poprzez oferowanie wst\u0119pnie skonfigurowanego \u015brodowiska, kt\u00f3re obejmuje:</p> <ul> <li>Szablon API: Podstawowa struktura do tworzenia API RESTful lub GraphQL.</li> <li>Integracja z baz\u0105 danych: Wst\u0119pnie skonfigurowane po\u0142\u0105czenia ze standardowymi bazami danych.</li> <li>Integracja z CI/CD: Gotowo\u015b\u0107 do wdro\u017cenia w \u015brodowiskach <code>dev</code> i <code>stage</code> od razu po wyj\u0119ciu z pude\u0142ka, przy u\u017cyciu <code>infra-ci</code>.</li> <li>Obserwowalno\u015b\u0107 (Observability): Haki do logowania, metryk i \u015bledzenia.</li> </ul>"},{"location":"pl/template-platform/#pierwsze-kroki","title":"Pierwsze kroki","text":"<p>Aby rozpocz\u0105\u0107 prac\u0119 z <code>template-platform</code>, upewnij si\u0119, \u017ce sklonowa\u0142e\u015b repozytorium i zainicjowa\u0142e\u015b jego submodu\u0142y:</p> <pre><code>git clone &lt;your-repo-url&gt;/template-platform.git\ncd template-platform\ngit submodule update --init --recursive\n</code></pre> <p>Us\u0142ug\u0119 mo\u017cna uruchomi\u0107 lokalnie za pomoc\u0105 Docker Compose:</p> <pre><code>docker-compose up --build\n</code></pre>"},{"location":"pl/template-platform/#wdrozenie","title":"Wdro\u017cenie","text":"<p>Wdro\u017cenia s\u0105 obs\u0142ugiwane automatycznie przez GitHub Actions po wypchni\u0119ciu do ga\u0142\u0119zi <code>main</code> (dla \u015brodowiska <code>dev</code>) lub mog\u0105 by\u0107 uruchamiane r\u0119cznie (dla \u015brodowiska <code>stage</code>). Potok wykorzystuje konfiguracje Terraform zdefiniowane w repozytorium <code>template-platform</code>, kt\u00f3re z kolei korzystaj\u0105 z modu\u0142\u00f3w z <code>infra-template</code>.</p>"},{"location":"pl/examples/aws-dev/","title":"AWS Dev","text":""},{"location":"pl/examples/aws-dev/#przykad-srodowiska-deweloperskiego-w-aws","title":"Przyk\u0142ad \u015brodowiska deweloperskiego w AWS","text":"<p>Ten przyk\u0142ad pokazuje, jak skonfigurowa\u0107 kompletne \u015brodowisko deweloperskie w AWS przy u\u017cyciu modu\u0142\u00f3w <code>infra-core</code>.</p> <p>Obejmuje on: - VPC z podsieciami - Instancj\u0119 EC2 (VM) - Baz\u0119 danych RDS MySQL - Integracj\u0119 z Tailscale dla bezpiecznego dost\u0119pu</p>"},{"location":"pl/examples/aws-dev/#konfiguracja-maintf","title":"Konfiguracja (<code>main.tf</code>)","text":"<pre><code># main.tf dla przyk\u0142adu aws-dev\n\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\nmodule \"vpc\" {\n  source = \"../../modules/vpc\"\n\n  provider          = \"aws\"\n  cidr_block        = \"10.0.0.0/16\"\n  subnet_cidr_block = \"10.0.1.0/24\"\n  tags = {\n    Name = \"aws-dev-vpc\"\n  }\n}\n\nmodule \"vm\" {\n  source = \"../../modules/vm\"\n\n  provider      = \"aws\"\n  ami           = \"ami-0c55b159cbfafe1f0\" # us-east-1\n  instance_type = \"t2.micro\"\n  tags = {\n    Name = \"aws-dev-vm\"\n  }\n}\n\nmodule \"db\" {\n  source = \"../../modules/db\"\n\n  provider          = \"aws\"\n  allocated_storage = 20\n  engine            = \"mysql\"\n  engine_version    = \"8.0\"\n  instance_class    = \"db.t2.micro\"\n  db_name           = \"awsdevdb\"\n  username          = \"user\"\n  password          = \"password\" # Zast\u0105p bezpiecznym has\u0142em\n  tags = {\n    Name = \"aws-dev-db\"\n  }\n}\n\nmodule \"tailscale\" {\n  source = \"../../modules/tailscale\"\n\n  instance_id      = module.vm.instance_id\n  auth_key         = \"your-tailscale-auth-key\" # Zast\u0105p swoim kluczem uwierzytelniaj\u0105cym\n  ssh_user         = \"ec2-user\"\n  private_key_path = \"~/.ssh/id_rsa\" # Zast\u0105p \u015bcie\u017ck\u0105 do swojego klucza prywatnego\n  host             = module.vm.public_ip\n}\n\noutput \"vpc_id\" {\n  value = module.vpc.vpc_id\n}\n\noutput \"vm_id\" {\n  value = module.vm.instance_id\n}\n\noutput \"db_id\" {\n  value = module.db.db_instance_id\n}\n</code></pre>"},{"location":"pl/gcp/","title":"Home","text":""},{"location":"pl/gcp/#google-cloud-platform-gcp","title":"Google Cloud Platform (GCP)","text":"<p>Ta sekcja zawiera dokumentacj\u0119 zwi\u0105zan\u0105 z Google Cloud Platform.</p>"},{"location":"pl/gcp/db/","title":"DB","text":""},{"location":"pl/gcp/db/#dokumentacja-bazy-danych","title":"Dokumentacja bazy danych","text":""},{"location":"pl/gcp/db/#przeglad","title":"Przegl\u0105d","text":"<ul> <li>Nazwa instancji: [Wprowad\u017a nazw\u0119 instancji bazy danych]</li> <li>Projekt: [Wprowad\u017a identyfikator projektu GCP]</li> <li>Region: [Wprowad\u017a region GCP]</li> <li>Typ bazy danych: [np. PostgreSQL 13, MySQL 8]</li> <li>Rozmiar instancji: [np. db-n1-standard-1]</li> </ul>"},{"location":"pl/gcp/db/#szczegoy-poaczenia","title":"Szczeg\u00f3\u0142y po\u0142\u0105czenia","text":"<ul> <li>Nazwa po\u0142\u0105czenia: [Wprowad\u017a nazw\u0119 po\u0142\u0105czenia instancji]</li> <li>Publiczny adres IP: [Wprowad\u017a publiczny adres IP lub \"Wy\u0142\u0105czony\"]</li> <li>Prywatny adres IP: [Wprowad\u017a prywatny adres IP lub \"Wy\u0142\u0105czony\"]</li> </ul>"},{"location":"pl/gcp/db/#kopia-zapasowa-i-konserwacja","title":"Kopia zapasowa i konserwacja","text":"<ul> <li>Harmonogram tworzenia kopii zapasowych: [np. codziennie o 01:00 UTC]</li> <li>Okno konserwacji: [np. niedziela 03:00-04:00 UTC]</li> </ul>"},{"location":"pl/gcp/db/#notatki","title":"Notatki","text":"<p>[Dodaj wszelkie dodatkowe notatki tutaj]</p>"},{"location":"pl/gcp/k8s/","title":"K8s","text":""},{"location":"pl/gcp/k8s/#dokumentacja-klastra-kubernetes","title":"Dokumentacja klastra Kubernetes","text":""},{"location":"pl/gcp/k8s/#przeglad","title":"Przegl\u0105d","text":"<ul> <li>Nazwa klastra: [Wprowad\u017a nazw\u0119 klastra]</li> <li>Projekt: [Wprowad\u017a identyfikator projektu GCP]</li> <li>Lokalizacja: [Wprowad\u017a stref\u0119 lub region GCP]</li> <li>Wersja Kubernetes: [np. 1.23]</li> </ul>"},{"location":"pl/gcp/k8s/#pule-wezow","title":"Pule w\u0119z\u0142\u00f3w","text":"Nazwa puli w\u0119z\u0142\u00f3w Typ maszyny Liczba w\u0119z\u0142\u00f3w Autoskalowanie [np. default-pool] [np. e2-medium] [np. 3] [np. W\u0142\u0105czone]"},{"location":"pl/gcp/k8s/#siec","title":"Sie\u0107","text":"<ul> <li>VPC: [Wprowad\u017a nazw\u0119 VPC]</li> <li>Podsie\u0107: [Wprowad\u017a nazw\u0119 podsieci]</li> <li>Zakres adres\u00f3w pod\u00f3w: [Wprowad\u017a CIDR pod\u00f3w]</li> <li>Zakres adres\u00f3w us\u0142ug: [Wprowad\u017a CIDR us\u0142ug]</li> </ul>"},{"location":"pl/gcp/k8s/#bezpieczenstwo","title":"Bezpiecze\u0144stwo","text":"<ul> <li>RBAC: [W\u0142\u0105czone/Wy\u0142\u0105czone]</li> <li>Workload Identity: [W\u0142\u0105czone/Wy\u0142\u0105czone]</li> </ul>"},{"location":"pl/gcp/k8s/#notatki","title":"Notatki","text":"<p>[Dodaj wszelkie dodatkowe notatki tutaj]</p>"},{"location":"pl/gcp/vm/","title":"VM","text":""},{"location":"pl/gcp/vm/#dokumentacja-maszyny-wirtualnej","title":"Dokumentacja maszyny wirtualnej","text":""},{"location":"pl/gcp/vm/#przeglad","title":"Przegl\u0105d","text":"<ul> <li>Nazwa maszyny wirtualnej: [Wprowad\u017a nazw\u0119 maszyny wirtualnej]</li> <li>Projekt: [Wprowad\u017a identyfikator projektu GCP]</li> <li>Strefa: [Wprowad\u017a stref\u0119 GCP]</li> <li>Typ instancji: [np. e2-medium]</li> <li>System operacyjny: [np. Debian 11]</li> </ul>"},{"location":"pl/gcp/vm/#konfiguracja-sieci","title":"Konfiguracja sieci","text":"<ul> <li>VPC: [Wprowad\u017a nazw\u0119 VPC]</li> <li>Podsie\u0107: [Wprowad\u017a nazw\u0119 podsieci]</li> <li>Wewn\u0119trzny adres IP: [Wprowad\u017a wewn\u0119trzny adres IP]</li> <li>Zewn\u0119trzny adres IP: [Wprowad\u017a zewn\u0119trzny adres IP lub \"Brak\"]</li> </ul>"},{"location":"pl/gcp/vm/#bezpieczenstwo","title":"Bezpiecze\u0144stwo","text":"<ul> <li>Regu\u0142y zapory sieciowej:</li> <li>[Lista regu\u0142 zapory sieciowej]</li> <li>Konto us\u0142ugi: [Wprowad\u017a nazw\u0119 konta us\u0142ugi]</li> </ul>"},{"location":"pl/gcp/vm/#notatki","title":"Notatki","text":"<p>[Dodaj wszelkie dodatkowe notatki tutaj]</p>"},{"location":"pl/secure-access/gcp-wif/","title":"GCP WIF","text":""},{"location":"pl/secure-access/gcp-wif/#bezpieczny-dostep-do-gcp-z-workload-identity-federation","title":"Bezpieczny dost\u0119p do GCP z Workload Identity Federation","text":"<p>Ta metoda jest zalecana do konfiguracji CI/CD (np. GitHub Actions) i pozwala uzyska\u0107 tymczasowe dane uwierzytelniaj\u0105ce GCP bez konieczno\u015bci przechowywania d\u0142ugotrwa\u0142ych kluczy konta us\u0142ugi.</p>"},{"location":"pl/secure-access/gcp-wif/#jak-to-dziaa","title":"Jak to dzia\u0142a","text":"<ol> <li>GitHub generuje unikalny token OIDC dla ka\u017cdego uruchomienia workflow.</li> <li>GCP IAM ufa GitHub jako dostawcy to\u017csamo\u015bci poprzez Workload Identity Federation.</li> <li>GitHub Action przekazuje sw\u00f3j token OIDC do GCP.</li> <li>GCP STS weryfikuje token i, je\u015bli jest prawid\u0142owy, wydaje tymczasowe dane uwierzytelniaj\u0105ce dla workflow do personifikacji okre\u015blonego konta us\u0142ugi.</li> </ol>"},{"location":"pl/secure-access/gcp-wif/#konfiguracja-krok-po-kroku","title":"Konfiguracja krok po kroku","text":""},{"location":"pl/secure-access/gcp-wif/#krok-1-wacz-wymagane-api","title":"Krok 1: W\u0142\u0105cz wymagane API","text":"<pre><code>gcloud services enable iamcredentials.googleapis.com\ngcloud services enable sts.googleapis.com\n</code></pre>"},{"location":"pl/secure-access/gcp-wif/#krok-2-utworz-pule-workload-identity","title":"Krok 2: Utw\u00f3rz pul\u0119 Workload Identity","text":"<pre><code>gcloud iam workload-identity-pools create \"github-pool\" \\\n  --project=\"YOUR_PROJECT_ID\" \\\n  --location=\"global\" \\\n  --display-name=\"GitHub Actions Pool\"\n</code></pre>"},{"location":"pl/secure-access/gcp-wif/#krok-3-utworz-dostawce-workload-identity","title":"Krok 3: Utw\u00f3rz dostawc\u0119 Workload Identity","text":"<pre><code>gcloud iam workload-identity-pools providers create-oidc \"github-provider\" \\\n  --project=\"YOUR_PROJECT_ID\" \\\n  --location=\"global\" \\\n  --workload-identity-pool=\"github-pool\" \\\n  --display-name=\"GitHub Provider\" \\\n  --attribute-mapping=\"google.subject=assertion.sub,attribute.actor=assertion.actor,attribute.repository=assertion.repository\" \\\n  --issuer-uri=\"https://token.actions.githubusercontent.com\"\n</code></pre>"},{"location":"pl/secure-access/gcp-wif/#krok-4-utworz-konto-usugi","title":"Krok 4: Utw\u00f3rz konto us\u0142ugi","text":"<pre><code>gcloud iam service-accounts create github-actions-sa \\\n  --project=\"YOUR_PROJECT_ID\" \\\n  --display-name=\"GitHub Actions Service Account\"\n</code></pre> <p>Przyznaj niezb\u0119dne uprawnienia kontu us\u0142ugi:</p> <pre><code>gcloud projects add-iam-policy-binding YOUR_PROJECT_ID \\\n  --member=\"serviceAccount:github-actions-sa@YOUR_PROJECT_ID.iam.gserviceaccount.com\" \\\n  --role=\"roles/editor\"\n</code></pre>"},{"location":"pl/secure-access/gcp-wif/#krok-5-zezwol-puli-workload-identity-na-personifikacje-konta-usugi","title":"Krok 5: Zezw\u00f3l puli Workload Identity na personifikacj\u0119 konta us\u0142ugi","text":"<pre><code>gcloud iam service-accounts add-iam-policy-binding \\\n  github-actions-sa@YOUR_PROJECT_ID.iam.gserviceaccount.com \\\n  --project=\"YOUR_PROJECT_ID\" \\\n  --role=\"roles/iam.workloadIdentityUser\" \\\n  --member=\"principalSet://iam.googleapis.com/projects/PROJECT_NUMBER/locations/global/workloadIdentityPools/github-pool/attribute.repository/v-grand/YOUR_REPO\"\n</code></pre> <p>Wa\u017cne: Zamie\u0144 <code>PROJECT_NUMBER</code> na numer projektu GCP (nie ID) i <code>v-grand/YOUR_REPO</code> na swoje repozytorium.</p>"},{"location":"pl/secure-access/gcp-wif/#krok-6-pobierz-nazwe-zasobu-dostawcy-workload-identity","title":"Krok 6: Pobierz nazw\u0119 zasobu dostawcy Workload Identity","text":"<pre><code>gcloud iam workload-identity-pools providers describe \"github-provider\" \\\n  --project=\"YOUR_PROJECT_ID\" \\\n  --location=\"global\" \\\n  --workload-identity-pool=\"github-pool\" \\\n  --format=\"value(name)\"\n</code></pre> <p>Zapisz t\u0119 warto\u015b\u0107 - b\u0119dzie potrzebna w workflow GitHub Actions.</p>"},{"location":"pl/secure-access/gcp-wif/#krok-7-zaktualizuj-workflow-github-actions","title":"Krok 7: Zaktualizuj workflow GitHub Actions","text":"<pre><code>name: Deploy to GCP via WIF\n\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    name: Deploy to GCP\n    runs-on: ubuntu-latest\n    permissions:\n      id-token: write # Wymagane do uzyskania tokenu OIDC\n      contents: read\n\n    steps:\n    - name: Checkout code\n      uses: actions/checkout@v3\n\n    - name: Authenticate to Google Cloud\n      uses: google-github-actions/auth@v1\n      with:\n        workload_identity_provider: 'projects/PROJECT_NUMBER/locations/global/workloadIdentityPools/github-pool/providers/github-provider'\n        service_account: 'github-actions-sa@YOUR_PROJECT_ID.iam.gserviceaccount.com'\n\n    - name: Set up Cloud SDK\n      uses: google-github-actions/setup-gcloud@v1\n\n    - name: Use gcloud CLI\n      run: gcloud info\n</code></pre> <p>Teraz nie potrzebujesz ju\u017c plik\u00f3w kluczy konta us\u0142ugi w swoim repozytorium!</p>"},{"location":"ru/","title":"Home","text":"<ul> <li>English</li> </ul>"},{"location":"ru/#infra-docs","title":"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c \u0432 Infra Docs","text":"<p>\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c \u0432 \u043f\u043e\u043b\u043d\u0443\u044e \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e \u044d\u043a\u043e\u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b v-grand. \u042d\u0442\u043e\u0442 \u043d\u0430\u0431\u043e\u0440 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0435\u0432 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0433\u043e\u0442\u043e\u0432\u043e\u0435 production-\u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u043c\u0443\u043b\u044c\u0442\u0438\u043e\u0431\u043b\u0430\u0447\u043d\u044b\u0445 \u0440\u0430\u0437\u0432\u0451\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0439.</p>"},{"location":"ru/#_1","title":"\ud83d\udcda \u041e\u0431\u0437\u043e\u0440 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b","text":"<p>\u0418\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043d\u0430\u044f \u044d\u043a\u043e\u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u0430 \u043d\u0430 \u043c\u043e\u0434\u0443\u043b\u044c\u043d\u043e\u0439 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0435, \u0433\u0434\u0435 \u043a\u0430\u0436\u0434\u044b\u0439 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439 \u0441\u043b\u0443\u0436\u0438\u0442 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d\u043d\u043e\u0439 \u0446\u0435\u043b\u0438:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    infra-docs       \u2502  \u2190 \u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u0438 \u043f\u0440\u0438\u043c\u0435\u0440\u044b\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n          \u2502\n          \u251c\u2500\u25ba infra-core       (\u041f\u0435\u0440\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u043c\u043e\u0434\u0443\u043b\u0438 Terraform)\n          \u251c\u2500\u25ba infra-template   (\u0428\u0430\u0431\u043b\u043e\u043d \u043f\u0440\u043e\u0435\u043a\u0442\u0430)\n          \u251c\u2500\u25ba infra-ci         (CI/CD Workflows)\n          \u2502\n          \u2514\u2500\u25ba \u041f\u0440\u0438\u043a\u043b\u0430\u0434\u043d\u044b\u0435 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438:\n              \u251c\u2500\u25ba template-platform (\u042d\u0442\u043e\u0442 \u043f\u0440\u043e\u0435\u043a\u0442)\n              \u251c\u2500\u25ba infra-aws        (\u0418\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 AWS)\n              \u251c\u2500\u25ba infra-gcp        (\u0418\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 GCP)\n              \u251c\u2500\u25ba infra-network    (\u0421\u0435\u0442\u0435\u0432\u0430\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f)\n              \u251c\u2500\u25ba infra-monitoring (\u0421\u0442\u0435\u043a \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430)\n              \u251c\u2500\u25ba infra-secrets    (\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u0430\u043c\u0438)\n              \u2514\u2500\u25ba infra-k8s        (\u041a\u043b\u0430\u0441\u0442\u0435\u0440\u044b Kubernetes)\n</code></pre>"},{"location":"ru/#_2","title":"\ud83d\uddc2\ufe0f \u0420\u0443\u043a\u043e\u0432\u043e\u0434\u0441\u0442\u0432\u043e \u043f\u043e \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f\u043c","text":""},{"location":"ru/#_3","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438","text":"\u0420\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439 \u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0421\u0442\u0430\u0442\u0443\u0441 infra-core \u041f\u0435\u0440\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 Terraform \u043c\u043e\u0434\u0443\u043b\u0438 (VM, VPC, DB, K8s, Tailscale) \u2705 \u0410\u043a\u0442\u0438\u0432\u0435\u043d infra-template \u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u0448\u0430\u0431\u043b\u043e\u043d \u0434\u043b\u044f \u043d\u043e\u0432\u044b\u0445 \u043f\u0440\u043e\u0435\u043a\u0442\u043e\u0432 \u2705 \u0410\u043a\u0442\u0438\u0432\u0435\u043d template-platform \u0424\u0443\u043d\u0434\u0430\u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u044b\u0439 \u0431\u044d\u043a\u0435\u043d\u0434-\u0441\u0435\u0440\u0432\u0438\u0441 \u0434\u043b\u044f \u043d\u043e\u0432\u044b\u0445 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439. \u2705 \u0410\u043a\u0442\u0438\u0432\u0435\u043d infra-ci \u041f\u0435\u0440\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 GitHub Actions workflows \u0434\u043b\u044f CI/CD \u2705 \u0410\u043a\u0442\u0438\u0432\u0435\u043d infra-docs \u0421\u0430\u0439\u0442 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438 (\u044d\u0442\u043e\u0442 \u0441\u0430\u0439\u0442) \u2705 \u0410\u043a\u0442\u0438\u0432\u0435\u043d"},{"location":"ru/#_4","title":"\u041e\u0431\u043b\u0430\u0447\u043d\u0430\u044f \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430","text":"\u0420\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439 \u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u041f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u0435 \u043e\u0431\u043b\u0430\u043a\u0430 infra-aws \u0420\u0430\u0437\u0432\u0451\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b AWS AWS infra-gcp \u0420\u0430\u0437\u0432\u0451\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b GCP GCP infra-network VPC, VPN, Tailscale mesh networking AWS, GCP"},{"location":"ru/#_5","title":"\u041f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0435\u043d\u043d\u044b\u0435 \u0441\u0435\u0440\u0432\u0438\u0441\u044b","text":"\u0420\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439 \u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u041a\u043b\u044e\u0447\u0435\u0432\u044b\u0435 \u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0438 infra-monitoring \u0421\u0442\u0435\u043a \u043d\u0430\u0431\u043b\u044e\u0434\u0430\u0435\u043c\u043e\u0441\u0442\u0438 \u0438 \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f Prometheus, Grafana, Loki infra-secrets \u0426\u0435\u043d\u0442\u0440\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u0430\u043c\u0438 Vault, SOPS, GCP Secrets infra-k8s \u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 Kubernetes \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430\u043c\u0438 GKE, EKS, K3s"},{"location":"ru/#_6","title":"\ud83d\ude80 \u0411\u044b\u0441\u0442\u0440\u044b\u0439 \u0441\u0442\u0430\u0440\u0442","text":""},{"location":"ru/#_7","title":"\u0414\u043b\u044f \u043d\u043e\u0432\u044b\u0445 \u043f\u0440\u043e\u0435\u043a\u0442\u043e\u0432","text":"<ol> <li> <p>\u041a\u043b\u043e\u043d\u0438\u0440\u0443\u0439\u0442\u0435 \u0448\u0430\u0431\u043b\u043e\u043d: <code>bash    git clone https://github.com/v-grand/infra-template.git my-new-project    cd my-new-project</code></p> </li> <li> <p>\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0435: <code>bash    cp terraform.tfvars.example terraform.tfvars    # \u041e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 terraform.tfvars \u0441 \u0432\u0430\u0448\u0438\u043c\u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u043c\u0438</code></p> </li> <li> <p>\u0420\u0430\u0437\u0432\u0435\u0440\u043d\u0438\u0442\u0435: <code>bash    terraform init    terraform plan    terraform apply</code></p> </li> </ol>"},{"location":"ru/#_8","title":"\u0414\u043b\u044f \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u043f\u0440\u043e\u0435\u043a\u0442\u043e\u0432","text":"<p>\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439:</p> <ul> <li>\u0420\u0430\u0437\u0432\u0451\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 AWS \u2192 infra-aws</li> <li>\u0420\u0430\u0437\u0432\u0451\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 GCP \u2192 infra-gcp</li> <li>Kubernetes \u2192 infra-k8s</li> <li>\u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u2192 infra-monitoring</li> </ul>"},{"location":"ru/#_9","title":"\ud83d\udcd6 \u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438","text":"<ul> <li>\u041c\u043e\u0434\u0443\u043b\u0438 Infra Core - \u0414\u0435\u0442\u0430\u043b\u044c\u043d\u0430\u044f \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u043c\u043e\u0434\u0443\u043b\u0435\u0439</li> <li>\u041f\u0440\u0438\u043c\u0435\u0440\u044b AWS - \u041f\u0440\u0438\u043c\u0435\u0440\u044b \u0440\u0430\u0437\u0432\u0451\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f AWS</li> <li>\u0420\u0443\u043a\u043e\u0432\u043e\u0434\u0441\u0442\u0432\u0430 GCP - \u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u0434\u043b\u044f GCP</li> <li>\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f Tailscale - \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 mesh \u0441\u0435\u0442\u0438</li> <li>\u041d\u043e\u0443\u0442\u0431\u0443\u043a\u0438 - \u0418\u043d\u0442\u0435\u0440\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u043f\u0440\u0438\u043c\u0435\u0440\u044b \u0438 \u0442\u0443\u0442\u043e\u0440\u0438\u0430\u043b\u044b</li> </ul>"},{"location":"ru/#_10","title":"\ud83d\udd17 \u0412\u043d\u0435\u0448\u043d\u0438\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b","text":"<ul> <li>\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f Terraform</li> <li>\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f GitHub Actions</li> <li>AWS Well-Architected Framework</li> <li>Google Cloud Architecture Center</li> </ul>"},{"location":"ru/#_11","title":"\ud83e\udd1d \u0412\u043a\u043b\u0430\u0434 \u0432 \u043f\u0440\u043e\u0435\u043a\u0442","text":"<p>\u041c\u044b \u043f\u0440\u0438\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u043c \u0432\u043a\u043b\u0430\u0434 \u0432 \u043f\u0440\u043e\u0435\u043a\u0442! \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0441\u043c\u043e\u0442\u0440\u0438\u0442\u0435 \u0440\u0443\u043a\u043e\u0432\u043e\u0434\u0441\u0442\u0432\u0430 \u043f\u043e \u0432\u043a\u043b\u0430\u0434\u0443 \u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0445 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f\u0445.</p>"},{"location":"ru/#_12","title":"\ud83d\udcc4 \u041b\u0438\u0446\u0435\u043d\u0437\u0438\u044f","text":"<p>\u0412\u0441\u0435 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438 \u043b\u0438\u0446\u0435\u043d\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u044b \u043f\u043e\u0434 MIT License, \u0435\u0441\u043b\u0438 \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e \u0438\u043d\u043e\u0435.</p>"},{"location":"ru/#_13","title":"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0430\u044f \u0441\u0445\u0435\u043c\u0430 \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u044b","text":"<pre><code>graph TD\n    subgraph \"\u0420\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0438 CI/CD\"\n        A[\u0420\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a] --&gt; B(Git \u0420\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439)\n        B -- \"Push\" --&gt; C(infra-ci: GitHub Actions)\n    end\n\n    subgraph \"\u0418\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u043a\u0430\u043a \u043a\u043e\u0434 (IaC)\"\n        C -- \"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\" --&gt; D(infra-template: \u0428\u0430\u0431\u043b\u043e\u043d \u043f\u0440\u043e\u0435\u043a\u0442\u0430)\n        D -- \"\u0421\u043e\u0434\u0435\u0440\u0436\u0438\u0442\" --&gt; E(infra-core: \u041c\u043e\u0434\u0443\u043b\u0438 Terraform)\n    end\n\n    subgraph \"\u041e\u0431\u043b\u0430\u0447\u043d\u044b\u0435 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u044b\"\n        E -- \"\u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u0435\u0442 \u0432\" --&gt; F(infra-aws: \u0418\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 AWS)\n        E -- \"\u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u0435\u0442 \u0432\" --&gt; G(infra-gcp: \u0418\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 GCP)\n    end\n\n    subgraph \"\u041f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0435\u043d\u043d\u044b\u0435 \u0441\u0435\u0440\u0432\u0438\u0441\u044b\"\n        F -- \"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\" --&gt; H(infra-network: \u0421\u0435\u0442\u0435\u0432\u0430\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f)\n        G -- \"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\" --&gt; H\n        F -- \"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\" --&gt; I(infra-secrets: \u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u0430\u043c\u0438)\n        G -- \"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\" --&gt; I\n        F -- \"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\" --&gt; J(infra-monitoring: \u0421\u0442\u0435\u043a \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430)\n        G -- \"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\" --&gt; J\n        F -- \"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\" --&gt; K(infra-k8s: \u041a\u043b\u0430\u0441\u0442\u0435\u0440\u044b Kubernetes)\n        G -- \"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\" --&gt; K\n    end\n\n    K -- \"\u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u0435\u0442 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f\" --&gt; L(\u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f)\n    J -- \"\u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u0442\" --&gt; L\n    I -- \"\u041f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u0435\u043a\u0440\u0435\u0442\u044b\" --&gt; L\n</code></pre>"},{"location":"ru/aws/","title":"AWS (English)","text":""},{"location":"ru/aws/#aws","title":"\u0418\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 AWS","text":"<p>infra-aws \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435\u043c \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b AWS \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u043c\u043e\u0434\u0443\u043b\u0435\u0439 Terraform \u0438\u0437 infra-core, \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u044f \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0431\u043b\u0430\u0447\u043d\u044b\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432.</p>"},{"location":"ru/aws/#_1","title":"\ud83c\udfaf \u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435","text":"<p>\u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043e\u0439 AWS:</p> <ul> <li>EC2 Instances - \u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d</li> <li>VPC Configuration - \u0421\u0435\u0442\u0435\u0432\u0430\u044f \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430</li> <li>RDS Databases - \u0423\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c\u044b\u0435 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445</li> <li>EKS Clusters - Kubernetes \u043d\u0430 AWS</li> <li>S3 Storage - \u041e\u0431\u044a\u0435\u043a\u0442\u043d\u043e\u0435 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435</li> <li>IAM Policies - \u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043e\u043c</li> </ul>"},{"location":"ru/aws/#_2","title":"\ud83d\udcc1 \u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f","text":"<pre><code>infra-aws/\n\u251c\u2500\u2500 bootstrap/              # \u041d\u0430\u0447\u0430\u043b\u044c\u043d\u0430\u044f \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 AWS\n\u2502   \u251c\u2500\u2500 iam/               # \u0420\u043e\u043b\u0438 \u0438 \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0438 IAM\n\u2502   \u251c\u2500\u2500 s3/                # S3 \u0431\u0430\u043a\u0435\u0442\u044b \u0434\u043b\u044f \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f Terraform\n\u2502   \u2514\u2500\u2500 dynamodb/          # DynamoDB \u0434\u043b\u044f \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0438 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f\n\u251c\u2500\u2500 infra/                 # \u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430\n\u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u251c\u2500\u2500 variables.tf\n\u2502   \u251c\u2500\u2500 terraform.tfvars.example\n\u2502   \u251c\u2500\u2500 backend.tf\n\u2502   \u2514\u2500\u2500 outputs.tf\n\u251c\u2500\u2500 ops/                   # \u041e\u043f\u0435\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0435 \u0441\u043a\u0440\u0438\u043f\u0442\u044b\n\u2502   \u251c\u2500\u2500 ssh_config.example\n\u2502   \u2514\u2500\u2500 scripts/\n\u251c\u2500\u2500 ide/                   # \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 IDE\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"ru/aws/#_3","title":"\ud83d\ude80 \u0411\u044b\u0441\u0442\u0440\u044b\u0439 \u0441\u0442\u0430\u0440\u0442","text":""},{"location":"ru/aws/#1","title":"1. \u041f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f","text":"<ul> <li>Terraform &gt;= 1.5.0</li> <li>AWS CLI \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d \u0441 \u0443\u0447\u0435\u0442\u043d\u044b\u043c\u0438 \u0434\u0430\u043d\u043d\u044b\u043c\u0438</li> <li>\u0421\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0430\u044f \u043f\u0430\u0440\u0430 \u043a\u043b\u044e\u0447\u0435\u0439 EC2 (\u0438\u043b\u0438 \u0441\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u043d\u043e\u0432\u0443\u044e)</li> </ul> <pre><code># \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u0442\u0435 AWS CLI\naws configure\n\n# \u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\naws sts get-caller-identity\n</code></pre>"},{"location":"ru/aws/#2","title":"2. \u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b","text":"<pre><code># \u041a\u043b\u043e\u043d\u0438\u0440\u0443\u0439\u0442\u0435 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439\ngit clone https://github.com/v-grand/infra-aws.git\ncd infra-aws\n\n# \u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 (\u0442\u043e\u043b\u044c\u043a\u043e \u0432 \u043f\u0435\u0440\u0432\u044b\u0439 \u0440\u0430\u0437)\ncd bootstrap\nterraform init\nterraform apply\n\n# \u042d\u0442\u043e \u0441\u043e\u0437\u0434\u0430\u0435\u0442:\n# - S3 \u0431\u0430\u043a\u0435\u0442 \u0434\u043b\u044f \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f Terraform\n# - \u0422\u0430\u0431\u043b\u0438\u0446\u0443 DynamoDB \u0434\u043b\u044f \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0438 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f\n# - \u0411\u0430\u0437\u043e\u0432\u044b\u0435 \u0440\u043e\u043b\u0438 IAM\n</code></pre>"},{"location":"ru/aws/#3","title":"3. \u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b","text":"<pre><code>cd ../infra\n\n# \u0421\u043a\u043e\u043f\u0438\u0440\u0443\u0439\u0442\u0435 \u043f\u0440\u0438\u043c\u0435\u0440 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438\ncp terraform.tfvars.example terraform.tfvars\n\n# \u041e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e\nnano terraform.tfvars\n</code></pre> <p>\u041f\u0440\u0438\u043c\u0435\u0440 terraform.tfvars:</p> <pre><code># \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f AWS\naws_region = \"us-east-1\"\nkey_name   = \"my-ec2-key\"\n\n# \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0441\u0435\u0442\u0438\nvpc_cidr             = \"10.0.0.0/16\"\navailability_zones   = [\"us-east-1a\", \"us-east-1b\"]\npublic_subnet_cidrs  = [\"10.0.1.0/24\", \"10.0.2.0/24\"]\nprivate_subnet_cidrs = [\"10.0.10.0/24\", \"10.0.11.0/24\"]\n\n# \u0414\u043e\u0441\u0442\u0443\u043f \u043f\u043e SSH\nallowed_ssh_cidr = \"YOUR_IP/32\"  # \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e: curl ifconfig.me\n\n# \u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435\nrepo_url    = \"https://github.com/your-org/your-app.git\"\nrepo_branch = \"main\"\n\n# \u0422\u0435\u0433\u0438\ntags = {\n  Environment = \"dev\"\n  Project     = \"my-app\"\n  ManagedBy   = \"terraform\"\n}\n</code></pre> <pre><code># \u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435\nterraform init\nterraform plan\nterraform apply\n</code></pre>"},{"location":"ru/aws/#_4","title":"\ud83c\udfd7\ufe0f \u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430","text":""},{"location":"ru/aws/#_5","title":"\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u0420\u0435\u0433\u0438\u043e\u043d AWS (us-east-1)         \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502           VPC (10.0.0.0/16)            \u2502 \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502 \u2502\n\u2502  \u2502  \u2502   AZ-1a      \u2502      AZ-1b       \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502              \u2502                  \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  \u041f\u0443\u0431\u043b\u0438\u0447\u043d\u0430\u044f   \u2502    \u041f\u0443\u0431\u043b\u0438\u0447\u043d\u0430\u044f     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  \u043f\u043e\u0434\u0441\u0435\u0442\u044c     \u2502    \u043f\u043e\u0434\u0441\u0435\u0442\u044c       \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  10.0.1/24   \u2502    10.0.2/24     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  \u2502  EC2   \u2502  \u2502   \u2502  EC2   \u2502     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  \u2502  ALB   \u2502  \u2502   \u2502  ALB   \u2502     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502              \u2502                  \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  \u041f\u0440\u0438\u0432\u0430\u0442\u043d\u0430\u044f   \u2502    \u041f\u0440\u0438\u0432\u0430\u0442\u043d\u0430\u044f     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  \u043f\u043e\u0434\u0441\u0435\u0442\u044c     \u2502    \u043f\u043e\u0434\u0441\u0435\u0442\u044c       \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  10.0.10/24  \u2502    10.0.11/24    \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  \u2502  RDS   \u2502  \u2502   \u2502  RDS   \u2502     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  \u2502(Primary)\u2502  \u2502   \u2502(Standby)\u2502    \u2502  \u2502 \u2502\n\u2502  \u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502  \u2502 \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"ru/aws/#_6","title":"\ud83d\udce6 \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043c\u043e\u0434\u0443\u043b\u0435\u0439","text":""},{"location":"ru/aws/#ec2","title":"\u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 EC2","text":"<pre><code>module \"web_server\" {\n  source = \"github.com/v-grand/infra-core//modules/vm\"\n\n  cloud         = \"aws\"\n  instance_name = \"web-server\"\n  instance_type = \"t3.medium\"\n\n  # \u0421\u0435\u0442\u044c\n  subnet_id          = module.vpc.public_subnet_ids[0]\n  security_group_ids = [aws_security_group.web.id]\n\n  # SSH\n  key_name = var.key_name\n\n  # \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0435\n  user_data = templatefile(\"${path.module}/scripts/user-data.sh\", {\n    repo_url = var.repo_url\n  })\n\n  tags = merge(var.tags, {\n    Role = \"web-server\"\n  })\n}\n</code></pre>"},{"location":"ru/aws/#vpc","title":"\u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 VPC","text":"<pre><code>module \"vpc\" {\n  source = \"github.com/v-grand/infra-network//modules/vpc-aws\"\n\n  vpc_cidr           = var.vpc_cidr\n  availability_zones = var.availability_zones\n\n  public_subnet_cidrs  = var.public_subnet_cidrs\n  private_subnet_cidrs = var.private_subnet_cidrs\n\n  enable_nat_gateway   = true\n  enable_dns_hostnames = true\n\n  tags = var.tags\n}\n</code></pre>"},{"location":"ru/aws/#rds","title":"\u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 RDS","text":"<pre><code>module \"database\" {\n  source = \"github.com/v-grand/infra-core//modules/db\"\n\n  cloud = \"aws\"\n\n  # \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430\n  identifier     = \"myapp-db\"\n  engine         = \"postgres\"\n  engine_version = \"15.3\"\n  instance_class = \"db.t3.medium\"\n\n  # \u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435\n  allocated_storage     = 100\n  max_allocated_storage = 500\n  storage_encrypted     = true\n\n  # \u0411\u0430\u0437\u0430 \u0434\u0430\u043d\u043d\u044b\u0445\n  db_name  = \"myapp\"\n  username = \"admin\"\n  password = var.db_password  # \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440 \u0441\u0435\u043a\u0440\u0435\u0442\u043e\u0432\n\n  # \u0421\u0435\u0442\u044c\n  vpc_id     = module.vpc.vpc_id\n  subnet_ids = module.vpc.private_subnet_ids\n\n  # \u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c\n  allowed_cidr_blocks = [var.vpc_cidr]\n\n  # \u0420\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0435 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\n  backup_retention_period = 7\n  backup_window          = \"03:00-04:00\"\n  maintenance_window     = \"mon:04:00-mon:05:00\"\n\n  # \u0412\u044b\u0441\u043e\u043a\u0430\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u044c\n  multi_az               = true\n  deletion_protection    = true\n\n  tags = var.tags\n}\n</code></pre>"},{"location":"ru/aws/#_7","title":"\ud83d\udd12 \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438","text":""},{"location":"ru/aws/#_8","title":"\u0413\u0440\u0443\u043f\u043f\u044b \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438","text":"<pre><code># \u0413\u0440\u0443\u043f\u043f\u0430 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u0432\u0435\u0431-\u0441\u0435\u0440\u0432\u0435\u0440\u0430\nresource \"aws_security_group\" \"web\" {\n  name        = \"web-server-sg\"\n  description = \"Security group for web servers\"\n  vpc_id      = module.vpc.vpc_id\n\n  # HTTP\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  # HTTPS\n  ingress {\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  # SSH (\u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043e)\n  ingress {\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [var.allowed_ssh_cidr]\n  }\n\n  # \u0418\u0441\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0442\u0440\u0430\u0444\u0438\u043a\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = merge(var.tags, {\n    Name = \"web-server-sg\"\n  })\n}\n</code></pre>"},{"location":"ru/aws/#iam","title":"\u0420\u043e\u043b\u0438 IAM","text":"<pre><code># \u0420\u043e\u043b\u044c \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 EC2\nresource \"aws_iam_role\" \"ec2_role\" {\n  name = \"ec2-instance-role\"\n\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\"\n        Effect = \"Allow\"\n        Principal = {\n          Service = \"ec2.amazonaws.com\"\n        }\n      }\n    ]\n  })\n}\n\n# \u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u0438\u0442\u0438\u043a\nresource \"aws_iam_role_policy_attachment\" \"ec2_s3_access\" {\n  role       = aws_iam_role.ec2_role.name\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess\"\n}\n</code></pre>"},{"location":"ru/aws/#_9","title":"\ud83d\udd17 \u041f\u0440\u0438\u043c\u0435\u0440\u044b \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438","text":""},{"location":"ru/aws/#infra-monitoring","title":"\u0421 infra-monitoring","text":"<pre><code># \u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430\nmodule \"monitoring\" {\n  source = \"github.com/v-grand/infra-monitoring//modules/prometheus\"\n\n  # \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f, \u0441\u043f\u0435\u0446\u0438\u0444\u0438\u0447\u043d\u0430\u044f \u0434\u043b\u044f AWS\n  vpc_id    = module.vpc.vpc_id\n  subnet_id = module.vpc.private_subnet_ids[0]\n\n  instance_type = \"t3.medium\"\n\n  # \u0426\u0435\u043b\u0438 \u0441\u0431\u043e\u0440\u0430 \u043c\u0435\u0442\u0440\u0438\u043a\n  scrape_targets = [\n    module.web_server.instance_private_ip\n  ]\n}\n</code></pre>"},{"location":"ru/aws/#infra-secrets","title":"\u0421 infra-secrets","text":"<pre><code># \u0425\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u043e\u0432 \u0432 AWS Secrets Manager\nmodule \"secrets\" {\n  source = \"github.com/v-grand/infra-secrets//modules/aws-secrets\"\n\n  secrets = {\n    db_password = {\n      secret_string           = var.db_password\n      recovery_window_in_days = 30\n    }\n  }\n}\n</code></pre>"},{"location":"ru/aws/#_10","title":"\ud83d\udcda \u041b\u0443\u0447\u0448\u0438\u0435 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0438","text":"<ol> <li>\u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0432 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0437\u043e\u043d\u0430\u0445 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u0438 (Multi-AZ) - \u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0432 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0437\u043e\u043d\u0430\u0445 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u0438</li> <li>\u0428\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 - \u0412\u043a\u043b\u044e\u0447\u0438\u0442\u0435 \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u043b\u044f EBS \u0438 RDS</li> <li>\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0438\u0432\u0438\u043b\u0435\u0433\u0438\u0438 IAM - \u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f</li> <li>\u0416\u0443\u0440\u043d\u0430\u043b\u044b \u043f\u043e\u0442\u043e\u043a\u043e\u0432 VPC (VPC Flow Logs) - \u0412\u043a\u043b\u044e\u0447\u0438\u0442\u0435 \u0434\u043b\u044f \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430 \u0441\u0435\u0442\u0438</li> <li>\u041e\u043f\u043e\u0432\u0435\u0449\u0435\u043d\u0438\u044f CloudWatch - \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u043e\u043f\u043e\u0432\u0435\u0449\u0435\u043d\u0438\u044f \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430</li> <li>\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044f \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0433\u043e \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f - \u0420\u0435\u0433\u0443\u043b\u044f\u0440\u043d\u044b\u0435 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0441\u043d\u0438\u043c\u043a\u0438</li> <li>\u041e\u043f\u0442\u0438\u043c\u0438\u0437\u0430\u0446\u0438\u044f \u0437\u0430\u0442\u0440\u0430\u0442 - \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0437\u0430\u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u044b, \u0442\u043e\u0447\u0435\u0447\u043d\u044b\u0435 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u044b</li> <li>\u0421\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044f \u0442\u0435\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f - \u041f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u0442\u0435\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432</li> </ol>"},{"location":"ru/aws/#_11","title":"\ud83d\udd27 \u041e\u043f\u0435\u0440\u0430\u0446\u0438\u0438","text":""},{"location":"ru/aws/#_12","title":"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0443","text":"<pre><code># \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c IP \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430\nterraform output instance_public_ip\n\n# SSH \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\nssh -i ~/.ssh/your-key.pem ec2-user@INSTANCE_IP\n\n# \u0418\u043b\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e SSH\ncp ops/ssh_config.example ~/.ssh/config\n# \u041e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e \u0441 \u0432\u0430\u0448\u0438\u043c IP\nssh devml\n</code></pre>"},{"location":"ru/aws/#_13","title":"\u0420\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0435 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435","text":"<pre><code># \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u043d\u0438\u043c\u043e\u043a\naws ec2 create-snapshot \\\n  --volume-id vol-xxxxx \\\n  --description \"Manual backup\"\n\n# \u0421\u043e\u0437\u0434\u0430\u0442\u044c AMI\naws ec2 create-image \\\n  --instance-id i-xxxxx \\\n  --name \"web-server-backup-$(date +%Y%m%d)\"\n</code></pre>"},{"location":"ru/aws/#_14","title":"\ud83d\udcd6 \u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f","text":"<ul> <li>AWS Well-Architected</li> <li>Terraform AWS Provider</li> <li>AWS CLI Reference</li> </ul>"},{"location":"ru/aws/#_15","title":"\ud83d\udd17 \u0421\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438","text":"<ul> <li>infra-core - \u041f\u0435\u0440\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u043c\u043e\u0434\u0443\u043b\u0438 Terraform</li> <li>infra-network - \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0441\u0435\u0442\u0438</li> <li>infra-monitoring - \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430</li> <li>infra-secrets - \u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u0430\u043c\u0438</li> </ul>"},{"location":"ru/infra-ci/","title":"Infra CI","text":""},{"location":"ru/infra-ci/#infra-ci-cicd","title":"infra-ci: \u0420\u0430\u0431\u043e\u0447\u0438\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b CI/CD","text":"<p>infra-ci \u2014 \u044d\u0442\u043e \u0446\u0435\u043d\u0442\u0440\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439, \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0449\u0438\u0439 \u043c\u043d\u043e\u0433\u043e\u043a\u0440\u0430\u0442\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0440\u0430\u0431\u043e\u0447\u0438\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b GitHub Actions, \u0448\u0430\u0431\u043b\u043e\u043d\u044b \u043a\u043e\u043d\u0432\u0435\u0439\u0435\u0440\u043e\u0432 \u0438 \u0443\u0442\u0438\u043b\u0438\u0442\u044b \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u0438 \u0434\u043b\u044f \u043f\u0440\u043e\u0435\u043a\u0442\u043e\u0432 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b \u043a\u0430\u043a \u043a\u043e\u0434\u0430.</p>"},{"location":"ru/infra-ci/#_1","title":"\ud83c\udfaf \u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435","text":"<p>\u042d\u0442\u043e\u0442 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b CI/CD, \u043a\u043e\u0442\u043e\u0440\u044b\u0435:</p> <ul> <li>\u0423\u043d\u0438\u0444\u0438\u0446\u0438\u0440\u0443\u044e\u0442 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b CI/CD \u0432\u043e \u0432\u0441\u0435\u0445 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f\u0445 <code>infra-*</code></li> <li>\u0423\u043f\u0440\u043e\u0449\u0430\u044e\u0442 \u043e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u043d\u0438\u0435 \u0437\u0430 \u0441\u0447\u0435\u0442 \u0446\u0435\u043d\u0442\u0440\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043b\u043e\u0433\u0438\u043a\u0438 \u043a\u043e\u043d\u0432\u0435\u0439\u0435\u0440\u0430</li> <li>\u041f\u043e\u0432\u044b\u0448\u0430\u044e\u0442 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u0431\u043b\u0430\u0433\u043e\u0434\u0430\u0440\u044f \u0438\u043d\u0442\u0435\u0433\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u043c\u0443 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044e \u0441\u0435\u043a\u0440\u0435\u0442\u0430\u043c\u0438</li> <li>\u0423\u0441\u043a\u043e\u0440\u044f\u044e\u0442 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0443 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0433\u043e\u0442\u043e\u0432\u044b\u0445 \u0448\u0430\u0431\u043b\u043e\u043d\u043e\u0432</li> </ul>"},{"location":"ru/infra-ci/#_2","title":"\ud83d\udcc1 \u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f","text":"<pre><code>infra-ci/\n\u251c\u2500\u2500 .github/\n\u2502   \u2514\u2500\u2500 workflows/\n\u2502       \u251c\u2500\u2500 validate.yml             # \u0412\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044f Terraform\n\u2502       \u251c\u2500\u2500 deploy.yml               # \u0428\u0430\u0431\u043b\u043e\u043d \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f\n\u2502       \u2514\u2500\u2500 reusable/\n\u2502           \u251c\u2500\u2500 terraform-plan.yml   # \u041f\u0435\u0440\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0439 \u043f\u043b\u0430\u043d Terraform\n\u2502           \u251c\u2500\u2500 terraform-apply.yml  # \u041f\u0435\u0440\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u043e\u0435 \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 Terraform\n\u2502           \u2514\u2500\u2500 sops-decrypt.yml     # \u0420\u0430\u0441\u0448\u0438\u0444\u0440\u043e\u0432\u043a\u0430 \u0441\u0435\u043a\u0440\u0435\u0442\u043e\u0432 SOPS\n\u251c\u2500\u2500 scripts/\n\u2502   \u251c\u2500\u2500 decrypt.sh                   # \u0421\u043a\u0440\u0438\u043f\u0442 \u0440\u0430\u0441\u0448\u0438\u0444\u0440\u043e\u0432\u043a\u0438 SOPS\n\u2502   \u2514\u2500\u2500 lint.sh                      # \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0444\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043a\u043e\u0434\u0430\n\u251c\u2500\u2500 templates/\n\u2502   \u2514\u2500\u2500 README.template.md           # \u0428\u0430\u0431\u043b\u043e\u043d README \u043c\u043e\u0434\u0443\u043b\u044f\n\u251c\u2500\u2500 docs/\n\u2502   \u2514\u2500\u2500 ci-guide.md                  # \u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u043f\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044e\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"ru/infra-ci/#_3","title":"\ud83d\udd27 \u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438","text":""},{"location":"ru/infra-ci/#1","title":"1. \u041f\u0435\u0440\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0440\u0430\u0431\u043e\u0447\u0438\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b","text":""},{"location":"ru/infra-ci/#terraform-plan","title":"\u0420\u0430\u0431\u043e\u0447\u0438\u0439 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 Terraform Plan","text":"<pre><code># .github/workflows/reusable/terraform-plan.yml\nname: Terraform Plan\non:\n  workflow_call:\n    inputs:\n      working-directory:\n        required: true\n        type: string\n      environment:\n        required: true\n        type: string\n</code></pre>"},{"location":"ru/infra-ci/#terraform-apply","title":"\u0420\u0430\u0431\u043e\u0447\u0438\u0439 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 Terraform Apply","text":"<pre><code># .github/workflows/reusable/terraform-apply.yml\nname: Terraform Apply\non:\n  workflow_call:\n    inputs:\n      working-directory:\n        required: true\n        type: string\n</code></pre>"},{"location":"ru/infra-ci/#sops","title":"\u0420\u0430\u0431\u043e\u0447\u0438\u0439 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0440\u0430\u0441\u0448\u0438\u0444\u0440\u043e\u0432\u043a\u0438 SOPS","text":"<p>\u0420\u0430\u0441\u0448\u0438\u0444\u0440\u043e\u0432\u044b\u0432\u0430\u0435\u0442 \u043a\u043e\u043d\u0444\u0438\u0434\u0435\u043d\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e SOPS \u043f\u0435\u0440\u0435\u0434 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435\u043c.</p>"},{"location":"ru/infra-ci/#2","title":"2. \u041a\u043e\u043d\u0432\u0435\u0439\u0435\u0440 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438","text":"<p>\u0412\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438: - \u2705 <code>terraform fmt</code> - \u0424\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u0434\u0430 - \u2705 <code>terraform validate</code> - \u0412\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 - \u2705 <code>tflint</code> - \u041b\u0438\u043d\u0442\u0438\u043d\u0433 (\u043d\u0435\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e)</p>"},{"location":"ru/infra-ci/#3","title":"3. \u0424\u0443\u043d\u043a\u0446\u0438\u0438 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438","text":"<ul> <li>\u0412\u0441\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u044b \u043f\u0435\u0440\u0435\u0434\u0430\u044e\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 GitHub Secrets</li> <li>\u0420\u0430\u0441\u0448\u0438\u0444\u0440\u043e\u0432\u043a\u0430 \u0444\u0430\u0439\u043b\u043e\u0432 SOPS \u0447\u0435\u0440\u0435\u0437 <code>age</code> \u0438\u043b\u0438 KMS</li> <li>\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 Tailscale \u0434\u043b\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u044b\u0445 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0439</li> </ul>"},{"location":"ru/infra-ci/#_4","title":"\ud83d\udcd6 \u041f\u0440\u0438\u043c\u0435\u0440\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f","text":""},{"location":"ru/infra-ci/#_5","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0435\u0440\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0445 \u0440\u0430\u0431\u043e\u0447\u0438\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 \u0432 \u0432\u0430\u0448\u0435\u043c \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438","text":""},{"location":"ru/infra-ci/#infra-awsgithubworkflowsdeployyml","title":"\u041f\u0440\u0438\u043c\u0435\u0440: infra-aws/.github/workflows/deploy.yml","text":"<pre><code>name: Deploy AWS Infrastructure\non:\n  push:\n    branches: [main]\n  pull_request:\n\njobs:\n  plan:\n    uses: v-grand/infra-ci/.github/workflows/reusable/terraform-plan.yml@main\n    with:\n      working-directory: ./infra\n      environment: dev\n    secrets:\n      AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}\n      AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n\n  apply:\n    needs: plan\n    if: github.ref == 'refs/heads/main'\n    uses: v-grand/infra-ci/.github/workflows/reusable/terraform-apply.yml@main\n    with:\n      working-directory: ./infra\n      environment: dev\n    secrets:\n      AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}\n      AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}\n</code></pre>"},{"location":"ru/infra-ci/#sops_1","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u0430\u0441\u0448\u0438\u0444\u0440\u043e\u0432\u043a\u0438 SOPS","text":"<pre><code>name: Deploy with Secrets\non:\n  push:\n    branches: [main]\n\njobs:\n  decrypt-and-deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Decrypt Secrets\n        uses: v-grand/infra-ci/.github/workflows/reusable/sops-decrypt.yml@main\n        with:\n          encrypted-file: secrets.enc.yaml\n          age-key: ${{ secrets.AGE_SECRET_KEY }}\n\n      - name: Deploy Infrastructure\n        run: |\n          terraform init\n          terraform apply -auto-approve\n</code></pre>"},{"location":"ru/infra-ci/#github","title":"\ud83d\udd11 \u0422\u0440\u0435\u0431\u0443\u0435\u043c\u044b\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u044b GitHub","text":"<p>\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u044d\u0442\u0438 \u0441\u0435\u043a\u0440\u0435\u0442\u044b \u0432 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u0445 \u0432\u0430\u0448\u0435\u0433\u043e \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f:</p>"},{"location":"ru/infra-ci/#aws","title":"\u0414\u043b\u044f \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0439 AWS","text":"<ul> <li><code>AWS_ACCESS_KEY_ID</code></li> <li><code>AWS_SECRET_ACCESS_KEY</code></li> <li><code>AWS_REGION</code> (\u043d\u0435\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e)</li> </ul>"},{"location":"ru/infra-ci/#gcp","title":"\u0414\u043b\u044f \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0439 GCP","text":"<ul> <li><code>GCP_CREDENTIALS</code> - JSON \u0443\u0447\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438 \u0441\u043b\u0443\u0436\u0431\u044b</li> <li><code>GCP_PROJECT_ID</code></li> <li><code>GCP_REGION</code></li> </ul>"},{"location":"ru/infra-ci/#sops_2","title":"\u0414\u043b\u044f \u0440\u0430\u0441\u0448\u0438\u0444\u0440\u043e\u0432\u043a\u0438 SOPS","text":"<ul> <li><code>AGE_SECRET_KEY</code> - \u041f\u0440\u0438\u0432\u0430\u0442\u043d\u044b\u0439 \u043a\u043b\u044e\u0447 Age</li> <li><code>SOPS_KMS_ARN</code> - ARN \u043a\u043b\u044e\u0447\u0430 AWS KMS (\u043f\u0440\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0438 AWS KMS)</li> <li><code>SOPS_GCP_KMS</code> - \u041a\u043b\u044e\u0447 GCP KMS (\u043f\u0440\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0438 GCP KMS)</li> </ul>"},{"location":"ru/infra-ci/#tailscale","title":"\u0414\u043b\u044f Tailscale (\u043d\u0435\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e)","text":"<ul> <li><code>TAILSCALE_AUTH_KEY</code> - \u041a\u043b\u044e\u0447 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 Tailscale</li> </ul>"},{"location":"ru/infra-ci/#_6","title":"\ud83d\udee1\ufe0f \u041b\u0443\u0447\u0448\u0438\u0435 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0438 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438","text":"<ol> <li>\u041d\u0438\u043a\u043e\u0433\u0434\u0430 \u043d\u0435 \u043a\u043e\u043c\u043c\u0438\u0442\u044c\u0442\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u044b - \u0412\u0441\u0435\u0433\u0434\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 GitHub Secrets \u0438\u043b\u0438 SOPS</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043f\u0440\u0438\u043d\u0446\u0438\u043f \u043d\u0430\u0438\u043c\u0435\u043d\u044c\u0448\u0438\u0445 \u043f\u0440\u0438\u0432\u0438\u043b\u0435\u0433\u0438\u0439 - \u041f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0439\u0442\u0435 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0435 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f</li> <li>\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u0435 \u0437\u0430\u0449\u0438\u0442\u0443 \u0432\u0435\u0442\u0432\u0435\u0439 - \u0422\u0440\u0435\u0431\u0443\u0439\u0442\u0435 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 PR \u0434\u043b\u044f <code>main</code></li> <li>\u0420\u043e\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u0443\u0447\u0435\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 - \u0420\u0435\u0433\u0443\u043b\u044f\u0440\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0439\u0442\u0435 \u043a\u043b\u044e\u0447\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u0430</li> <li>\u0410\u0443\u0434\u0438\u0442 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0439 - \u041f\u0440\u043e\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u0439\u0442\u0435 \u0436\u0443\u0440\u043d\u0430\u043b\u044b \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0440\u0430\u0431\u043e\u0447\u0438\u0445 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432</li> </ol>"},{"location":"ru/infra-ci/#_7","title":"\ud83d\udcda \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 \u0434\u0440\u0443\u0433\u0438\u043c\u0438 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f\u043c\u0438","text":"\u0420\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439 \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f infra-aws \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0440\u0430\u0431\u043e\u0447\u0438\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b <code>terraform-plan</code> \u0438 <code>terraform-apply</code> infra-gcp \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u043f\u0435\u0440\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0440\u0430\u0431\u043e\u0447\u0438\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0441 \u0443\u0447\u0435\u0442\u043d\u044b\u043c\u0438 \u0434\u0430\u043d\u043d\u044b\u043c\u0438 GCP infra-k8s \u0418\u043d\u0442\u0435\u0433\u0440\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0434\u043b\u044f \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f \u0434\u0438\u0430\u0433\u0440\u0430\u043c\u043c Helm infra-monitoring \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0440\u0430\u0431\u043e\u0447\u0438\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438 infra-secrets \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0440\u0430\u0431\u043e\u0447\u0438\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0440\u0430\u0441\u0448\u0438\u0444\u0440\u043e\u0432\u043a\u0438 SOPS"},{"location":"ru/infra-ci/#_8","title":"\ud83d\ude80 \u041d\u0430\u0447\u0430\u043b\u043e \u0440\u0430\u0431\u043e\u0442\u044b","text":""},{"location":"ru/infra-ci/#1_1","title":"1. \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u0441\u0432\u043e\u0439 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439","text":"<p>\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u044d\u0442\u043e\u0442 \u0440\u0430\u0431\u043e\u0447\u0438\u0439 \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0432 \u0441\u0432\u043e\u0439 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439:</p> <pre><code>mkdir -p .github/workflows\ncat &gt; .github/workflows/deploy.yml &lt;&lt; 'EOF'\nname: Deploy Infrastructure\non:\n  push:\n    branches: [main]\n  pull_request:\n\njobs:\n  terraform:\n    uses: v-grand/infra-ci/.github/workflows/reusable/terraform-plan.yml@main\n    with:\n      working-directory: ./\n      environment: dev\nEOF\n</code></pre>"},{"location":"ru/infra-ci/#2_1","title":"2. \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u044b","text":"<p>\u041f\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0439 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439 \u2192 Settings \u2192 Secrets \u0438 \u0434\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u044b.</p>"},{"location":"ru/infra-ci/#3_1","title":"3. \u041e\u0442\u043f\u0440\u0430\u0432\u044c\u0442\u0435 \u0438 \u0440\u0430\u0437\u0432\u0435\u0440\u043d\u0438\u0442\u0435","text":"<pre><code>git add .github/workflows/deploy.yml\ngit commit -m \"Add CI/CD pipeline\"\ngit push\n</code></pre>"},{"location":"ru/infra-ci/#_9","title":"\ud83d\udcca \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442","text":"<p>\u041f\u043e\u0441\u043b\u0435 \u0432\u043d\u0435\u0434\u0440\u0435\u043d\u0438\u044f: - \u2705 \u0423\u043d\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u043a\u043e\u043d\u0432\u0435\u0439\u0435\u0440\u044b CI/CD \u0432\u043e \u0432\u0441\u0435\u0445 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f\u0445 - \u2705 \u0423\u043f\u0440\u043e\u0449\u0435\u043d\u043d\u043e\u0435 \u043e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u043d\u0438\u0435 \u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f - \u2705 \u041f\u043e\u0432\u044b\u0448\u0435\u043d\u043d\u0430\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u0431\u043b\u0430\u0433\u043e\u0434\u0430\u0440\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044e \u0441\u0435\u043a\u0440\u0435\u0442\u0430\u043c\u0438 - \u2705 \u0423\u0441\u043a\u043e\u0440\u0435\u043d\u043d\u043e\u0435 \u043d\u0430\u0447\u0430\u043b\u043e \u043f\u0440\u043e\u0435\u043a\u0442\u0430</p>"},{"location":"ru/infra-ci/#_10","title":"\ud83d\udd17 \u0421\u0432\u044f\u0437\u0430\u043d\u043d\u0430\u044f \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f","text":"<ul> <li>\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f Terraform</li> <li>GitHub Actions</li> <li>SOPS</li> <li>Tailscale</li> </ul>"},{"location":"ru/infra-ci/#_11","title":"\ud83d\udcdd \u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b","text":"<ul> <li>\u0420\u0443\u043a\u043e\u0432\u043e\u0434\u0441\u0442\u0432\u043e \u043f\u043e CI</li> <li>\u0428\u0430\u0431\u043b\u043e\u043d \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f</li> </ul>"},{"location":"ru/infra-core/","title":"Infra Core","text":""},{"location":"ru/infra-core/#infra-core","title":"infra-core","text":"<p>\u041a\u043e\u043c\u043f\u043b\u0435\u043a\u0441\u043d\u0430\u044f \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0430 \u043c\u043d\u043e\u0433\u043e\u043a\u0440\u0430\u0442\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0445 \u043c\u043e\u0434\u0443\u043b\u0435\u0439 Terraform, \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u043d\u0430\u044f \u0434\u043b\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043c\u0443\u043b\u044c\u0442\u0438\u043e\u0431\u043b\u0430\u0447\u043d\u043e\u0439 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043e\u0439. \u042d\u0442\u0430 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0430 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 AWS, GCP, Hetzner \u0438 Contabo, \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u044f \u0433\u0438\u0431\u043a\u043e\u0435 \u0438 \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0435 \u043e\u0442 \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u044b \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b.</p>"},{"location":"ru/infra-core/#_1","title":"\ud83d\ude80 \u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438","text":"<ul> <li>\u041c\u0443\u043b\u044c\u0442\u0438\u043e\u0431\u043b\u0430\u0447\u043d\u0430\u044f \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430: \u0411\u0435\u0441\u043f\u0440\u0435\u043f\u044f\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u0435 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u0443 \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0445 \u043e\u0431\u043b\u0430\u0447\u043d\u044b\u0445 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u043e\u0432.</li> <li>\u041c\u043e\u0434\u0443\u043b\u044c\u043d\u044b\u0439 \u0434\u0438\u0437\u0430\u0439\u043d: \u041c\u043d\u043e\u0433\u043e\u043a\u0440\u0430\u0442\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b \u0434\u043b\u044f \u0412\u041c, VPC, \u0431\u0430\u0437 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 \u043c\u043d\u043e\u0433\u043e\u0433\u043e \u0434\u0440\u0443\u0433\u043e\u0433\u043e.</li> <li>\u041b\u0443\u0447\u0448\u0438\u0435 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0438: \u0420\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043e \u0441 \u0443\u0447\u0435\u0442\u043e\u043c \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u0439 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u0438 \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u0443\u0435\u043c\u043e\u0441\u0442\u0438.</li> <li>\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 Tailscale: \u041f\u0440\u043e\u0441\u0442\u0430\u044f \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0434\u043b\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0439 \u044f\u0447\u0435\u0438\u0441\u0442\u043e\u0439 \u0441\u0435\u0442\u0438.</li> </ul>"},{"location":"ru/infra-core/#_2","title":"\ud83d\udce6 \u041c\u043e\u0434\u0443\u043b\u0438","text":"\u041c\u043e\u0434\u0443\u043b\u044c \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u041f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u0435 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u044b <code>vm</code> \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d (EC2, GCE) AWS, GCP <code>vpc</code> \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0441\u0435\u0442\u0438 (VPC, \u043f\u043e\u0434\u0441\u0435\u0442\u0438) AWS, GCP <code>db</code> \u0423\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c\u044b\u0435 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 (RDS, Cloud SQL) AWS, GCP <code>tailscale</code> \u042f\u0447\u0435\u0438\u0441\u0442\u0430\u044f \u0441\u0435\u0442\u044c Tailscale \u0412\u0441\u0435 <code>k8s</code> \u041a\u043b\u0430\u0441\u0442\u0435\u0440\u044b Kubernetes (EKS, GKE) AWS, GCP"},{"location":"ru/infra-core/#_3","title":"\ud83d\udee0\ufe0f \u041f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f","text":"<ul> <li>Terraform &gt;= 1.0</li> <li>\u0423\u0447\u0435\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e\u0431\u043b\u0430\u0447\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430 (\u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0435 \u0447\u0435\u0440\u0435\u0437 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f \u0438\u043b\u0438 CLI)</li> </ul>"},{"location":"ru/infra-core/#_4","title":"\ud83d\udcd6 \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435","text":"<p>\u0412\u043e\u0442 \u0431\u0430\u0437\u043e\u0432\u044b\u0439 \u043f\u0440\u0438\u043c\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u043c\u043e\u0434\u0443\u043b\u044f <code>vm</code> \u0432 \u0432\u0430\u0448\u0435\u0439 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 Terraform:</p> <pre><code>module \"my_web_server\" {\n  source        = \"./modules/vm\" # \u0418\u043b\u0438 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a \u0438\u0437 git\n  provider      = \"aws\"\n  instance_type = \"t3.micro\"\n  ami           = \"ami-0c55b159cbfafe1f0\"\n  tags = {\n    Environment = \"dev\"\n  }\n}\n</code></pre>"},{"location":"ru/infra-k8s/","title":"Kubernetes","text":""},{"location":"ru/infra-k8s/#infra-k8s-kubernetes","title":"infra-k8s: \u0418\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 Kubernetes","text":"<p>infra-k8s \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u043f\u043e\u043b\u043d\u043e\u0435 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430\u043c\u0438 Kubernetes \u0432 GKE, EKS \u0438 K3s \u0441 \u0438\u043d\u0442\u0435\u0433\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u043c\u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u043c\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438 \u0438 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u043e\u043c.</p>"},{"location":"ru/infra-k8s/#_1","title":"\ud83c\udfaf \u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435","text":"<p>\u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430\u043c\u0438 Kubernetes:</p> <ul> <li>GKE - \u041a\u043b\u0430\u0441\u0442\u0435\u0440\u044b Google Kubernetes Engine</li> <li>EKS - Amazon Elastic Kubernetes Service</li> <li>K3s - \u041b\u0435\u0433\u043a\u043e\u0432\u0435\u0441\u043d\u044b\u0439 Kubernetes \u0434\u043b\u044f \u043f\u0435\u0440\u0438\u0444\u0435\u0440\u0438\u0439\u043d\u044b\u0445/\u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u0441\u0440\u0435\u0434</li> <li>Helm Charts - \u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432</li> <li>GitOps - \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u043d\u0435\u043f\u0440\u0435\u0440\u044b\u0432\u043d\u043e\u0433\u043e \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f</li> </ul>"},{"location":"ru/infra-k8s/#_2","title":"\ud83d\udcc1 \u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f","text":"<pre><code>infra-k8s/\n\u251c\u2500\u2500 modules/\n\u2502   \u251c\u2500\u2500 gke/                  # Google Kubernetes Engine\n\u2502   \u251c\u2500\u2500 eks/                  # AWS EKS\n\u2502   \u251c\u2500\u2500 k3s/                  # \u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 K3s\n\u2502   \u2514\u2500\u2500 addons/               # Helm-\u0447\u0430\u0440\u0442\u044b \u0438 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0435 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b\n\u2502       \u251c\u2500\u2500 ingress/          # \u0412\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0442\u0440\u0430\u0444\u0438\u043a NGINX/Traefik\n\u2502       \u251c\u2500\u2500 cert-manager/     # \u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430\u043c\u0438\n\u2502       \u251c\u2500\u2500 external-dns/     # \u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u044f DNS\n\u2502       \u2514\u2500\u2500 prometheus-stack/ # \u0421\u0442\u0435\u043a \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430\n\u251c\u2500\u2500 environments/\n\u2502   \u251c\u2500\u2500 dev/\n\u2502   \u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u2502   \u251c\u2500\u2500 variables.tf\n\u2502   \u2502   \u251c\u2500\u2500 terraform.tfvars.example\n\u2502   \u2502   \u2514\u2500\u2500 backend.tf\n\u2502   \u251c\u2500\u2500 prod/\n\u2502   \u2502   \u2514\u2500\u2500 ...\n\u2502   \u2514\u2500\u2500 k3s-example/          # \u041f\u0440\u0438\u043c\u0435\u0440 K3s \u043d\u0430 VM GCP\n\u251c\u2500\u2500 manifests/                # \u041c\u0430\u043d\u0438\u0444\u0435\u0441\u0442\u044b Kubernetes\n\u251c\u2500\u2500 helm-values/              # \u0417\u043d\u0430\u0447\u0435\u043d\u0438\u044f Helm-\u0447\u0430\u0440\u0442\u043e\u0432\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"ru/infra-k8s/#_3","title":"\u2638\ufe0f \u041c\u043e\u0434\u0443\u043b\u0438 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430","text":""},{"location":"ru/infra-k8s/#1-gke-google-kubernetes-engine","title":"1. GKE (Google Kubernetes Engine)","text":"<p>\u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c\u043e\u0433\u043e Kubernetes \u0432 Google Cloud.</p> <p>\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438: - \u0410\u0432\u0442\u043e\u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u0443\u0435\u043c\u044b\u0435 \u043f\u0443\u043b\u044b \u0443\u0437\u043b\u043e\u0432 - \u0420\u0435\u0433\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435/\u0437\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u044b - \u0418\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u0440\u0430\u0431\u043e\u0447\u0435\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 - \u0411\u0438\u043d\u0430\u0440\u043d\u0430\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f - \u0421\u0435\u0442\u0435\u0432\u044b\u0435 \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0438 - \u041f\u0440\u0438\u0432\u0430\u0442\u043d\u044b\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u044b</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440:</p> <pre><code>module \"gke_cluster\" {\n  source = \"github.com/v-grand/infra-k8s//modules/gke\"\n\n  project_id = var.gcp_project_id\n  region     = \"us-central1\"\n\n  cluster_name    = \"production-gke\"\n  kubernetes_version = \"1.28\"\n\n  # \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0441\u0435\u0442\u0438\n  network    = module.vpc.network_name\n  subnetwork = module.vpc.subnet_names[0]\n\n  # \u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043f\u0440\u0438\u0432\u0430\u0442\u043d\u044b\u0439 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\n  enable_private_nodes    = true\n  enable_private_endpoint = false\n  master_ipv4_cidr_block  = \"172.16.0.0/28\"\n\n  # \u041f\u0443\u043b\u044b \u0443\u0437\u043b\u043e\u0432\n  node_pools = [\n    {\n      name         = \"general-pool\"\n      machine_type = \"n2-standard-4\"\n      min_count    = 1\n      max_count    = 10\n      disk_size_gb = 100\n      disk_type    = \"pd-standard\"\n\n      auto_repair  = true\n      auto_upgrade = true\n\n      preemptible = false\n    },\n    {\n      name         = \"spot-pool\"\n      machine_type = \"n2-standard-4\"\n      min_count    = 0\n      max_count    = 20\n\n      preemptible = true  # \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0441\u043f\u043e\u0442\u043e\u0432\u044b\u0435 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u044b\n    }\n  ]\n\n  # \u0418\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u0440\u0430\u0431\u043e\u0447\u0435\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438\n  enable_workload_identity = true\n\n  # \u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c\n  enable_network_policy = true\n  enable_pod_security_policy = true\n\n  # \u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\n  enable_cloud_logging    = true\n  enable_cloud_monitoring = true\n\n  tags = {\n    Environment = \"production\"\n    ManagedBy   = \"terraform\"\n  }\n}\n</code></pre>"},{"location":"ru/infra-k8s/#2-eks-amazon-elastic-kubernetes-service","title":"2. EKS (Amazon Elastic Kubernetes Service)","text":"<p>\u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c\u043e\u0433\u043e Kubernetes \u0432 AWS.</p> <p>\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438: - \u0423\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c\u0430\u044f \u043f\u043b\u043e\u0441\u043a\u043e\u0441\u0442\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f - \u041d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0433\u0440\u0443\u043f\u043f \u0443\u0437\u043b\u043e\u0432 (\u043f\u043e \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044e + \u0441\u043f\u043e\u0442\u043e\u0432\u044b\u0435) - \u041f\u043e\u043b\u0438\u0442\u0438\u043a\u0438 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 \u043f\u043e\u0434\u043e\u0432 - IRSA (\u0440\u043e\u043b\u0438 IAM \u0434\u043b\u044f \u0443\u0447\u0435\u0442\u043d\u044b\u0445 \u0437\u0430\u043f\u0438\u0441\u0435\u0439 \u0441\u043b\u0443\u0436\u0431) - \u0421\u0435\u0442\u044c VPC CNI - \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f EBS/EFS</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440:</p> <pre><code>module \"eks_cluster\" {\n  source = \"github.com/v-grand/infra-k8s//modules/eks\"\n\n  cluster_name    = \"production-eks\"\n  cluster_version = \"1.28\"\n\n  # \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0441\u0435\u0442\u0438\n  vpc_id     = module.vpc.vpc_id\n  subnet_ids = module.vpc.private_subnet_ids\n\n  # \u041f\u043b\u043e\u0441\u043a\u043e\u0441\u0442\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f\n  cluster_endpoint_private_access = true\n  cluster_endpoint_public_access  = true\n\n  # \u0413\u0440\u0443\u043f\u043f\u044b \u0443\u0437\u043b\u043e\u0432\n  node_groups = {\n    general = {\n      desired_capacity = 3\n      max_capacity     = 10\n      min_capacity     = 1\n\n      instance_types = [\"t3.large\"]\n      capacity_type  = \"ON_DEMAND\"\n\n      disk_size = 100\n\n      labels = {\n        role = \"general\"\n      }\n\n      tags = {\n        Environment = \"production\"\n      }\n    }\n\n    spot = {\n      desired_capacity = 2\n      max_capacity     = 20\n      min_capacity     = 0\n\n      instance_types = [\"t3.large\", \"t3a.large\"]\n      capacity_type  = \"SPOT\"\n\n      labels = {\n        role = \"spot\"\n      }\n    }\n  }\n\n  # \u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c IRSA\n  enable_irsa = true\n\n  # \u0414\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430\n  cluster_addons = {\n    coredns = {\n      most_recent = true\n    }\n    kube-proxy = {\n      most_recent = true\n    }\n    vpc-cni = {\n      most_recent = true\n    }\n  }\n\n  tags = {\n    Environment = \"production\"\n    ManagedBy   = \"terraform\"\n  }\n}\n</code></pre>"},{"location":"ru/infra-k8s/#3-k3s-kubernetes","title":"3. K3s (\u041b\u0435\u0433\u043a\u043e\u0432\u0435\u0441\u043d\u044b\u0439 Kubernetes)","text":"<p>\u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 K3s \u0434\u043b\u044f \u043f\u0435\u0440\u0438\u0444\u0435\u0440\u0438\u0439\u043d\u044b\u0445 \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432, IoT \u0438\u043b\u0438 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438.</p> <p>\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438: - \u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u0442\u0440\u0435\u0431\u043b\u0435\u043d\u0438\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 - \u041e\u0434\u0438\u043d \u0431\u0438\u043d\u0430\u0440\u043d\u044b\u0439 \u0444\u0430\u0439\u043b - \u0412\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u0430\u044f SQLite \u0438\u043b\u0438 \u0432\u043d\u0435\u0448\u043d\u044f\u044f \u0411\u0414 - \u0412\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 \u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u0449\u0438\u043a \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 (Klipper) - \u0412\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0439 \u0432\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u0442\u0440\u0430\u0444\u0438\u043a Traefik</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440:</p> <pre><code>module \"k3s_cluster\" {\n  source = \"github.com/v-grand/infra-k8s//modules/k3s\"\n\n  # \u0423\u0437\u043b\u044b \u0441\u0435\u0440\u0432\u0435\u0440\u0430\n  server_count = 3\n  server_instance_type = \"e2-medium\"\n\n  # \u0423\u0437\u043b\u044b \u0430\u0433\u0435\u043d\u0442\u0430\n  agent_count = 5\n  agent_instance_type = \"e2-standard-2\"\n\n  # \u0421\u0435\u0442\u044c\n  vpc_id     = module.vpc.vpc_id\n  subnet_ids = module.vpc.private_subnet_ids\n\n  # \u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435\n  datastore_endpoint = \"postgres://user:pass@postgres.example.com:5432/k3s\"\n\n  # \u041e\u043f\u0446\u0438\u0438\n  disable_components = [\"traefik\"]  # \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c NGINX \u0432\u043c\u0435\u0441\u0442\u043e\n\n  # TLS SANs\n  tls_san = [\n    \"k3s.example.com\",\n    \"10.0.0.100\"\n  ]\n\n  tags = {\n    Environment = \"edge\"\n    ManagedBy   = \"terraform\"\n  }\n}\n</code></pre>"},{"location":"ru/infra-k8s/#_4","title":"\ud83d\udd27 \u0421\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0435 \u0434\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f","text":""},{"location":"ru/infra-k8s/#1","title":"1. \u041a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440 \u0432\u0445\u043e\u0434\u044f\u0449\u0435\u0433\u043e \u0442\u0440\u0430\u0444\u0438\u043a\u0430","text":""},{"location":"ru/infra-k8s/#nginx-ingress","title":"NGINX Ingress","text":"<pre><code>module \"nginx_ingress\" {\n  source = \"github.com/v-grand/infra-k8s//modules/addons/ingress\"\n\n  ingress_type = \"nginx\"\n  namespace    = \"ingress-nginx\"\n\n  # \u0417\u043d\u0430\u0447\u0435\u043d\u0438\u044f Helm\n  values = {\n    controller = {\n      replicaCount = 3\n\n      service = {\n        type = \"LoadBalancer\"\n        annotations = {\n          \"service.beta.kubernetes.io/aws-load-balancer-type\" = \"nlb\"\n        }\n      }\n\n      resources = {\n        requests = {\n          cpu    = \"100m\"\n          memory = \"128Mi\"\n        }\n        limits = {\n          cpu    = \"200m\"\n          memory = \"256Mi\"\n        }\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"ru/infra-k8s/#traefik-ingress","title":"Traefik Ingress","text":"<pre><code>module \"traefik_ingress\" {\n  source = \"github.com/v-grand/infra-k8s//modules/addons/ingress\"\n\n  ingress_type = \"traefik\"\n  namespace    = \"traefik\"\n\n  values = {\n    deployment = {\n      replicas = 3\n    }\n\n    service = {\n      type = \"LoadBalancer\"\n    }\n\n    providers = {\n      kubernetesCRD = {\n        enabled = true\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"ru/infra-k8s/#2-cert-manager","title":"2. Cert-Manager","text":"<p>\u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 TLS-\u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430\u043c\u0438.</p> <pre><code>module \"cert_manager\" {\n  source = \"github.com/v-grand/infra-k8s//modules/addons/cert-manager\"\n\n  namespace = \"cert-manager\"\n\n  # \u042d\u043c\u0438\u0442\u0435\u043d\u0442\u044b Let's Encrypt\n  letsencrypt_email = \"admin@example.com\"\n\n  # \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0440\u043e\u043c\u0435\u0436\u0443\u0442\u043e\u0447\u043d\u044b\u0435 \u0438 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0435 \u044d\u043c\u0438\u0442\u0435\u043d\u0442\u044b\n  create_cluster_issuers = true\n\n  values = {\n    installCRDs = true\n\n    resources = {\n      requests = {\n        cpu    = \"10m\"\n        memory = \"32Mi\"\n      }\n    }\n  }\n}\n</code></pre> <p>\u041f\u0440\u0438\u043c\u0435\u0440 ClusterIssuer:</p> <pre><code>apiVersion: cert-manager.io/v1\nkind: ClusterIssuer\nmetadata:\n  name: letsencrypt-prod\nspec:\n  acme:\n    server: https://acme-v02.api.letsencrypt.org/directory\n    email: admin@example.com\n    privateKeySecretRef:\n      name: letsencrypt-prod\n    solvers:\n    - http01:\n        ingress:\n          class: nginx\n</code></pre>"},{"location":"ru/infra-k8s/#3-external-dns","title":"3. External-DNS","text":"<p>\u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u043f\u0438\u0441\u044f\u043c\u0438 DNS.</p> <pre><code>module \"external_dns\" {\n  source = \"github.com/v-grand/infra-k8s//modules/addons/external-dns\"\n\n  namespace = \"external-dns\"\n\n  # \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430\n  provider = \"google\"  # \u0438\u043b\u0438 \"aws\", \"cloudflare\"\n\n  # Google Cloud DNS\n  google_project = var.gcp_project_id\n\n  # \u0424\u0438\u043b\u044c\u0442\u0440\u044b \u0434\u043e\u043c\u0435\u043d\u043e\u0432\n  domain_filters = [\"example.com\", \"*.example.com\"]\n\n  # \u041f\u043e\u043b\u0438\u0442\u0438\u043a\u0430\n  policy = \"sync\"  # \u0438\u043b\u0438 \"upsert-only\"\n\n  values = {\n    resources = {\n      requests = {\n        cpu    = \"10m\"\n        memory = \"32Mi\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"ru/infra-k8s/#4-kube-prometheus-stack","title":"4. Kube Prometheus Stack","text":"<p>\u041a\u043e\u043c\u043f\u043b\u0435\u043a\u0441\u043d\u043e\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430.</p> <pre><code>module \"prometheus_stack\" {\n  source = \"github.com/v-grand/infra-k8s//modules/addons/prometheus-stack\"\n\n  namespace = \"monitoring\"\n\n  # Prometheus\n  prometheus = {\n    retention = \"30d\"\n    storage_size = \"50Gi\"\n    storage_class = \"standard\"\n\n    resources = {\n      requests = {\n        cpu    = \"500m\"\n        memory = \"2Gi\"\n      }\n      limits = {\n        cpu    = \"1000m\"\n        memory = \"4Gi\"\n      }\n    }\n  }\n\n  # Grafana\n  grafana = {\n    enabled = true\n    admin_password = var.grafana_admin_password\n\n    ingress = {\n      enabled = true\n      host    = \"grafana.example.com\"\n      tls     = true\n    }\n  }\n\n  # AlertManager\n  alertmanager = {\n    enabled = true\n\n    config = {\n      receivers = [\n        {\n          name = \"slack\"\n          slack_configs = [\n            {\n              api_url = var.slack_webhook_url\n              channel = \"#alerts\"\n            }\n          ]\n        }\n      ]\n    }\n  }\n}\n</code></pre>"},{"location":"ru/infra-k8s/#_5","title":"\ud83d\ude80 \u0411\u044b\u0441\u0442\u0440\u044b\u0439 \u0441\u0442\u0430\u0440\u0442","text":""},{"location":"ru/infra-k8s/#gke","title":"\u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 GKE","text":"<pre><code># \u041a\u043b\u043e\u043d\u0438\u0440\u0443\u0439\u0442\u0435 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439\ngit clone https://github.com/v-grand/infra-k8s.git\ncd infra-k8s/environments/prod\n\n# \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u0442\u0435\ncp terraform.tfvars.example terraform.tfvars\n# \u041e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 terraform.tfvars\n\n# \u0420\u0430\u0437\u0432\u0435\u0440\u043d\u0438\u0442\u0435\nterraform init\nterraform apply\n\n# \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u0435 kubeconfig\ngcloud container clusters get-credentials production-gke \\\n  --region=us-central1 \\\n  --project=my-project\n</code></pre>"},{"location":"ru/infra-k8s/#eks","title":"\u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 EKS","text":"<pre><code>cd infra-k8s/environments/prod\n\n# \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u0442\u0435\ncp terraform.tfvars.example terraform.tfvars\n# \u041e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 terraform.tfvars\n\n# \u0420\u0430\u0437\u0432\u0435\u0440\u043d\u0438\u0442\u0435\nterraform init\nterraform apply\n\n# \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u0435 kubeconfig\naws eks update-kubeconfig \\\n  --name production-eks \\\n  --region us-east-1\n</code></pre>"},{"location":"ru/infra-k8s/#_6","title":"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0445 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u043e\u0432","text":"<pre><code># \u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 NGINX Ingress\nkubectl apply -f manifests/nginx-ingress.yaml\n\n# \u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 Cert-Manager\nkubectl apply -f manifests/cert-manager.yaml\n\n# \u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 External-DNS\nkubectl apply -f manifests/external-dns.yaml\n\n# \u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 Prometheus Stack\nhelm install kube-prometheus-stack prometheus-community/kube-prometheus-stack \\\n  -f helm-values/prometheus-stack.yaml \\\n  -n monitoring --create-namespace\n</code></pre>"},{"location":"ru/infra-k8s/#_7","title":"\ud83d\udcda \u041b\u0443\u0447\u0448\u0438\u0435 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0438","text":"<ol> <li>\u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 - \u0412\u0441\u0435\u0433\u0434\u0430 \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0439\u0442\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b/\u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432</li> <li>\u0411\u044e\u0434\u0436\u0435\u0442\u044b \u043f\u0440\u0435\u0440\u044b\u0432\u0430\u043d\u0438\u0439 \u043f\u043e\u0434\u043e\u0432 - \u041e\u0431\u0435\u0441\u043f\u0435\u0447\u044c\u0442\u0435 \u0432\u044b\u0441\u043e\u043a\u0443\u044e \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u044c</li> <li>\u0421\u0435\u0442\u0435\u0432\u044b\u0435 \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0438 - \u0412\u043d\u0435\u0434\u0440\u0438\u0442\u0435 \u0441\u0435\u0442\u0435\u0432\u044b\u0435 \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0438 \u0441 \u043d\u0443\u043b\u0435\u0432\u044b\u043c \u0434\u043e\u0432\u0435\u0440\u0438\u0435\u043c</li> <li>RBAC - \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0434\u043e\u0441\u0442\u0443\u043f \u0441 \u043d\u0430\u0438\u043c\u0435\u043d\u044c\u0448\u0438\u043c\u0438 \u043f\u0440\u0438\u0432\u0438\u043b\u0435\u0433\u0438\u044f\u043c\u0438</li> <li>\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c \u043e\u0431\u0440\u0430\u0437\u043e\u0432 - \u0421\u043a\u0430\u043d\u0438\u0440\u0443\u0439\u0442\u0435 \u043e\u0431\u0440\u0430\u0437\u044b, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u043b\u0435\u0440\u044b \u0434\u043e\u043f\u0443\u0441\u043a\u0430</li> <li>\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u0430\u043c\u0438 - \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0432\u043d\u0435\u0448\u043d\u0438\u0435 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u044b \u0441\u0435\u043a\u0440\u0435\u0442\u043e\u0432</li> <li>\u0420\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0435 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 - \u0420\u0435\u0433\u0443\u043b\u044f\u0440\u043d\u044b\u0435 \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u044b\u0435 \u043a\u043e\u043f\u0438\u0438 etcd/\u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430</li> <li>Multi-AZ - \u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0432 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0437\u043e\u043d\u0430\u0445 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u0438</li> </ol>"},{"location":"ru/infra-k8s/#_8","title":"\ud83d\udd17 \u041f\u0440\u0438\u043c\u0435\u0440\u044b \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438","text":""},{"location":"ru/infra-k8s/#infra-monitoring","title":"\u0421 infra-monitoring","text":"<pre><code># \u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430 \u0432 K8s\nmodule \"monitoring\" {\n  source = \"github.com/v-grand/infra-monitoring//modules/prometheus\"\n\n  deploy_to_k8s = true\n  k8s_namespace = \"monitoring\"\n\n  # \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u0438\u0435 \u0441\u043b\u0443\u0436\u0431 K8s\n  prometheus_config = templatefile(\"prometheus-k8s.yaml\", {\n    cluster_name = module.gke_cluster.cluster_name\n  })\n}\n</code></pre>"},{"location":"ru/infra-k8s/#infra-secrets","title":"\u0421 infra-secrets","text":"<pre><code># \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f Vault \u0441 K8s\nmodule \"vault_k8s\" {\n  source = \"github.com/v-grand/infra-secrets//modules/vault-k8s\"\n\n  vault_address = \"https://vault.example.com\"\n\n  # \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0431\u044d\u043a\u044d\u043d\u0434 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 Kubernetes\n  k8s_host = module.gke_cluster.endpoint\n  k8s_ca_cert = module.gke_cluster.ca_certificate\n}\n</code></pre>"},{"location":"ru/infra-k8s/#_9","title":"\ud83d\udcd6 \u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f","text":"<ul> <li>\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f Kubernetes</li> <li>\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f GKE</li> <li>\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f EKS</li> <li>\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f K3s</li> </ul>"},{"location":"ru/infra-k8s/#_10","title":"\ud83d\udd17 \u0421\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438","text":"<ul> <li>infra-core - \u041c\u043e\u0434\u0443\u043b\u0438 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b</li> <li>infra-network - \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0441\u0435\u0442\u0438</li> <li>infra-monitoring - \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430</li> <li>infra-secrets - \u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u0430\u043c\u0438</li> </ul>"},{"location":"ru/infra-monitoring/","title":"Monitoring","text":""},{"location":"ru/infra-monitoring/#infra-monitoring","title":"infra-monitoring: \u0421\u0442\u0435\u043a \u043d\u0430\u0431\u043b\u044e\u0434\u0430\u0435\u043c\u043e\u0441\u0442\u0438","text":"<p>infra-monitoring \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u043a\u043e\u043c\u043f\u043b\u0435\u043a\u0441\u043d\u043e\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u043d\u0430\u0431\u043b\u044e\u0434\u0430\u0435\u043c\u043e\u0441\u0442\u0438 \u0441\u0431\u043e\u0440\u0430 \u043c\u0435\u0442\u0440\u0438\u043a, \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438 \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0434\u043b\u044f \u043e\u0431\u043b\u0430\u0447\u043d\u043e\u0439 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b.</p>"},{"location":"ru/infra-monitoring/#_1","title":"\ud83c\udfaf \u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435","text":"<p>\u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u043e\u043c\u043f\u043b\u0435\u043a\u0441\u043d\u044b\u043c \u0441\u0442\u0435\u043a\u043e\u043c \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430:</p> <ul> <li>Prometheus - \u0421\u0431\u043e\u0440 \u043c\u0435\u0442\u0440\u0438\u043a \u0438 \u043e\u043f\u043e\u0432\u0435\u0449\u0435\u043d\u0438\u044f</li> <li>Grafana - \u0412\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0438 \u0434\u0430\u0448\u0431\u043e\u0440\u0434\u044b</li> <li>Loki - \u0410\u0433\u0440\u0435\u0433\u0430\u0446\u0438\u044f \u0438 \u0437\u0430\u043f\u0440\u043e\u0441 \u043b\u043e\u0433\u043e\u0432</li> <li>\u042d\u043a\u0441\u043f\u043e\u0440\u0442\u0435\u0440\u044b - \u041c\u0435\u0442\u0440\u0438\u043a\u0438 \u0443\u0437\u043b\u043e\u0432, \u043e\u0431\u043b\u0430\u043a\u0430 \u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439</li> </ul>"},{"location":"ru/infra-monitoring/#_2","title":"\ud83d\udcc1 \u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f","text":"<pre><code>infra-monitoring/\n\u251c\u2500\u2500 modules/\n\u2502   \u251c\u2500\u2500 prometheus/         # \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 Prometheus\n\u2502   \u251c\u2500\u2500 grafana/            # Grafana \u0441 \u0434\u0430\u0448\u0431\u043e\u0440\u0434\u0430\u043c\u0438\n\u2502   \u251c\u2500\u2500 loki/               # \u0410\u0433\u0440\u0435\u0433\u0430\u0446\u0438\u044f \u043b\u043e\u0433\u043e\u0432 Loki\n\u2502   \u2514\u2500\u2500 exporters/          # \u0420\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0435 \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0435\u0440\u044b\n\u251c\u2500\u2500 environments/\n\u2502   \u251c\u2500\u2500 dev/\n\u2502   \u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u2502   \u251c\u2500\u2500 variables.tf\n\u2502   \u2502   \u251c\u2500\u2500 terraform.tfvars.example\n\u2502   \u2502   \u2514\u2500\u2500 backend.tf\n\u2502   \u2514\u2500\u2500 prod/\n\u2502       \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 dashboards/             # \u041f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0435 \u0434\u0430\u0448\u0431\u043e\u0440\u0434\u044b Grafana\n\u251c\u2500\u2500 alert_rules.yml         # \u041f\u0440\u0430\u0432\u0438\u043b\u0430 \u043e\u043f\u043e\u0432\u0435\u0449\u0435\u043d\u0438\u0439 Prometheus\n\u251c\u2500\u2500 docker-compose.yml      # \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0434\u043b\u044f \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0439 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"ru/infra-monitoring/#_3","title":"\ud83d\udcca \u041a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b","text":""},{"location":"ru/infra-monitoring/#1-prometheus","title":"1. Prometheus","text":"<p>\u0411\u0430\u0437\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u0440\u044f\u0434\u043e\u0432 \u043c\u0435\u0442\u0440\u0438\u043a \u0441 \u043c\u043e\u0449\u043d\u044b\u043c\u0438 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044f\u043c\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0438 \u043e\u043f\u043e\u0432\u0435\u0449\u0435\u043d\u0438\u0439.</p> <p>\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438: - \u041c\u043d\u043e\u0433\u043e\u043c\u0435\u0440\u043d\u044b\u0435 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 - \u042f\u0437\u044b\u043a \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 PromQL - \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 Alertmanager - \u041e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u0438\u0435 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432 - \u0414\u043e\u043b\u0433\u043e\u0441\u0440\u043e\u0447\u043d\u043e\u0435 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438:</p> <pre><code># prometheus.yml\nglobal:\n  scrape_interval: 15s\n  evaluation_interval: 15s\n\nscrape_configs:\n  - job_name: 'prometheus'\n    static_configs:\n      - targets: ['localhost:9090']\n\n  - job_name: 'node-exporter'\n    static_configs:\n      - targets: ['node-exporter:9100']\n\n  - job_name: 'gcp-monitoring'\n    static_configs:\n      - targets: ['gcp-exporter:9090']\n</code></pre>"},{"location":"ru/infra-monitoring/#2-grafana","title":"2. Grafana","text":"<p>\u041f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0430 \u0434\u043b\u044f \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0438 \u0430\u043d\u0430\u043b\u0438\u0442\u0438\u043a\u0438.</p> <p>\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438: - \u0411\u043e\u0433\u0430\u0442\u044b\u0435 \u0434\u0430\u0448\u0431\u043e\u0440\u0434\u044b - \u041d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u0432 \u0434\u0430\u043d\u043d\u044b\u0445 - \u041e\u043f\u043e\u0432\u0435\u0449\u0435\u043d\u0438\u044f - \u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c\u0438 - \u0412\u0435\u0440\u0441\u0438\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0430\u0448\u0431\u043e\u0440\u0434\u043e\u0432</p> <p>\u041f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0435 \u0434\u0430\u0448\u0431\u043e\u0440\u0434\u044b: - \u041e\u0431\u0437\u043e\u0440 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b - CPU, \u043f\u0430\u043c\u044f\u0442\u044c, \u0434\u0438\u0441\u043a, \u0441\u0435\u0442\u044c - \u041c\u0435\u0442\u0440\u0438\u043a\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439 - \u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432, \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u0438, \u043e\u0448\u0438\u0431\u043a\u0438 - \u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 Kubernetes - \u041c\u0435\u0442\u0440\u0438\u043a\u0438 \u043f\u043e\u0434\u043e\u0432/\u0443\u0437\u043b\u043e\u0432 - \u041f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 - \u041f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432, \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f - \u041e\u0431\u043b\u0430\u0447\u043d\u044b\u0435 \u0440\u0430\u0441\u0445\u043e\u0434\u044b - \u041e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u043d\u0438\u0435 \u0438 \u043e\u043f\u0442\u0438\u043c\u0438\u0437\u0430\u0446\u0438\u044f \u0437\u0430\u0442\u0440\u0430\u0442</p>"},{"location":"ru/infra-monitoring/#3-loki","title":"3. Loki","text":"<p>\u0413\u043e\u0440\u0438\u0437\u043e\u043d\u0442\u0430\u043b\u044c\u043d\u043e \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u0443\u0435\u043c\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0430\u0433\u0440\u0435\u0433\u0430\u0446\u0438\u0438 \u043b\u043e\u0433\u043e\u0432.</p> <p>\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438: - \u0418\u043d\u0434\u0435\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u043c\u0435\u0442\u043e\u043a - \u042f\u0437\u044b\u043a \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 LogQL - \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 Grafana - \u041d\u0438\u0437\u043a\u043e\u0437\u0430\u0442\u0440\u0430\u0442\u043d\u043e\u0435 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 - \u0410\u0433\u0435\u043d\u0442 Promtail</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438:</p> <pre><code># loki-config.yaml\nauth_enabled: false\n\nserver:\n  http_listen_port: 3100\n\ningester:\n  lifecycler:\n    address: 127.0.0.1\n    ring:\n      kvstore:\n        store: inmemory\n      replication_factor: 1\n  chunk_idle_period: 5m\n  chunk_retain_period: 30s\n\nschema_config:\n  configs:\n    - from: 2020-10-24\n      store: boltdb\n      object_store: filesystem\n      schema: v11\n      index:\n        prefix: index_\n        period: 168h\n</code></pre>"},{"location":"ru/infra-monitoring/#4","title":"4. \u042d\u043a\u0441\u043f\u043e\u0440\u0442\u0435\u0440\u044b","text":"<p>\u0421\u0431\u043e\u0440 \u043c\u0435\u0442\u0440\u0438\u043a \u0438\u0437 \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0445 \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u043e\u0432.</p> <p>\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0435\u0440\u044b: - Node Exporter - \u0421\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0435 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 (CPU, \u043f\u0430\u043c\u044f\u0442\u044c, \u0434\u0438\u0441\u043a) - cAdvisor - \u041c\u0435\u0442\u0440\u0438\u043a\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440\u043e\u0432 - Blackbox Exporter - \u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u043a\u043e\u043d\u0435\u0447\u043d\u044b\u0445 \u0442\u043e\u0447\u0435\u043a - \u041e\u0431\u043b\u0430\u0447\u043d\u044b\u0435 \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0435\u0440\u044b - AWS CloudWatch, GCP Monitoring - \u042d\u043a\u0441\u043f\u043e\u0440\u0442\u0435\u0440\u044b \u0431\u0430\u0437 \u0434\u0430\u043d\u043d\u044b\u0445 - PostgreSQL, MySQL, Redis</p>"},{"location":"ru/infra-monitoring/#_4","title":"\ud83d\ude80 \u0411\u044b\u0441\u0442\u0440\u044b\u0439 \u0441\u0442\u0430\u0440\u0442","text":""},{"location":"ru/infra-monitoring/#docker-compose","title":"\u041b\u043e\u043a\u0430\u043b\u044c\u043d\u0430\u044f \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0441 Docker Compose","text":"<pre><code># \u041a\u043b\u043e\u043d\u0438\u0440\u0443\u0439\u0442\u0435 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439\ngit clone https://github.com/v-grand/infra-monitoring.git\ncd infra-monitoring\n\n# \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0435\ncp .env.example .env\n# \u041e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 .env \u0441 \u0432\u0430\u0448\u0438\u043c\u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u043c\u0438\n\n# \u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 \u0441\u0442\u0435\u043a\ndocker-compose up -d\n\n# \u0414\u043e\u0441\u0442\u0443\u043f \u043a \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c\n# Grafana: http://localhost:3000 (admin/admin)\n# Prometheus: http://localhost:9090\n# Loki: http://localhost:3100\n</code></pre>"},{"location":"ru/infra-monitoring/#production-terraform","title":"\u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0432 production \u0441 Terraform","text":"<pre><code>cd environments/prod\ncp terraform.tfvars.example terraform.tfvars\n\n# \u041e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 terraform.tfvars\nterraform init\nterraform plan\nterraform apply\n</code></pre>"},{"location":"ru/infra-monitoring/#grafana","title":"\ud83d\udcc8 \u0414\u0430\u0448\u0431\u043e\u0440\u0434\u044b Grafana","text":""},{"location":"ru/infra-monitoring/#1","title":"1. \u0414\u0430\u0448\u0431\u043e\u0440\u0434 \u043e\u0431\u0437\u043e\u0440\u0430 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b","text":"<p>\u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u043e\u0431\u0449\u0435\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b: - \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 CPU \u043d\u0430 \u0432\u0441\u0435\u0445 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430\u0445 - \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0430\u043c\u044f\u0442\u0438 - \u0412\u0432\u043e\u0434/\u0432\u044b\u0432\u043e\u0434 \u0434\u0438\u0441\u043a\u0430 \u0438 \u0435\u043c\u043a\u043e\u0441\u0442\u044c - \u0421\u0435\u0442\u0435\u0432\u043e\u0439 \u0442\u0440\u0430\u0444\u0438\u043a - \u0421\u0440\u0435\u0434\u043d\u044f\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u044b</p> <p>ID \u0438\u043c\u043f\u043e\u0440\u0442\u0430: <code>1860</code> (Node Exporter Full)</p>"},{"location":"ru/infra-monitoring/#2","title":"2. \u0414\u0430\u0448\u0431\u043e\u0440\u0434 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439","text":"<p>\u041e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u043d\u0438\u0435 \u043c\u0435\u0442\u0440\u0438\u043a \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439: - \u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0438 \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u0430 - \u0427\u0430\u0441\u0442\u043e\u0442\u0430 \u043e\u0448\u0438\u0431\u043e\u043a (4xx, 5xx) - \u041f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043a \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 - \u041a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442\u044b \u043f\u043e\u043f\u0430\u0434\u0430\u043d\u0438\u044f \u0432 \u043a\u044d\u0448 - \u0413\u043b\u0443\u0431\u0438\u043d\u0430 \u043e\u0447\u0435\u0440\u0435\u0434\u0435\u0439</p>"},{"location":"ru/infra-monitoring/#3-kubernetes","title":"3. \u0414\u0430\u0448\u0431\u043e\u0440\u0434 Kubernetes","text":"<p>\u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 Kubernetes: - \u0421\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u044b \u0443\u0437\u043b\u043e\u0432 - \u0417\u0434\u043e\u0440\u043e\u0432\u044c\u0435 \u043f\u043e\u0434\u043e\u0432 \u0438 \u043f\u0435\u0440\u0435\u0437\u0430\u043f\u0443\u0441\u043a\u0438 - \u0421\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f - \u041a\u0432\u043e\u0442\u044b \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 - \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u0441\u0442\u043e\u044f\u043d\u043d\u044b\u0445 \u0442\u043e\u043c\u043e\u0432</p> <p>ID \u0438\u043c\u043f\u043e\u0440\u0442\u0430: <code>15759</code> (\u041c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430 Kubernetes)</p>"},{"location":"ru/infra-monitoring/#4_1","title":"4. \u0414\u0430\u0448\u0431\u043e\u0440\u0434 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430 \u0437\u0430\u0442\u0440\u0430\u0442","text":"<p>\u041e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u043b\u0430\u0447\u043d\u044b\u0445 \u0440\u0430\u0441\u0445\u043e\u0434\u043e\u0432: - \u0415\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u044b\u0435/\u0435\u0436\u0435\u043c\u0435\u0441\u044f\u0447\u043d\u044b\u0435 \u0440\u0430\u0441\u0445\u043e\u0434\u044b \u043f\u043e \u0441\u0435\u0440\u0432\u0438\u0441\u0430\u043c - \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u043f\u043e \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044e \u0441 \u0437\u0430\u0442\u0440\u0430\u0442\u0430\u043c\u0438 - \u041f\u0440\u043e\u0433\u043d\u043e\u0437\u044b \u0437\u0430\u0442\u0440\u0430\u0442 - \u041e\u043f\u043e\u0432\u0435\u0449\u0435\u043d\u0438\u044f \u043e \u0431\u044e\u0434\u0436\u0435\u0442\u0435</p>"},{"location":"ru/infra-monitoring/#_5","title":"\ud83d\udd14 \u041f\u0440\u0430\u0432\u0438\u043b\u0430 \u043e\u043f\u043e\u0432\u0435\u0449\u0435\u043d\u0438\u0439","text":""},{"location":"ru/infra-monitoring/#_6","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u043f\u0440\u0430\u0432\u0438\u043b \u043e\u043f\u043e\u0432\u0435\u0449\u0435\u043d\u0438\u0439","text":"<pre><code># alert_rules.yml\ngroups:\n  - name: infrastructure_alerts\n    interval: 30s\n    rules:\n      - alert: HighCPUUsage\n        expr: 100 - (avg by(instance) (irate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100) &gt; 80\n        for: 5m\n        labels:\n          severity: warning\n        annotations:\n          summary: \"\u0412\u044b\u0441\u043e\u043a\u0430\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 CPU \u043d\u0430 {{ $labels.instance }}\"\n          description: \"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 CPU \u043f\u0440\u0435\u0432\u044b\u0448\u0430\u0435\u0442 80% (\u0442\u0435\u043a\u0443\u0449\u0435\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435: {{ $value }}%)\"\n\n      - alert: HighMemoryUsage\n        expr: (node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) / node_memory_MemTotal_bytes * 100 &gt; 90\n        for: 5m\n        labels:\n          severity: critical\n        annotations:\n          summary: \"\u0412\u044b\u0441\u043e\u043a\u043e\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0430\u043c\u044f\u0442\u0438 \u043d\u0430 {{ $labels.instance }}\"\n          description: \"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0430\u043c\u044f\u0442\u0438 \u043f\u0440\u0435\u0432\u044b\u0448\u0430\u0435\u0442 90% (\u0442\u0435\u043a\u0443\u0449\u0435\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435: {{ $value }}%)\"\n\n      - alert: DiskSpaceLow\n        expr: (node_filesystem_avail_bytes / node_filesystem_size_bytes) * 100 &lt; 10\n        for: 5m\n        labels:\n          severity: warning\n        annotations:\n          summary: \"\u041c\u0430\u043b\u043e \u043c\u0435\u0441\u0442\u0430 \u043d\u0430 \u0434\u0438\u0441\u043a\u0435 \u043d\u0430 {{ $labels.instance }}\"\n          description: \"\u041c\u0435\u0441\u0442\u043e \u043d\u0430 \u0434\u0438\u0441\u043a\u0435 \u043c\u0435\u043d\u044c\u0448\u0435 10% (\u0442\u0435\u043a\u0443\u0449\u0435\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435: {{ $value }}%)\"\n\n      - alert: ServiceDown\n        expr: up == 0\n        for: 2m\n        labels:\n          severity: critical\n        annotations:\n          summary: \"\u0421\u0435\u0440\u0432\u0438\u0441 {{ $labels.job }} \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442\"\n          description: \"{{ $labels.instance }} \u043d\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0431\u043e\u043b\u0435\u0435 2 \u043c\u0438\u043d\u0443\u0442\"\n</code></pre>"},{"location":"ru/infra-monitoring/#alertmanager","title":"\u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f AlertManager","text":"<pre><code># alertmanager.yml\nglobal:\n  resolve_timeout: 5m\n\nroute:\n  group_by: ['alertname', 'cluster', 'service']\n  group_wait: 10s\n  group_interval: 10s\n  repeat_interval: 12h\n  receiver: 'default'\n  routes:\n    - match:\n        severity: critical\n      receiver: 'critical-alerts'\n    - match:\n        severity: warning\n      receiver: 'warning-alerts'\n\nreceivers:\n  - name: 'default'\n    slack_configs:\n      - api_url: 'YOUR_SLACK_WEBHOOK_URL'\n        channel: '#alerts'\n\n  - name: 'critical-alerts'\n    slack_configs:\n      - api_url: 'YOUR_SLACK_WEBHOOK_URL'\n        channel: '#critical-alerts'\n    pagerduty_configs:\n      - service_key: 'YOUR_PAGERDUTY_KEY'\n\n  - name: 'warning-alerts'\n    slack_configs:\n      - api_url: 'YOUR_SLACK_WEBHOOK_URL'\n        channel: '#warnings'\n</code></pre>"},{"location":"ru/infra-monitoring/#_7","title":"\ud83d\udd17 \u041f\u0440\u0438\u043c\u0435\u0440\u044b \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438","text":""},{"location":"ru/infra-monitoring/#infra-aws","title":"\u0421 infra-aws","text":"<pre><code># \u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430 \u0432 AWS\nmodule \"monitoring\" {\n  source = \"github.com/v-grand/infra-monitoring//modules/prometheus\"\n\n  vpc_id    = module.vpc.vpc_id\n  subnet_id = module.vpc.private_subnet_ids[0]\n\n  instance_type = \"t3.medium\"\n\n  scrape_targets = [\n    \"http://app-server-1:9100\",\n    \"http://app-server-2:9100\"\n  ]\n}\n</code></pre>"},{"location":"ru/infra-monitoring/#infra-k8s","title":"\u0421 infra-k8s","text":"<pre><code># \u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0432 Kubernetes\nmodule \"prometheus_helm\" {\n  source = \"github.com/v-grand/infra-monitoring//modules/prometheus\"\n\n  deploy_to_k8s = true\n  namespace      = \"monitoring\"\n\n  storage_class = \"standard\"\n  storage_size  = \"50Gi\"\n\n  grafana_enabled     = true\n  alertmanager_enabled = true\n}\n</code></pre>"},{"location":"ru/infra-monitoring/#infra-gcp","title":"\u0421 infra-gcp","text":"<pre><code># \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u043e\u043c GCP\nmodule \"gcp_monitoring\" {\n  source = \"github.com/v-grand/infra-monitoring//modules/gcp-exporter\"\n\n  project_id = var.gcp_project_id\n\n  export_metrics = [\n    \"compute.googleapis.com/instance/cpu/utilization\",\n    \"compute.googleapis.com/instance/network/received_bytes_count\"\n  ]\n}\n</code></pre>"},{"location":"ru/infra-monitoring/#_8","title":"\ud83d\udee1\ufe0f \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438","text":""},{"location":"ru/infra-monitoring/#_9","title":"\u0410\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f","text":"<pre><code># \u0410\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f Grafana\nenvironment = {\n  GF_AUTH_GENERIC_OAUTH_ENABLED      = \"true\"\n  GF_AUTH_GENERIC_OAUTH_CLIENT_ID    = var.oauth_client_id\n  GF_AUTH_GENERIC_OAUTH_CLIENT_SECRET = var.oauth_client_secret\n  GF_AUTH_GENERIC_OAUTH_SCOPES       = \"openid email profile\"\n}\n</code></pre>"},{"location":"ru/infra-monitoring/#tlsssl","title":"TLS/SSL","text":"<pre><code># Prometheus \u0441 TLS\ntls_config:\n  cert_file: /etc/prometheus/certs/prometheus.crt\n  key_file: /etc/prometheus/certs/prometheus.key\n  client_ca_file: /etc/prometheus/certs/ca.crt\n</code></pre>"},{"location":"ru/infra-monitoring/#_10","title":"\ud83d\udcda \u041b\u0443\u0447\u0448\u0438\u0435 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0438","text":"<ol> <li>\u041f\u043e\u043b\u0438\u0442\u0438\u043a\u0438 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f - \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0438 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445</li> <li>\u0412\u044b\u0441\u043e\u043a\u0430\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u044c - \u0420\u0430\u0437\u0432\u0435\u0440\u043d\u0438\u0442\u0435 \u0438\u0437\u0431\u044b\u0442\u043e\u0447\u043d\u044b\u0435 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u044b Prometheus</li> <li>\u0425\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 - \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043f\u043e\u0441\u0442\u043e\u044f\u043d\u043d\u044b\u0435 \u0442\u043e\u043c\u0430 \u0434\u043b\u044f \u0434\u0430\u043d\u043d\u044b\u0445</li> <li>\u0418\u043d\u0442\u0435\u0440\u0432\u0430\u043b\u044b \u0441\u0431\u043e\u0440\u0430 - \u0411\u0430\u043b\u0430\u043d\u0441 \u043c\u0435\u0436\u0434\u0443 \u0434\u0435\u0442\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0435\u0439 \u0438 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u043e\u0439</li> <li>\u041a\u0430\u0440\u0434\u0438\u043d\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u043c\u0435\u0442\u043e\u043a - \u0418\u0437\u0431\u0435\u0433\u0430\u0439\u0442\u0435 \u043c\u0435\u0442\u043e\u043a \u0441 \u0432\u044b\u0441\u043e\u043a\u043e\u0439 \u043a\u0430\u0440\u0434\u0438\u043d\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u044c\u044e</li> <li>\u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u0434\u0430\u0448\u0431\u043e\u0440\u0434\u043e\u0432 - \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043f\u0430\u043f\u043a\u0438 \u0438 \u0442\u0435\u0433\u0438</li> </ol>"},{"location":"ru/infra-monitoring/#_11","title":"\ud83d\udcd6 \u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f","text":"<ul> <li>\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f Prometheus</li> <li>\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f Grafana</li> <li>\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f Loki</li> </ul>"},{"location":"ru/infra-monitoring/#_12","title":"\ud83d\udd17 \u0421\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438","text":"<ul> <li>infra-core - \u041c\u043e\u0434\u0443\u043b\u0438 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b</li> <li>infra-k8s - \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f Kubernetes</li> <li>infra-network - \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0441\u0435\u0442\u0438</li> </ul>"},{"location":"ru/infra-monitoring/#grafana_1","title":"\u0421\u0445\u0435\u043c\u0430 \u043f\u043e\u0442\u043e\u043a\u043e\u0432 \u0434\u0430\u043d\u043d\u044b\u0445: \u0421\u0431\u043e\u0440 \u043b\u043e\u0433\u043e\u0432 \u043e\u0442 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0434\u043e Grafana","text":"<pre><code>graph TD\n    subgraph \"\u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435\"\n        A[\u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435] -- \"\u0413\u0435\u043d\u0435\u0440\u0438\u0440\u0443\u0435\u0442 \u043b\u043e\u0433\u0438\" --&gt; B(stdout/stderr)\n    end\n\n    subgraph \"\u0421\u0431\u043e\u0440 \u043b\u043e\u0433\u043e\u0432\"\n        B -- \"\u0421\u043e\u0431\u0438\u0440\u0430\u0435\u0442 \u043b\u043e\u0433\u0438\" --&gt; C(Promtail Agent)\n        C -- \"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043b\u043e\u0433\u0438\" --&gt; D(Loki)\n    end\n\n    subgraph \"\u0412\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f\"\n        D -- \"\u0425\u0440\u0430\u043d\u0438\u0442 \u0438 \u0438\u043d\u0434\u0435\u043a\u0441\u0438\u0440\u0443\u0435\u0442 \u043b\u043e\u0433\u0438\" --&gt; E(Grafana)\n        E -- \"\u0417\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u0442 \u0438 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u043b\u043e\u0433\u0438\" --&gt; F[\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c]\n    end\n\n    A -- \"\u041c\u0435\u0442\u0440\u0438\u043a\u0438\" --&gt; G(Prometheus Exporter)\n    G -- \"\u0421\u043a\u0440\u0430\u043f\u0438\u043d\u0433 \u043c\u0435\u0442\u0440\u0438\u043a\" --&gt; H(Prometheus)\n    H -- \"\u0417\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u0442 \u0438 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u043c\u0435\u0442\u0440\u0438\u043a\u0438\" --&gt; E\n</code></pre>"},{"location":"ru/infra-network/","title":"Network","text":""},{"location":"ru/infra-network/#infra-network","title":"infra-network: \u0421\u0435\u0442\u0435\u0432\u0430\u044f \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430","text":"<p>infra-network \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u043a\u043e\u043c\u043f\u043b\u0435\u043a\u0441\u043d\u044b\u0435 \u043c\u043e\u0434\u0443\u043b\u0438 \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b, \u0432\u043a\u043b\u044e\u0447\u0430\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044e VPC, \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0443 VPN \u0438 \u044f\u0447\u0435\u0438\u0441\u0442\u0443\u044e \u0441\u0435\u0442\u044c Tailscale \u0434\u043b\u044f \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0445 \u043e\u0431\u043b\u0430\u0447\u043d\u044b\u0445 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u043e\u0432.</p>"},{"location":"ru/infra-network/#_1","title":"\ud83c\udfaf \u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435","text":"<p>\u042d\u0442\u043e\u0442 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043e\u0439:</p> <ul> <li>\u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f VPC - \u0412\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0435 \u0447\u0430\u0441\u0442\u043d\u044b\u0435 \u043e\u0431\u043b\u0430\u043a\u0430 \u0434\u043b\u044f AWS \u0438 GCP</li> <li>\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 VPN - \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 VPN \u0442\u0438\u043f\u0430 \"\u0441\u0430\u0439\u0442-\u0441\u0430\u0439\u0442\" \u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0433\u043e VPN</li> <li>\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f Tailscale - \u042f\u0447\u0435\u0438\u0441\u0442\u0430\u044f \u0441\u0435\u0442\u044c \u0431\u0435\u0437 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438</li> <li>\u041c\u0443\u043b\u044c\u0442\u0438\u043e\u0431\u043b\u0430\u0447\u043d\u0430\u044f \u0441\u0435\u0442\u044c - \u0415\u0434\u0438\u043d\u0430\u044f \u0441\u0435\u0442\u044c \u0434\u043b\u044f \u0440\u0430\u0437\u043d\u044b\u0445 \u043e\u0431\u043b\u0430\u043a\u043e\u0432</li> </ul>"},{"location":"ru/infra-network/#_2","title":"\ud83d\udcc1 \u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f","text":"<pre><code>infra-network/\n\u251c\u2500\u2500 modules/\n\u2502   \u251c\u2500\u2500 vpc-aws/              # \u041c\u043e\u0434\u0443\u043b\u044c AWS VPC\n\u2502   \u251c\u2500\u2500 vpc-gcp/              # \u041c\u043e\u0434\u0443\u043b\u044c GCP VPC\n\u2502   \u251c\u2500\u2500 vpn/                  # \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 VPN\n\u2502   \u2514\u2500\u2500 tailscale/            # \u042f\u0447\u0435\u0438\u0441\u0442\u0430\u044f \u0441\u0435\u0442\u044c Tailscale\n\u251c\u2500\u2500 environments/\n\u2502   \u251c\u2500\u2500 dev/\n\u2502   \u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u2502   \u251c\u2500\u2500 variables.tf\n\u2502   \u2502   \u251c\u2500\u2500 terraform.tfvars.example\n\u2502   \u2502   \u2514\u2500\u2500 backend.tf\n\u2502   \u2514\u2500\u2500 prod/\n\u2502       \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 .github/\n\u2502   \u2514\u2500\u2500 workflows/\n\u2502       \u2514\u2500\u2500 deploy.yml        # \u041a\u043e\u043d\u0432\u0435\u0439\u0435\u0440 CI/CD\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"ru/infra-network/#_3","title":"\ud83c\udf10 \u041c\u043e\u0434\u0443\u043b\u0438","text":""},{"location":"ru/infra-network/#1-vpc-aws","title":"1. \u041c\u043e\u0434\u0443\u043b\u044c VPC (AWS)","text":"<p>\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 AWS Virtual Private Clouds \u0441 \u043f\u043e\u0434\u0441\u0435\u0442\u044f\u043c\u0438, \u0442\u0430\u0431\u043b\u0438\u0446\u0430\u043c\u0438 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u0438 \u0438 \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442-\u0448\u043b\u044e\u0437\u0430\u043c\u0438.</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f:</p> <pre><code>module \"vpc_aws\" {\n  source = \"github.com/v-grand/infra-network//modules/vpc-aws\"\n\n  vpc_cidr             = \"10.0.0.0/16\"\n  availability_zones   = [\"us-east-1a\", \"us-east-1b\"]\n  public_subnet_cidrs  = [\"10.0.1.0/24\", \"10.0.2.0/24\"]\n  private_subnet_cidrs = [\"10.0.10.0/24\", \"10.0.11.0/24\"]\n\n  enable_nat_gateway = true\n  enable_dns_hostnames = true\n\n  tags = {\n    Environment = \"production\"\n    ManagedBy   = \"terraform\"\n  }\n}\n</code></pre>"},{"location":"ru/infra-network/#2-vpc-gcp","title":"2. \u041c\u043e\u0434\u0443\u043b\u044c VPC (GCP)","text":"<p>\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 GCP Virtual Private Clouds \u0441 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u043c\u0438 \u043f\u043e\u0434\u0441\u0435\u0442\u044f\u043c\u0438 \u0438 \u043f\u0440\u0430\u0432\u0438\u043b\u0430\u043c\u0438 \u0431\u0440\u0430\u043d\u0434\u043c\u0430\u0443\u044d\u0440\u0430.</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f:</p> <pre><code>module \"vpc_gcp\" {\n  source = \"github.com/v-grand/infra-network//modules/vpc-gcp\"\n\n  project_id   = \"my-gcp-project\"\n  network_name = \"main-vpc\"\n\n  subnets = [\n    {\n      subnet_name   = \"subnet-01\"\n      subnet_ip     = \"10.10.10.0/24\"\n      subnet_region = \"us-central1\"\n    },\n    {\n      subnet_name   = \"subnet-02\"\n      subnet_ip     = \"10.10.20.0/24\"\n      subnet_region = \"us-east1\"\n    }\n  ]\n\n  firewall_rules = [\n    {\n      name        = \"allow-ssh\"\n      direction   = \"INGRESS\"\n      ranges      = [\"0.0.0.0/0\"]\n      allow_ports = [\"22\"]\n      protocol    = \"tcp\"\n    }\n  ]\n}\n</code></pre>"},{"location":"ru/infra-network/#3-vpn","title":"3. \u041c\u043e\u0434\u0443\u043b\u044c VPN","text":"<p>\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 VPN-\u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0439 \u0442\u0438\u043f\u0430 \"\u0441\u0430\u0439\u0442-\u0441\u0430\u0439\u0442\" \u043c\u0435\u0436\u0434\u0443 \u043e\u0431\u043b\u0430\u043a\u0430\u043c\u0438.</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f:</p> <pre><code>module \"vpn\" {\n  source = \"github.com/v-grand/infra-network//modules/vpn\"\n\n  vpn_type = \"site-to-site\"\n\n  local_network  = \"10.0.0.0/16\"\n  remote_network = \"10.10.0.0/16\"\n\n  peer_ip_address = \"203.0.113.1\"\n  shared_secret   = var.vpn_shared_secret\n\n  tags = {\n    Environment = \"production\"\n  }\n}\n</code></pre>"},{"location":"ru/infra-network/#4-tailscale","title":"4. \u041c\u043e\u0434\u0443\u043b\u044c Tailscale","text":"<p>\u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 Tailscale \u0434\u043b\u044f \u044f\u0447\u0435\u0438\u0441\u0442\u043e\u0439 \u0441\u0435\u0442\u0438 \u0431\u0435\u0437 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438.</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f:</p> <pre><code>module \"tailscale\" {\n  source = \"github.com/v-grand/infra-network//modules/tailscale\"\n\n  auth_key    = var.tailscale_auth_key\n  hostname    = \"app-server-01\"\n  advertise_routes = [\"10.0.0.0/16\"]\n  accept_routes    = true\n\n  enable_ssh = true\n}\n</code></pre>"},{"location":"ru/infra-network/#_4","title":"\ud83d\ude80 \u0411\u044b\u0441\u0442\u0440\u044b\u0439 \u0441\u0442\u0430\u0440\u0442","text":""},{"location":"ru/infra-network/#1","title":"1. \u041a\u043b\u043e\u043d\u0438\u0440\u0443\u0439\u0442\u0435 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439","text":"<pre><code>git clone https://github.com/v-grand/infra-network.git\ncd infra-network\n</code></pre>"},{"location":"ru/infra-network/#2","title":"2. \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0435","text":"<pre><code>cd environments/dev\ncp terraform.tfvars.example terraform.tfvars\n</code></pre> <p>\u041e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 <code>terraform.tfvars</code>:</p> <pre><code># \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f AWS\naws_region = \"us-east-1\"\nvpc_cidr   = \"10.0.0.0/16\"\n\n# \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f GCP\ngcp_project = \"my-project-id\"\ngcp_region  = \"us-central1\"\n\n# Tailscale\ntailscale_auth_key = \"tskey-xxxxxxxxxxxxx\"\n</code></pre>"},{"location":"ru/infra-network/#3","title":"3. \u0420\u0430\u0437\u0432\u0435\u0440\u043d\u0438\u0442\u0435","text":"<pre><code>terraform init\nterraform plan\nterraform apply\n</code></pre>"},{"location":"ru/infra-network/#_5","title":"\ud83d\udd10 \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438","text":""},{"location":"ru/infra-network/#_6","title":"\u041f\u0440\u0430\u0432\u0438\u043b\u0430 \u0431\u0440\u0430\u043d\u0434\u043c\u0430\u0443\u044d\u0440\u0430","text":"<p>\u0413\u0440\u0443\u043f\u043f\u044b \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438 AWS:</p> <pre><code>resource \"aws_security_group\" \"web\" {\n  name        = \"web-server\"\n  description = \"Allow HTTP/HTTPS inbound traffic\"\n  vpc_id      = module.vpc_aws.vpc_id\n\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    from_port   = 443\n    to_port     = 443\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}\n</code></pre> <p>\u041f\u0440\u0430\u0432\u0438\u043b\u0430 \u0431\u0440\u0430\u043d\u0434\u043c\u0430\u0443\u044d\u0440\u0430 GCP:</p> <pre><code>resource \"google_compute_firewall\" \"web\" {\n  name    = \"allow-web\"\n  network = module.vpc_gcp.network_name\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"80\", \"443\"]\n  }\n\n  source_ranges = [\"0.0.0.0/0\"]\n  target_tags   = [\"web-server\"]\n}\n</code></pre>"},{"location":"ru/infra-network/#_7","title":"\ud83d\udcca \u0421\u0435\u0442\u0435\u0432\u0430\u044f \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430","text":""},{"location":"ru/infra-network/#_8","title":"\u041c\u0443\u043b\u044c\u0442\u0438\u043e\u0431\u043b\u0430\u0447\u043d\u044b\u0439 \u0434\u0438\u0437\u0430\u0439\u043d","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502             \u042f\u0447\u0435\u0438\u0441\u0442\u0430\u044f \u0441\u0435\u0442\u044c Tailscale             \u2502\n\u2502                 (10.100.0.0/16)                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                    \u25b2         \u25b2\n                    \u2502         \u2502\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502                                \u2502\n    \u250c\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2510                    \u250c\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502   AWS    \u2502                    \u2502   GCP    \u2502\n    \u2502   VPC    \u2502\u25c4\u2500\u2500\u2500\u2500\u2500 VPN \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502   VPC    \u2502\n    \u250210.0.0.0/16                    \u250210.10.0.0/16\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"ru/infra-network/#_9","title":"\ud83d\udd17 \u041f\u0440\u0438\u043c\u0435\u0440\u044b \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438","text":""},{"location":"ru/infra-network/#infra-aws","title":"\u0421 infra-aws","text":"<pre><code># infra-aws/main.tf\nmodule \"network\" {\n  source = \"github.com/v-grand/infra-network//modules/vpc-aws\"\n\n  vpc_cidr = var.vpc_cidr\n  # ... \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f\n}\n\nmodule \"app_server\" {\n  source = \"github.com/v-grand/infra-core//modules/vm\"\n\n  subnet_id         = module.network.public_subnet_ids[0]\n  security_group_id = module.network.default_security_group_id\n  # ... \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f\n}\n</code></pre>"},{"location":"ru/infra-network/#infra-gcp","title":"\u0421 infra-gcp","text":"<pre><code># infra-gcp/main.tf\nmodule \"network\" {\n  source = \"github.com/v-grand/infra-network//modules/vpc-gcp\"\n\n  project_id = var.gcp_project_id\n  # ... \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f\n}\n\nmodule \"app_server\" {\n  source = \"github.com/v-grand/infra-core//modules/vm\"\n\n  network    = module.network.network_name\n  subnetwork = module.network.subnet_names[0]\n  # ... \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f\n}\n</code></pre>"},{"location":"ru/infra-network/#_10","title":"\ud83d\udcda \u041b\u0443\u0447\u0448\u0438\u0435 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0438","text":"<ol> <li>\u041f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 CIDR - \u0422\u0449\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u043f\u043b\u0430\u043d\u0438\u0440\u0443\u0439\u0442\u0435 \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d\u044b IP, \u0447\u0442\u043e\u0431\u044b \u0438\u0437\u0431\u0435\u0436\u0430\u0442\u044c \u043a\u043e\u043d\u0444\u043b\u0438\u043a\u0442\u043e\u0432</li> <li>\u0421\u0435\u0433\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u043f\u043e\u0434\u0441\u0435\u0442\u0435\u0439 - \u0420\u0430\u0437\u0434\u0435\u043b\u044f\u0439\u0442\u0435 \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0435/\u043f\u0440\u0438\u0432\u0430\u0442\u043d\u044b\u0435/\u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u0434\u0441\u0435\u0442\u0438</li> <li>NAT Gateways - \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 NAT \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u0443 \u0438\u0437 \u043f\u0440\u0438\u0432\u0430\u0442\u043d\u044b\u0445 \u043f\u043e\u0434\u0441\u0435\u0442\u0435\u0439</li> <li>\u0428\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u0435 VPN - \u0412\u0441\u0435\u0433\u0434\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0441\u0438\u043b\u044c\u043d\u043e\u0435 \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u043b\u044f VPN</li> <li>ACL Tailscale - \u041f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e \u043d\u0430\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0439\u0442\u0435 \u0441\u043f\u0438\u0441\u043a\u0438 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430</li> <li>Transit Gateways - \u0414\u043b\u044f \u0441\u043b\u043e\u0436\u043d\u044b\u0445 \u043c\u0443\u043b\u044c\u0442\u0438-VPC \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440</li> </ol>"},{"location":"ru/infra-network/#_11","title":"\ud83d\udee0\ufe0f \u041f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435","text":""},{"location":"ru/infra-network/#_12","title":"\u041e\u0431\u0449\u0438\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435","text":"\u041f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0430\u044f \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e <code>vpc_cidr</code> \u0411\u043b\u043e\u043a CIDR \u0434\u043b\u044f VPC <code>10.0.0.0/16</code> <code>availability_zones</code> \u0421\u043f\u0438\u0441\u043e\u043a \u0437\u043e\u043d \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u0438 <code>[]</code> <code>enable_nat_gateway</code> \u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c NAT-\u0448\u043b\u044e\u0437 <code>true</code> <code>enable_vpn_gateway</code> \u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c VPN-\u0448\u043b\u044e\u0437 <code>false</code> <code>tailscale_auth_key</code> \u041a\u043b\u044e\u0447 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 Tailscale <code>\"\"</code>"},{"location":"ru/infra-network/#_13","title":"\ud83d\udcd6 \u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f","text":"<ul> <li>\u0428\u0430\u0431\u043b\u043e\u043d\u044b \u043f\u0440\u043e\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f VPC</li> <li>\u0421\u0435\u0442\u044c GCP</li> <li>\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f Tailscale</li> </ul>"},{"location":"ru/infra-network/#_14","title":"\ud83d\udd17 \u0421\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438","text":"<ul> <li>infra-core - \u041f\u0435\u0440\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u043c\u043e\u0434\u0443\u043b\u0438 Terraform</li> <li>infra-aws - \u0418\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 AWS</li> <li>infra-gcp - \u0418\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 GCP</li> <li>infra-monitoring - \u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430 \u0447\u0435\u0440\u0435\u0437 \u0441\u0435\u0442\u0438</li> </ul>"},{"location":"ru/infra-secrets/","title":"Secrets Management","text":""},{"location":"ru/infra-secrets/#infra-secrets","title":"infra-secrets: \u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u0430\u043c\u0438","text":"<p>infra-secrets \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u0435\u0442 \u0446\u0435\u043d\u0442\u0440\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u043e\u0435, \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u0430\u043c\u0438 \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c HashiCorp Vault, SOPS \u0438 \u043e\u0431\u043b\u0430\u0447\u043d\u044b\u0445 \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440\u043e\u0432 \u0441\u0435\u043a\u0440\u0435\u0442\u043e\u0432.</p>"},{"location":"ru/infra-secrets/#_1","title":"\ud83c\udfaf \u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435","text":"<p>\u0426\u0435\u043d\u0442\u0440\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0438 \u0437\u0430\u0449\u0438\u0442\u0430 \u043a\u043e\u043d\u0444\u0438\u0434\u0435\u043d\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445:</p> <ul> <li>HashiCorp Vault - \u0414\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u044b \u0438 \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u0435</li> <li>SOPS - \u0417\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0444\u0430\u0439\u043b\u043e\u0432 \u0441 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u0435\u043c \u0432\u0435\u0440\u0441\u0438\u0439</li> <li>GCP Secret Manager - \u041d\u0430\u0442\u0438\u0432\u043d\u0430\u044f \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441\u0435\u043a\u0440\u0435\u0442\u043e\u0432 GCP</li> <li>AWS Secrets Manager - \u041d\u0430\u0442\u0438\u0432\u043d\u0430\u044f \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441\u0435\u043a\u0440\u0435\u0442\u043e\u0432 AWS</li> </ul>"},{"location":"ru/infra-secrets/#_2","title":"\ud83d\udcc1 \u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f","text":"<pre><code>infra-secrets/\n\u251c\u2500\u2500 modules/\n\u2502   \u251c\u2500\u2500 vault/              # \u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 HashiCorp Vault\n\u2502   \u251c\u2500\u2500 sops/               # \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f SOPS\n\u2502   \u251c\u2500\u2500 gcp-secrets/        # GCP Secret Manager\n\u2502   \u2514\u2500\u2500 aws-secrets/        # AWS Secrets Manager\n\u251c\u2500\u2500 environments/\n\u2502   \u251c\u2500\u2500 dev/\n\u2502   \u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u2502   \u251c\u2500\u2500 variables.tf\n\u2502   \u2502   \u251c\u2500\u2500 terraform.tfvars.example\n\u2502   \u2502   \u251c\u2500\u2500 backend.tf\n\u2502   \u2502   \u2514\u2500\u2500 secrets.enc.yaml  # \u0417\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u044b\n\u2502   \u2514\u2500\u2500 prod/\n\u2502       \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 policies/               # \u041f\u043e\u043b\u0438\u0442\u0438\u043a\u0438 Vault\n\u251c\u2500\u2500 scripts/\n\u2502   \u251c\u2500\u2500 vault-init.sh       # \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f Vault\n\u2502   \u251c\u2500\u2500 sops-encrypt.sh     # \u041f\u043e\u043c\u043e\u0449\u043d\u0438\u043a \u043f\u043e \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u044e SOPS\n\u2502   \u2514\u2500\u2500 sops-decrypt.sh     # \u041f\u043e\u043c\u043e\u0449\u043d\u0438\u043a \u043f\u043e \u0440\u0430\u0441\u0448\u0438\u0444\u0440\u043e\u0432\u043a\u0435 SOPS\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"ru/infra-secrets/#_3","title":"\ud83d\udd10 \u041c\u043e\u0434\u0443\u043b\u0438","text":""},{"location":"ru/infra-secrets/#1-hashicorp-vault","title":"1. HashiCorp Vault","text":"<p>\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u0430\u043c\u0438 \u043a\u043e\u0440\u043f\u043e\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0433\u043e \u0443\u0440\u043e\u0432\u043d\u044f \u0441 \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u043c\u0438 \u0441\u0435\u043a\u0440\u0435\u0442\u0430\u043c\u0438.</p> <p>\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438: - \u041c\u0435\u0445\u0430\u043d\u0438\u0437\u043c \u0441\u0435\u043a\u0440\u0435\u0442\u043e\u0432 KV (v2) - \u0414\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u044b (AWS, GCP, \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445) - \u041c\u0435\u0445\u0430\u043d\u0438\u0437\u043c \u0442\u0440\u0430\u043d\u0437\u0438\u0442\u043d\u043e\u0433\u043e \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u044f - \u0410\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f AppRole - \u0410\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u0442\u043e\u043a\u0435\u043d\u043e\u0432 - \u0416\u0443\u0440\u043d\u0430\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0430\u0443\u0434\u0438\u0442\u0430</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f:</p> <pre><code>module \"vault\" {\n  source = \"github.com/v-grand/infra-secrets//modules/vault\"\n\n  mode = \"ha\"  # \u0438\u043b\u0438 \"dev\" \u0434\u043b\u044f \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438\n\n  # \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f HA\n  storage_backend = \"consul\"\n  consul_address  = \"consul.example.com:8500\"\n\n  # \u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0440\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0430 \u0441 GCP KMS\n  auto_unseal = true\n  kms_project = var.gcp_project\n  kms_region  = \"global\"\n  kms_keyring = \"vault-keyring\"\n  kms_key     = \"vault-key\"\n\n  # \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f TLS\n  tls_cert_file = \"/vault/tls/vault.crt\"\n  tls_key_file  = \"/vault/tls/vault.key\"\n\n  tags = {\n    Environment = \"production\"\n    ManagedBy   = \"terraform\"\n  }\n}\n</code></pre> <p>\u041f\u0440\u0438\u043c\u0435\u0440 \u043f\u043e\u043b\u0438\u0442\u0438\u043a\u0438 Vault:</p> <pre><code># policies/app-policy.hcl\npath \"secret/data/app/*\" {\n  capabilities = [\"read\", \"list\"]\n}\n\npath \"database/creds/app-db\" {\n  capabilities = [\"read\"]\n}\n\npath \"transit/encrypt/app\" {\n  capabilities = [\"update\"]\n}\n\npath \"transit/decrypt/app\" {\n  capabilities = [\"update\"]\n}\n</code></pre>"},{"location":"ru/infra-secrets/#2-sops-secrets-operations","title":"2. SOPS (Secrets OPerationS)","text":"<p>\u0428\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u043e\u0432 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e AWS KMS, GCP KMS \u0438\u043b\u0438 Age.</p> <p>\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438: - \u0428\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u043e\u0432 YAML/JSON/ENV - \u0427\u0430\u0441\u0442\u0438\u0447\u043d\u043e\u0435 \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u0435 (\u0442\u043e\u043b\u044c\u043a\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f) - \u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 KMS - \u0423\u0434\u043e\u0431\u043d\u044b\u0435 \u0434\u043b\u044f Git \u0440\u0430\u0437\u043b\u0438\u0447\u0438\u044f - \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f CI/CD</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f:</p> <p>\u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 <code>.sops.yaml</code>:</p> <pre><code>creation_rules:\n  - path_regex: environments/prod/.*\\.yaml$\n    kms: 'arn:aws:kms:us-east-1:123456789:key/12345678-1234-1234-1234-123456789012'\n    pgp: 'FBC7B9E2A4F9289AC0C1D4843D16CEE4A27381B4'\n\n  - path_regex: environments/dev/.*\\.yaml$\n    age: 'age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p'\n</code></pre> <p>\u0417\u0430\u0448\u0438\u0444\u0440\u0443\u0439\u0442\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u044b:</p> <pre><code># \u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u0444\u0430\u0439\u043b \u0441\u0435\u043a\u0440\u0435\u0442\u043e\u0432\ncat &gt; secrets.yaml &lt;&lt; EOF\ndatabase:\n  host: db.example.com\n  username: admin\n  password: super-secret-password\n\napi_keys:\n  stripe: sk_live_xxxxxxxxxxxxx\n  sendgrid: SG.xxxxxxxxxxxxx\nEOF\n\n# \u0417\u0430\u0448\u0438\u0444\u0440\u0443\u0439\u0442\u0435 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e SOPS\nsops -e secrets.yaml &gt; secrets.enc.yaml\n\n# \u0417\u0430\u043a\u043e\u043c\u043c\u0438\u0442\u044c\u0442\u0435 \u0437\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b\ngit add secrets.enc.yaml\ngit commit -m \"Add encrypted secrets\"\n</code></pre> <p>\u0420\u0430\u0441\u0448\u0438\u0444\u0440\u0443\u0439\u0442\u0435 \u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435:</p> <pre><code># \u0420\u0430\u0441\u0448\u0438\u0444\u0440\u0443\u0439\u0442\u0435 \u0432 CI/CD\nsops -d secrets.enc.yaml &gt; secrets.yaml\n\n# \u0418\u043b\u0438 \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u043a\u0430\u043a \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f\nexport $(sops -d --output-type dotenv secrets.enc.yaml)\n</code></pre>"},{"location":"ru/infra-secrets/#3-gcp-secret-manager","title":"3. GCP Secret Manager","text":"<p>\u041d\u0430\u0442\u0438\u0432\u043d\u043e\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u0430\u043c\u0438 GCP.</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440:</p> <pre><code>module \"gcp_secrets\" {\n  source = \"github.com/v-grand/infra-secrets//modules/gcp-secrets\"\n\n  project_id = var.gcp_project_id\n\n  secrets = {\n    database_password = {\n      secret_data = var.database_password\n      replication = \"automatic\"\n\n      iam_members = [\n        \"serviceAccount:app@project.iam.gserviceaccount.com\"\n      ]\n    }\n\n    api_key = {\n      secret_data = var.api_key\n      replication = \"automatic\"\n      rotation_period = \"2592000s\"  # 30 \u0434\u043d\u0435\u0439\n    }\n  }\n}\n</code></pre> <p>\u0414\u043e\u0441\u0442\u0443\u043f \u0438\u0437 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f:</p> <pre><code>from google.cloud import secretmanager\n\ndef access_secret(project_id, secret_id, version_id=\"latest\"):\n    client = secretmanager.SecretManagerServiceClient()\n    name = f\"projects/{project_id}/secrets/{secret_id}/versions/{version_id}\"\n    response = client.access_secret_version(request={\"name\": name})\n    return response.payload.data.decode(\"UTF-8\")\n\n# \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\ndb_password = access_secret(\"my-project\", \"database_password\")\n</code></pre>"},{"location":"ru/infra-secrets/#4-aws-secrets-manager","title":"4. AWS Secrets Manager","text":"<p>\u041d\u0430\u0442\u0438\u0432\u043d\u043e\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u0430\u043c\u0438 AWS.</p> <p>\u041f\u0440\u0438\u043c\u0435\u0440:</p> <pre><code>module \"aws_secrets\" {\n  source = \"github.com/v-grand/infra-secrets//modules/aws-secrets\"\n\n  secrets = {\n    database_credentials = {\n      secret_string = jsonencode({\n        username = \"admin\"\n        password = var.database_password\n        host     = \"db.example.com\"\n        port     = 5432\n      })\n\n      recovery_window_in_days = 30\n      rotation_enabled        = true\n      rotation_days           = 30\n    }\n\n    api_key = {\n      secret_string = var.api_key\n\n      policy = jsonencode({\n        Version = \"2012-10-17\"\n        Statement = [\n          {\n            Effect = \"Allow\"\n            Principal = {\n              AWS = \"arn:aws:iam::123456789:role/app-role\"\n            }\n            Action   = \"secretsmanager:GetSecretValue\"\n            Resource = \"*\"\n          }\n        ]\n      })\n    }\n\n\n  }\n}\n</code></pre>"},{"location":"ru/infra-secrets/#_4","title":"\ud83d\ude80 \u0411\u044b\u0441\u0442\u0440\u044b\u0439 \u0441\u0442\u0430\u0440\u0442","text":""},{"location":"ru/infra-secrets/#1-vault","title":"1. \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f Vault","text":"<pre><code># \u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 Vault\ncd environments/prod\nterraform init\nterraform apply\n\n# \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f Vault (\u0442\u043e\u043b\u044c\u043a\u043e \u0432 \u043f\u0435\u0440\u0432\u044b\u0439 \u0440\u0430\u0437)\n./scripts/vault-init.sh\n\n# \u041d\u0430\u0434\u0435\u0436\u043d\u043e \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u0435 \u043a\u043e\u0440\u043d\u0435\u0432\u043e\u0439 \u0442\u043e\u043a\u0435\u043d \u0438 \u043a\u043b\u044e\u0447\u0438 \u0440\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0438!\n</code></pre>"},{"location":"ru/infra-secrets/#2-sops","title":"2. \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 SOPS","text":"<pre><code># \u0421\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043a\u043b\u044e\u0447 Age\nage-keygen -o ~/.config/sops/age/keys.txt\n\n# \u0418\u043b\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u043a\u043b\u044e\u0447\u0438 KMS\nexport SOPS_KMS_ARN=\"arn:aws:kms:us-east-1:123456789:key/xxxxx\"\nexport SOPS_GCP_KMS=\"projects/my-project/locations/global/keyRings/my-keyring/cryptoKeys/my-key\"\n</code></pre>"},{"location":"ru/infra-secrets/#3","title":"3. \u0425\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u043e\u0432","text":"<p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 Vault:</p> <pre><code># \u0417\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u0441\u0435\u043a\u0440\u0435\u0442\nvault kv put secret/app/database \\\n  username=admin \\\n  password=super-secret\n\n# \u041f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u0441\u0435\u043a\u0440\u0435\u0442\nvault kv get secret/app/database\n</code></pre> <p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 SOPS:</p> <pre><code># \u0417\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u0442\u044c \u0444\u0430\u0439\u043b\nsops -e config.yaml &gt; config.enc.yaml\n\n# \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0437\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b\nsops config.enc.yaml\n\n# \u0420\u0430\u0441\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u0442\u044c\nsops -d config.enc.yaml\n</code></pre>"},{"location":"ru/infra-secrets/#cicd","title":"\ud83d\udd17 \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f CI/CD","text":""},{"location":"ru/infra-secrets/#github-actions-sops","title":"GitHub Actions \u0441 SOPS","text":"<pre><code>name: Deploy with Secrets\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: \u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c SOPS\n        run: |\n          wget https://github.com/mozilla/sops/releases/download/v3.7.3/sops-v3.7.3.linux\n          chmod +x sops-v3.7.3.linux\n          sudo mv sops-v3.7.3.linux /usr/local/bin/sops\n\n      - name: \u0420\u0430\u0441\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0435\u043a\u0440\u0435\u0442\u044b\n        env:\n          SOPS_AGE_KEY: ${{ secrets.SOPS_AGE_KEY }}\n        run: |\n          sops -d environments/prod/secrets.enc.yaml &gt; secrets.yaml\n\n      - name: \u0420\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044c\n        run: |\n          terraform init\n          terraform apply -auto-approve\n</code></pre>"},{"location":"ru/infra-secrets/#vault-cicd","title":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 Vault \u0432 CI/CD","text":"<pre><code>name: Deploy with Vault\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: \u0418\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0435\u043a\u0440\u0435\u0442\u044b \u0438\u0437 Vault\n        uses: hashicorp/vault-action@v2\n        with:\n          url: https://vault.example.com\n          token: ${{ secrets.VAULT_TOKEN }}\n          secrets: |\n            secret/data/app/database username | DATABASE_USERNAME ;\n            secret/data/app/database password | DATABASE_PASSWORD ;\n            secret/data/app/api apikey | API_KEY\n\n      - name: \u0420\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044c\n        run: |\n          terraform apply -auto-approve\n</code></pre>"},{"location":"ru/infra-secrets/#_5","title":"\ud83d\udd10 \u041b\u0443\u0447\u0448\u0438\u0435 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0438 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438","text":"<ol> <li>\u041d\u0438\u043a\u043e\u0433\u0434\u0430 \u043d\u0435 \u043a\u043e\u043c\u043c\u0438\u0442\u044c\u0442\u0435 \u043d\u0435\u0437\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u044b \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044f \u0432\u0435\u0440\u0441\u0438\u0439</li> <li>\u0420\u0435\u0433\u0443\u043b\u044f\u0440\u043d\u043e \u0440\u043e\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u044b - \u0412\u043d\u0435\u0434\u0440\u0438\u0442\u0435 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0443\u044e \u0440\u043e\u0442\u0430\u0446\u0438\u044e</li> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043f\u0440\u0438\u043d\u0446\u0438\u043f \u043d\u0430\u0438\u043c\u0435\u043d\u044c\u0448\u0438\u0445 \u043f\u0440\u0438\u0432\u0438\u043b\u0435\u0433\u0438\u0439 - \u041f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0439\u0442\u0435 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0439 \u0434\u043e\u0441\u0442\u0443\u043f</li> <li>\u0410\u0443\u0434\u0438\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 - \u0412\u043a\u043b\u044e\u0447\u0438\u0442\u0435 \u0438 \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0439\u0442\u0435 \u0436\u0443\u0440\u043d\u0430\u043b\u044b \u0430\u0443\u0434\u0438\u0442\u0430</li> <li>\u0428\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0435 - \u0412\u0441\u0435\u0433\u0434\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 TLS/HTTPS</li> <li>\u041d\u0430\u0434\u0435\u0436\u043d\u043e\u0435 \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0435 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 - \u0428\u0438\u0444\u0440\u0443\u0439\u0442\u0435 \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u044b\u0435 \u043a\u043e\u043f\u0438\u0438 Vault</li> <li>\u041c\u043d\u043e\u0433\u043e\u0444\u0430\u043a\u0442\u043e\u0440\u043d\u0430\u044f \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f - \u0412\u043a\u043b\u044e\u0447\u0438\u0442\u0435 MFA \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a Vault</li> </ol>"},{"location":"ru/infra-secrets/#_6","title":"\ud83d\udcca \u041f\u0440\u0438\u043c\u0435\u0440\u044b \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438","text":""},{"location":"ru/infra-secrets/#infra-aws","title":"\u0421 infra-aws","text":"<pre><code># \u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u043e\u0432 \u0438\u0437 Vault \u0434\u043b\u044f \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044f AWS\ndata \"vault_generic_secret\" \"aws_credentials\" {\n  path = \"secret/aws/credentials\"\n}\n\nmodule \"app_server\" {\n  source = \"github.com/v-grand/infra-core//modules/vm\"\n\n  # \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0443\u0447\u0435\u0442\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445\n  aws_access_key = data.vault_generic_secret.aws_credentials.data[\"access_key\"]\n  aws_secret_key = data.vault_generic_secret.aws_credentials.data[\"secret_key\"]\n}\n</code></pre>"},{"location":"ru/infra-secrets/#infra-monitoring","title":"\u0421 infra-monitoring","text":"<pre><code># \u0425\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430 Grafana \u0432 Vault\nresource \"vault_generic_secret\" \"grafana_admin\" {\n  path = \"secret/monitoring/grafana\"\n\n  data_json = jsonencode({\n    admin_password = random_password.grafana_admin.result\n  })\n}\n\nmodule \"monitoring\" {\n  source = \"github.com/v-grand/infra-monitoring//modules/grafana\"\n\n  admin_password = vault_generic_secret.grafana_admin.data[\"admin_password\"]\n}\n</code></pre>"},{"location":"ru/infra-secrets/#_7","title":"\ud83d\udcda \u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f","text":"<ul> <li>HashiCorp Vault</li> <li>SOPS</li> <li>GCP Secret Manager</li> <li>AWS Secrets Manager</li> </ul>"},{"location":"ru/infra-secrets/#_8","title":"\ud83d\udd17 \u0421\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438","text":"<ul> <li>infra-ci - \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f CI/CD</li> <li>infra-core - \u041c\u043e\u0434\u0443\u043b\u0438 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b</li> <li>infra-aws - \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f AWS</li> <li>infra-gcp - \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f GCP</li> </ul>"},{"location":"ru/infra-secrets/#vault-kubernetes","title":"\u0421\u0445\u0435\u043c\u0430 \u043f\u043e\u0442\u043e\u043a\u043e\u0432 \u0434\u0430\u043d\u043d\u044b\u0445: \u0421\u0435\u043a\u0440\u0435\u0442\u044b \u043e\u0442 Vault \u0434\u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0432 Kubernetes","text":"<pre><code>graph TD\n    subgraph \"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u0430\u043c\u0438\"\n        A[Vault] -- \"\u0425\u0440\u0430\u043d\u0438\u0442 \u0441\u0435\u043a\u0440\u0435\u0442\u044b\" --&gt; B(Vault Agent / CSI Driver)\n    end\n\n    subgraph \"Kubernetes\"\n        B -- \"\u0418\u043d\u0436\u0435\u043a\u0442\u0438\u0440\u0443\u0435\u0442 \u0441\u0435\u043a\u0440\u0435\u0442\u044b\" --&gt; C(Pod / \u041a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440)\n        C -- \"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0441\u0435\u043a\u0440\u0435\u0442\u044b\" --&gt; D(\u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435)\n    end\n\n    subgraph \"\u0420\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a / CI/CD\"\n        E[\u0420\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a / CI/CD] -- \"\u0417\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442 \u0441\u0435\u043a\u0440\u0435\u0442\u044b\" --&gt; A\n    end\n\n    E -- \"\u0417\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u0442 \u0441\u0435\u043a\u0440\u0435\u0442\u044b\" --&gt; A\n    A -- \"\u041f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u0435\u043a\u0440\u0435\u0442\u044b\" --&gt; E\n</code></pre>"},{"location":"ru/infra-template/","title":"Infra Template","text":""},{"location":"ru/infra-template/#infra-template","title":"infra-template: \u0428\u0430\u0431\u043b\u043e\u043d \u043f\u0440\u043e\u0435\u043a\u0442\u0430","text":"<p>infra-template \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u0443\u044e \u043e\u0442\u043f\u0440\u0430\u0432\u043d\u0443\u044e \u0442\u043e\u0447\u043a\u0443 \u0434\u043b\u044f \u043d\u043e\u0432\u044b\u0445 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043d\u044b\u0445 \u043f\u0440\u043e\u0435\u043a\u0442\u043e\u0432 \u0441 \u043b\u0443\u0447\u0448\u0438\u043c\u0438 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0430\u043c\u0438, \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0435\u0439 CI/CD \u0438 \u0441\u043e\u0433\u043b\u0430\u0441\u043e\u0432\u0430\u043d\u043d\u043e\u0439 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043e\u0439.</p>"},{"location":"ru/infra-template/#_1","title":"\ud83c\udfaf \u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435","text":"<p>\u0417\u0430\u043f\u0443\u0441\u043a \u043d\u043e\u0432\u044b\u0445 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043d\u044b\u0445 \u043f\u0440\u043e\u0435\u043a\u0442\u043e\u0432:</p> <ul> <li>\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 - \u0421\u043e\u0433\u043b\u0430\u0441\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u043a\u043e\u043c\u043f\u043e\u043d\u043e\u0432\u043a\u0430 \u043f\u0440\u043e\u0435\u043a\u0442\u0430</li> <li>\u041b\u0443\u0447\u0448\u0438\u0435 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0438 - \u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c, \u043c\u043e\u0434\u0443\u043b\u044c\u043d\u043e\u0441\u0442\u044c, \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f</li> <li>\u0413\u043e\u0442\u043e\u0432\u043d\u043e\u0441\u0442\u044c \u043a CI/CD - \u041f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0435 GitHub Actions</li> <li>\u041c\u0443\u043b\u044c\u0442\u0438\u043e\u0431\u043b\u0430\u0447\u043d\u043e\u0441\u0442\u044c - \u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 AWS \u0438 GCP</li> <li>\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f - \u041a\u043e\u043c\u043f\u043b\u0435\u043a\u0441\u043d\u044b\u0435 \u0448\u0430\u0431\u043b\u043e\u043d\u044b</li> </ul>"},{"location":"ru/infra-template/#_2","title":"\ud83d\udcc1 \u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f","text":"<pre><code>infra-template/\n\u251c\u2500\u2500 .github/\n\u2502   \u2514\u2500\u2500 workflows/\n\u2502       \u251c\u2500\u2500 validate.yml       # \u0412\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044f Terraform\n\u2502       \u2514\u2500\u2500 deploy.yml         # \u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435\n\u251c\u2500\u2500 modules/\n\u2502   \u2514\u2500\u2500 vm/                    # \u041f\u0440\u0438\u043c\u0435\u0440 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043c\u043e\u0434\u0443\u043b\u044f\n\u2502       \u251c\u2500\u2500 main.tf\n\u2502       \u251c\u2500\u2500 variables.tf\n\u2502       \u251c\u2500\u2500 outputs.tf\n\u2502       \u2514\u2500\u2500 README.md\n\u251c\u2500\u2500 examples/\n\u2502   \u251c\u2500\u2500 simple-vm/             # \u0411\u0430\u0437\u043e\u0432\u043e\u0435 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 VM\n\u2502   \u2514\u2500\u2500 multi-tier/            # \u041c\u043d\u043e\u0433\u043e\u0443\u0440\u043e\u0432\u043d\u0435\u0432\u0430\u044f \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430\n\u251c\u2500\u2500 docs/\n\u2502   \u251c\u2500\u2500 README.md              # \u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0430\u044f \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f\n\u2502   \u251c\u2500\u2500 ARCHITECTURE.md        # \u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u044b\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u044f\n\u2502   \u2514\u2500\u2500 DEPLOYMENT.md          # \u0420\u0443\u043a\u043e\u0432\u043e\u0434\u0441\u0442\u0432\u043e \u043f\u043e \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044e\n\u251c\u2500\u2500 main.tf                    # \u041a\u043e\u0440\u043d\u0435\u0432\u0430\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f Terraform\n\u251c\u2500\u2500 variables.tf               # \u0412\u0445\u043e\u0434\u043d\u044b\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435\n\u251c\u2500\u2500 outputs.tf                 # \u0412\u044b\u0445\u043e\u0434\u043d\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f\n\u251c\u2500\u2500 terraform.tfvars.example   # \u041f\u0440\u0438\u043c\u0435\u0440 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445\n\u251c\u2500\u2500 backend.tf                 # \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0431\u044d\u043a\u0435\u043d\u0434\u0430\n\u251c\u2500\u2500 versions.tf                # \u0412\u0435\u0440\u0441\u0438\u0438 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u043e\u0432\n\u251c\u2500\u2500 .gitignore                 # \u041f\u0440\u0430\u0432\u0438\u043b\u0430 \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f Git\n\u251c\u2500\u2500 .terraform-docs.yml        # \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f terraform-docs\n\u251c\u2500\u2500 .pre-commit-config.yaml    # \u0425\u0443\u043a\u0438 pre-commit\n\u2514\u2500\u2500 README.md                  # \u041e\u0431\u0437\u043e\u0440 \u043f\u0440\u043e\u0435\u043a\u0442\u0430\n</code></pre>"},{"location":"ru/infra-template/#_3","title":"\ud83d\ude80 \u041d\u0430\u0447\u0430\u043b\u043e \u0440\u0430\u0431\u043e\u0442\u044b","text":""},{"location":"ru/infra-template/#1","title":"1. \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0433\u043e \u043f\u0440\u043e\u0435\u043a\u0442\u0430 \u0438\u0437 \u0448\u0430\u0431\u043b\u043e\u043d\u0430","text":"<p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 GitHub:</p> <pre><code># \u041d\u0430\u0436\u043c\u0438\u0442\u0435 \"Use this template\" \u043d\u0430 GitHub\n# \u0418\u043b\u0438 \u043a\u043b\u043e\u043d\u0438\u0440\u0443\u0439\u0442\u0435 \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e:\ngit clone https://github.com/v-grand/infra-template.git my-new-project\ncd my-new-project\n\n# \u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0438\u0441\u0442\u043e\u0440\u0438\u044e Git\nrm -rf .git\ngit init\ngit add .\ngit commit -m \"Initial commit from template\"\n</code></pre>"},{"location":"ru/infra-template/#2","title":"2. \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u043f\u0440\u043e\u0435\u043a\u0442\u0430","text":"<pre><code># \u0421\u043a\u043e\u043f\u0438\u0440\u0443\u0439\u0442\u0435 \u043f\u0440\u0438\u043c\u0435\u0440 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438\ncp terraform.tfvars.example terraform.tfvars\n\n# \u041e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u0441 \u0432\u0430\u0448\u0438\u043c\u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u043c\u0438\nnano terraform.tfvars\n</code></pre> <p>\u041f\u0440\u0438\u043c\u0435\u0440 terraform.tfvars:</p> <pre><code># \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0435\u043a\u0442\u0430\nproject_name = \"my-app\"\nenvironment  = \"dev\"\n\n# \u041e\u0431\u043b\u0430\u0447\u043d\u044b\u0439 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440 (aws \u0438\u043b\u0438 gcp)\ncloud = \"gcp\"\n\n# \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f GCP\ngcp_project = \"my-gcp-project\"\ngcp_region  = \"us-central1\"\ngcp_zone    = \"us-central1-a\"\n\n# \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f AWS\naws_region = \"us-east-1\"\n\n# \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0441\u0435\u0442\u0438\nvpc_cidr = \"10.0.0.0/16\"\n\n# \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u0439\ninstance_type = \"e2-medium\"  # GCP\n# instance_type = \"t3.medium\"  # AWS\n\n# \u0422\u0435\u0433\u0438\ntags = {\n  Environment = \"dev\"\n  ManagedBy   = \"terraform\"\n  Project     = \"my-app\"\n}\n</code></pre>"},{"location":"ru/infra-template/#3","title":"3. \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0438 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435","text":"<pre><code># \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f Terraform\nterraform init\n\n# \u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u043f\u043b\u0430\u043d\u0430\nterraform plan\n\n# \u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438\nterraform apply\n</code></pre>"},{"location":"ru/infra-template/#_4","title":"\ud83d\udcdd \u0424\u0430\u0439\u043b\u044b \u0448\u0430\u0431\u043b\u043e\u043d\u043e\u0432","text":""},{"location":"ru/infra-template/#maintf","title":"main.tf","text":"<pre><code># \u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f Terraform\nterraform {\n  required_version = \"&gt;= 1.5.0\"\n\n  required_providers {\n    google = {\n      source  = \"hashicorp/google\"\n      version = \"~&gt; 5.0\"\n    }\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"~&gt; 5.0\"\n    }\n  }\n}\n\n# \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430\nprovider \"google\" {\n  project = var.gcp_project\n  region  = var.gcp_region\n}\n\nprovider \"aws\" {\n  region = var.aws_region\n}\n\n# \u041f\u0440\u0438\u043c\u0435\u0440: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043c\u043e\u0434\u0443\u043b\u0435\u0439 infra-core\nmodule \"vm\" {\n  source = \"github.com/v-grand/infra-core//modules/vm\"\n\n  cloud         = var.cloud\n  instance_name = \"${var.project_name}-${var.environment}\"\n  instance_type = var.instance_type\n\n  # \u0421\u043f\u0435\u0446\u0438\u0444\u0438\u0447\u043d\u043e \u0434\u043b\u044f GCP\n  project = var.cloud == \"gcp\" ? var.gcp_project : null\n  zone    = var.cloud == \"gcp\" ? var.gcp_zone : null\n\n  # \u0421\u043f\u0435\u0446\u0438\u0444\u0438\u0447\u043d\u043e \u0434\u043b\u044f AWS\n  subnet_id = var.cloud == \"aws\" ? var.aws_subnet_id : null\n\n  tags = var.tags\n}\n</code></pre>"},{"location":"ru/infra-template/#variablestf","title":"variables.tf","text":"<pre><code>variable \"project_name\" {\n  description = \"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0435\u043a\u0442\u0430\"\n  type        = string\n}\n\nvariable \"environment\" {\n  description = \"\u041e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0435 (dev, staging, prod)\"\n  type        = string\n  default     = \"dev\"\n\n  validation {\n    condition     = contains([\"dev\", \"staging\", \"prod\"], var.environment)\n    error_message = \"\u041e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c dev, staging \u0438\u043b\u0438 prod.\"\n  }\n}\n\nvariable \"cloud\" {\n  description = \"\u041e\u0431\u043b\u0430\u0447\u043d\u044b\u0439 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440 (aws \u0438\u043b\u0438 gcp)\"\n  type        = string\n  default     = \"gcp\"\n\n  validation {\n    condition     = contains([\"aws\", \"gcp\"], var.cloud)\n    error_message = \"\u041e\u0431\u043b\u0430\u043a\u043e \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c aws \u0438\u043b\u0438 gcp.\"\n  }\n}\n\nvariable \"gcp_project\" {\n  description = \"ID \u043f\u0440\u043e\u0435\u043a\u0442\u0430 GCP\"\n  type        = string\n  default     = \"\"\n}\n\nvariable \"gcp_region\" {\n  description = \"\u0420\u0435\u0433\u0438\u043e\u043d GCP\"\n  type        = string\n  default     = \"us-central1\"\n}\n\nvariable \"tags\" {\n  description = \"\u0422\u0435\u0433\u0438 \u0434\u043b\u044f \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043a \u0440\u0435\u0441\u0443\u0440\u0441\u0430\u043c\"\n  type        = map(string)\n  default     = {}\n}\n</code></pre>"},{"location":"ru/infra-template/#outputstf","title":"outputs.tf","text":"<pre><code>output \"instance_id\" {\n  description = \"ID \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u043e\u0433\u043e \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430\"\n  value       = module.vm.instance_id\n}\n\noutput \"instance_ip\" {\n  description = \"IP-\u0430\u0434\u0440\u0435\u0441 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430\"\n  value       = module.vm.instance_ip\n}\n\noutput \"instance_name\" {\n  description = \"\u0418\u043c\u044f \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430\"\n  value       = module.vm.instance_name\n}\n</code></pre>"},{"location":"ru/infra-template/#backendtf","title":"backend.tf","text":"<pre><code># \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0431\u044d\u043a\u0435\u043d\u0434\u0430 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f Terraform\nterraform {\n  backend \"gcs\" {\n    bucket  = \"my-terraform-state-bucket\"\n    prefix  = \"terraform/state\"\n  }\n\n  # \u0410\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u0430: \u0431\u044d\u043a\u0435\u043d\u0434 AWS S3\n  # backend \"s3\" {\n  #   bucket         = \"my-terraform-state-bucket\"\n  #   key            = \"terraform.tfstate\"\n  #   region         = \"us-east-1\"\n  #   dynamodb_table = \"terraform-locks\"\n  #   encrypt        = true\n  # }\n}\n</code></pre>"},{"location":"ru/infra-template/#cicd","title":"\ud83d\udd04 \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f CI/CD","text":""},{"location":"ru/infra-template/#githubworkflowsvalidateyml","title":".github/workflows/validate.yml","text":"<pre><code>name: Terraform Validation\non:\n [pull_request, push]\n\njobs:\n  validate:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Setup Terraform\n        uses: hashicorp/setup-terraform@v2\n        with:\n          terraform_version: 1.5.0\n\n      - name: Terraform Format\n        run: terraform fmt -check -recursive\n\n      - name: Terraform Init\n        run: terraform init -backend=false\n\n      - name: Terraform Validate\n        run: terraform validate\n</code></pre>"},{"location":"ru/infra-template/#githubworkflowsdeployyml","title":".github/workflows/deploy.yml","text":"<pre><code>name: Deploy Infrastructure\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    uses: v-grand/infra-ci/.github/workflows/reusable/terraform-apply.yml@main\n    with:\n      working-directory: ./\n      environment: dev\n    secrets:\n      GCP_CREDENTIALS: ${{ secrets.GCP_CREDENTIALS }}\n</code></pre>"},{"location":"ru/infra-template/#pre-commit","title":"\ud83d\udd27 \u0425\u0443\u043a\u0438 Pre-commit","text":""},{"location":"ru/infra-template/#pre-commit-configyaml","title":".pre-commit-config.yaml","text":"<pre><code>repos:\n  - repo: https://github.com/antonbabenko/pre-commit-terraform\n    rev: v1.83.5\n    hooks:\n      - id: terraform_fmt\n      - id: terraform_validate\n      - id: terraform_docs\n        args:\n          - --hook-config=--path-to-file=README.md\n          - --hook-config=--add-to-existing-file=true\n          - --hook-config=--create-file-if-not-exist=true\n      - id: terraform_tflint\n        args:\n          - --args=--config=__GIT_WORKING_DIR__/.tflint.hcl\n</code></pre> <p>\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430:</p> <pre><code># \u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 pre-commit\npip install pre-commit\n\n# \u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430 \u0445\u0443\u043a\u043e\u0432\npre-commit install\n\n# \u0417\u0430\u043f\u0443\u0441\u043a \u0432\u0440\u0443\u0447\u043d\u0443\u044e\npre-commit run --all-files\n</code></pre>"},{"location":"ru/infra-template/#_5","title":"\ud83d\udcda \u0428\u0430\u0431\u043b\u043e\u043d\u044b \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438","text":""},{"location":"ru/infra-template/#readmemd","title":"\u0428\u0430\u0431\u043b\u043e\u043d README.md","text":"<pre><code># \u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0435\u043a\u0442\u0430\n\n\u041a\u0440\u0430\u0442\u043a\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0442\u043e\u0433\u043e, \u0447\u0442\u043e \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u0435\u0442 \u044d\u0442\u0430 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430.\n\n## \u0410\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u0430\n\n[\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0437\u0434\u0435\u0441\u044c \u0430\u0440\u0445\u0438\u0442\u0435\u043a\u0442\u0443\u0440\u043d\u0443\u044e \u0434\u0438\u0430\u0433\u0440\u0430\u043c\u043c\u0443]\n\n## \u041f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f\n\n- Terraform &gt;= 1.5.0\n- \u0423\u0447\u0435\u0442\u043d\u0430\u044f \u0437\u0430\u043f\u0438\u0441\u044c GCP/AWS \u0441 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u043c\u0438 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f\u043c\u0438\n- [\u0414\u0440\u0443\u0433\u0438\u0435 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f]\n\n## \u0411\u044b\u0441\u0442\u0440\u044b\u0439 \u0441\u0442\u0430\u0440\u0442\n\n1. \u041a\u043b\u043e\u043d\u0438\u0440\u0443\u0439\u0442\u0435 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439\n2. \u0421\u043a\u043e\u043f\u0438\u0440\u0443\u0439\u0442\u0435 `terraform.tfvars.example` \u0432 `terraform.tfvars`\n3. \u041e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 `terraform.tfvars` \u0441 \u0432\u0430\u0448\u0435\u0439 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0435\u0439\n4. \u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 `terraform init &amp;&amp; terraform apply`\n\n## \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f\n\n[\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u043a\u043b\u044e\u0447\u0435\u0432\u044b\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0438 \u0438\u0445 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435]\n\n## \u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435\n\n[\u041f\u043e\u0448\u0430\u0433\u043e\u0432\u044b\u0435 \u0438\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u0438 \u043f\u043e \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044e]\n\n## \u041e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u043d\u0438\u0435\n\n[\u0422\u0435\u043a\u0443\u0449\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u043f\u043e \u043e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u043d\u0438\u044e]\n\n## \u0423\u0441\u0442\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u043d\u0435\u043f\u043e\u043b\u0430\u0434\u043e\u043a\n\n[\u0420\u0430\u0441\u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0435\u043d\u043d\u044b\u0435 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b \u0438 \u0440\u0435\u0448\u0435\u043d\u0438\u044f]\n</code></pre>"},{"location":"ru/infra-template/#_6","title":"\ud83c\udfa8 \u041a\u0430\u0441\u0442\u043e\u043c\u0438\u0437\u0430\u0446\u0438\u044f","text":""},{"location":"ru/infra-template/#_7","title":"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0445 \u043c\u043e\u0434\u0443\u043b\u0435\u0439","text":"<pre><code># \u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u043d\u043e\u0432\u044b\u0439 \u043c\u043e\u0434\u0443\u043b\u044c\nmkdir -p modules/my-module\ncd modules/my-module\n\n# \u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u0444\u0430\u0439\u043b\u044b \u043c\u043e\u0434\u0443\u043b\u044f\ncat &gt; main.tf &lt;&lt; EOF\n# \u0420\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043c\u043e\u0434\u0443\u043b\u044f\nEOF\n\ncat &gt; variables.tf &lt;&lt; EOF\n# \u041f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u043c\u043e\u0434\u0443\u043b\u044f\nEOF\n\ncat &gt; outputs.tf &lt;&lt; EOF\n# \u0412\u044b\u0445\u043e\u0434\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043c\u043e\u0434\u0443\u043b\u044f\nEOF\n\ncat &gt; README.md &lt;&lt; EOF\n# \u041c\u043e\u0439 \u043c\u043e\u0434\u0443\u043b\u044c\n\n\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043c\u043e\u0434\u0443\u043b\u044f\nEOF\n</code></pre>"},{"location":"ru/infra-template/#infra-core","title":"\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 infra-core","text":"<pre><code># \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u043c\u043e\u0434\u0443\u043b\u0435\u0439 infra-core\nmodule \"database\" {\n  source = \"github.com/v-grand/infra-core//modules/db\"\n\n  # \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f\n}\n\nmodule \"network\" {\n  source = \"github.com/v-grand/infra-network//modules/vpc-gcp\"\n\n  # \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f\n}\n</code></pre>"},{"location":"ru/infra-template/#_8","title":"\u2705 \u0412\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0435 \u043b\u0443\u0447\u0448\u0438\u0435 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0438","text":"<ol> <li>\u0424\u0438\u043a\u0441\u0430\u0446\u0438\u044f \u0432\u0435\u0440\u0441\u0438\u0439 - \u0412\u0435\u0440\u0441\u0438\u0438 Terraform \u0438 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u043e\u0432 \u0437\u0430\u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u044b</li> <li>\u0412\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044f \u0432\u0432\u043e\u0434\u0430 - \u041f\u0440\u0430\u0432\u0438\u043b\u0430 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445</li> <li>\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u0432\u044b\u0432\u043e\u0434\u0430 - \u041e\u043f\u0438\u0441\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0432\u044b\u0445\u043e\u0434\u043d\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f</li> <li>\u0424\u043e\u0440\u043c\u0430\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u0434\u0430 - \u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043e \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e pre-commit</li> <li>\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c - .gitignore \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043a\u043e\u043c\u043c\u0438\u0442\u044b \u0441\u0435\u043a\u0440\u0435\u0442\u043e\u0432</li> <li>CI/CD - \u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044f \u0438 \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435</li> <li>\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f - \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f terraform-docs</li> <li>\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435\u043c - \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u0431\u044d\u043a\u0435\u043d\u0434\u0430</li> </ol>"},{"location":"ru/infra-template/#_9","title":"\ud83d\udd17 \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f","text":""},{"location":"ru/infra-template/#_10","title":"\u0421 \u0434\u0440\u0443\u0433\u0438\u043c\u0438 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u044f\u043c\u0438","text":"<pre><code># \u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043c\u043e\u0434\u0443\u043b\u0438 infra-core\nmodule \"vm\" {\n  source = \"github.com/v-grand/infra-core//modules/vm\"\n}\n\n# \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043c\u043e\u0434\u0443\u043b\u0435\u0439 infra-network\nmodule \"vpc\" {\n  source = \"github.com/v-grand/infra-network//modules/vpc-gcp\"\n}\n\n# \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u043c\u043e\u043d\u0438\u0442\u043e\u0440\u0438\u043d\u0433\u0430\nmodule \"monitoring\" {\n  source = \"github.com/v-grand/infra-monitoring//modules/prometheus\"\n}\n</code></pre>"},{"location":"ru/infra-template/#_11","title":"\ud83d\udcd6 \u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f","text":"<ul> <li>\u041b\u0443\u0447\u0448\u0438\u0435 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0438 Terraform</li> <li>\u041c\u043e\u0434\u0443\u043b\u0438 infra-core</li> <li>\u0420\u0430\u0431\u043e\u0447\u0438\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b CI/CD</li> </ul>"},{"location":"ru/infra-template/#_12","title":"\ud83d\udd17 \u0421\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0435 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438","text":"<ul> <li>infra-core - \u041f\u0435\u0440\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u043c\u043e\u0434\u0443\u043b\u0438</li> <li>infra-ci - \u0420\u0430\u0431\u043e\u0447\u0438\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b CI/CD</li> <li>infra-docs - \u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f</li> </ul>"},{"location":"ru/tailscale/","title":"Tailscale","text":""},{"location":"ru/tailscale/#tailscale","title":"\u042f\u0447\u0435\u0438\u0441\u0442\u0430\u044f \u0441\u0435\u0442\u044c Tailscale","text":"<p>\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u043f\u043e \u044f\u0447\u0435\u0438\u0441\u0442\u043e\u0439 \u0441\u0435\u0442\u0438 Tailscale.</p>"},{"location":"ru/template-platform/","title":"Template Platform","text":""},{"location":"ru/template-platform/#template-platform","title":"Template Platform","text":"<p>Template Platform \u2014 \u044d\u0442\u043e \u0444\u0443\u043d\u0434\u0430\u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u044b\u0439 \u0431\u044d\u043a\u0435\u043d\u0434-\u0441\u0435\u0440\u0432\u0438\u0441, \u0441\u043f\u0440\u043e\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u043a\u0430\u043a \u0433\u043e\u0442\u043e\u0432\u0430\u044f \u043a \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044e, \u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u0443\u0435\u043c\u0430\u044f \u0438 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u0430\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u043d\u0430\u044f \u0442\u043e\u0447\u043a\u0430 \u0434\u043b\u044f \u043d\u043e\u0432\u044b\u0445 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439. \u041e\u043d \u0431\u0435\u0437 \u043f\u0440\u043e\u0431\u043b\u0435\u043c \u0438\u043d\u0442\u0435\u0433\u0440\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u0441 \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043d\u044b\u043c\u0438 \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430\u043c\u0438 \u0438\u0437 <code>infra-core</code> \u0438 <code>infra-template</code>, \u0430 \u0435\u0433\u043e \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043f\u0430\u0439\u043f\u043b\u0430\u0439\u043d\u0430\u043c\u0438 \u0438\u0437 <code>infra-ci</code>.</p>"},{"location":"ru/template-platform/#_1","title":"\u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0435 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435","text":"<p>\u0413\u043b\u0430\u0432\u043d\u0430\u044f \u0446\u0435\u043b\u044c <code>template-platform</code> \u2014 \u0443\u0441\u043a\u043e\u0440\u0438\u0442\u044c \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0443, \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u044f \u043f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u043e\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0435, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442:</p> <ul> <li>\u041a\u0430\u0440\u043a\u0430\u0441 API: \u0411\u0430\u0437\u043e\u0432\u0430\u044f \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f RESTful \u0438\u043b\u0438 GraphQL API.</li> <li>\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 \u0431\u0430\u0437\u043e\u0439 \u0434\u0430\u043d\u043d\u044b\u0445: \u041f\u0440\u0435\u0434\u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u043c \u0431\u0430\u0437\u0430\u043c \u0434\u0430\u043d\u043d\u044b\u0445.</li> <li>\u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044f \u0441 CI/CD: \u0413\u043e\u0442\u043e\u0432\u043d\u043e\u0441\u0442\u044c \u043a \u0440\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u044e \u0432 <code>dev</code> \u0438 <code>stage</code> \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f \"\u0438\u0437 \u043a\u043e\u0440\u043e\u0431\u043a\u0438\" \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c <code>infra-ci</code>.</li> <li>\u041d\u0430\u0431\u043b\u044e\u0434\u0430\u0435\u043c\u043e\u0441\u0442\u044c (Observability): \u0425\u0443\u043a\u0438 \u0434\u043b\u044f \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f, \u043c\u0435\u0442\u0440\u0438\u043a \u0438 \u0442\u0440\u0430\u0441\u0441\u0438\u0440\u043e\u0432\u043a\u0438.</li> </ul>"},{"location":"ru/template-platform/#_2","title":"\u041d\u0430\u0447\u0430\u043b\u043e \u0440\u0430\u0431\u043e\u0442\u044b","text":"<p>\u0427\u0442\u043e\u0431\u044b \u043d\u0430\u0447\u0430\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u0443 \u0441 <code>template-platform</code>, \u0443\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044c, \u0447\u0442\u043e \u0432\u044b \u043a\u043b\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043b\u0438 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0439 \u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043b\u0438 \u0435\u0433\u043e \u043f\u043e\u0434\u043c\u043e\u0434\u0443\u043b\u0438:</p> <pre><code>git clone &lt;your-repo-url&gt;/template-platform.git\ncd template-platform\ngit submodule update --init --recursive\n</code></pre> <p>\u0421\u0435\u0440\u0432\u0438\u0441 \u043c\u043e\u0436\u043d\u043e \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u043e \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e Docker Compose:</p> <pre><code>docker-compose up --build\n</code></pre>"},{"location":"ru/template-platform/#_3","title":"\u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435","text":"<p>\u0420\u0430\u0437\u0432\u0435\u0440\u0442\u044b\u0432\u0430\u043d\u0438\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0447\u0435\u0440\u0435\u0437 GitHub Actions \u043f\u0440\u0438 \u043f\u0443\u0448\u0435 \u0432 \u0432\u0435\u0442\u043a\u0443 <code>main</code> (\u0434\u043b\u044f <code>dev</code> \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f) \u0438\u043b\u0438 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043e \u0432\u0440\u0443\u0447\u043d\u0443\u044e (\u0434\u043b\u044f <code>stage</code> \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u044f). \u041f\u0430\u0439\u043f\u043b\u0430\u0439\u043d \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 Terraform, \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0435 \u0432 \u0440\u0435\u043f\u043e\u0437\u0438\u0442\u043e\u0440\u0438\u0438 <code>template-platform</code>, \u043a\u043e\u0442\u043e\u0440\u044b\u0435, \u0432 \u0441\u0432\u043e\u044e \u043e\u0447\u0435\u0440\u0435\u0434\u044c, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442 \u043c\u043e\u0434\u0443\u043b\u0438 \u0438\u0437 <code>infra-template</code>.</p>"},{"location":"ru/examples/aws-dev/","title":"AWS Dev","text":""},{"location":"ru/examples/aws-dev/#aws","title":"\u041f\u0440\u0438\u043c\u0435\u0440 \u0441\u0440\u0435\u0434\u044b \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438 AWS","text":"<p>\u042d\u0442\u043e\u0442 \u043f\u0440\u0438\u043c\u0435\u0440 \u0434\u0435\u043c\u043e\u043d\u0441\u0442\u0440\u0438\u0440\u0443\u0435\u0442, \u043a\u0430\u043a \u043d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u043f\u043e\u043b\u043d\u0443\u044e \u0441\u0440\u0435\u0434\u0443 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u043d\u0430 AWS \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u043c\u043e\u0434\u0443\u043b\u0435\u0439 <code>infra-core</code>.</p> <p>\u041e\u043d \u0432\u043a\u043b\u044e\u0447\u0430\u0435\u0442: - VPC \u0441 \u043f\u043e\u0434\u0441\u0435\u0442\u044f\u043c\u0438 - \u042d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 EC2 (VM) - \u0411\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445 RDS MySQL - \u0418\u043d\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044e Tailscale \u0434\u043b\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0433\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u0430</p>"},{"location":"ru/examples/aws-dev/#maintf","title":"\u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f (<code>main.tf</code>)","text":"<pre><code># main.tf \u0434\u043b\u044f \u043f\u0440\u0438\u043c\u0435\u0440\u0430 aws-dev\n\nprovider \"aws\" {\n  region = \"us-east-1\"\n}\n\nmodule \"vpc\" {\n  source = \"../../modules/vpc\"\n\n  provider          = \"aws\"\n  cidr_block        = \"10.0.0.0/16\"\n  subnet_cidr_block = \"10.0.1.0/24\"\n  tags = {\n    Name = \"aws-dev-vpc\"\n  }\n}\n\nmodule \"vm\" {\n  source = \"../../modules/vm\"\n\n  provider      = \"aws\"\n  ami           = \"ami-0c55b159cbfafe1f0\" # us-east-1\n  instance_type = \"t2.micro\"\n  tags = {\n    Name = \"aws-dev-vm\"\n  }\n}\n\nmodule \"db\" {\n  source = \"../../modules/db\"\n\n  provider          = \"aws\"\n  allocated_storage = 20\n  engine            = \"mysql\"\n  engine_version    = \"8.0\"\n  instance_class    = \"db.t2.micro\"\n  db_name           = \"awsdevdb\"\n  username          = \"user\"\n  password          = \"password\" # \u0417\u0430\u043c\u0435\u043d\u0438\u0442\u0435 \u043d\u0430 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c\n  tags = {\n    Name = \"aws-dev-db\"\n  }\n}\n\nmodule \"tailscale\" {\n  source = \"../../modules/tailscale\"\n\n  instance_id      = module.vm.instance_id\n  auth_key         = \"your-tailscale-auth-key\" # \u0417\u0430\u043c\u0435\u043d\u0438\u0442\u0435 \u043d\u0430 \u0432\u0430\u0448 \u043a\u043b\u044e\u0447 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438\n  ssh_user         = \"ec2-user\"\n  private_key_path = \"~/.ssh/id_rsa\" # \u0417\u0430\u043c\u0435\u043d\u0438\u0442\u0435 \u043d\u0430 \u043f\u0443\u0442\u044c \u043a \u0432\u0430\u0448\u0435\u043c\u0443 \u043f\u0440\u0438\u0432\u0430\u0442\u043d\u043e\u043c\u0443 \u043a\u043b\u044e\u0447\u0443\n  host             = module.vm.public_ip\n}\n\noutput \"vpc_id\" {\n  value = module.vpc.vpc_id\n}\n\noutput \"vm_id\" {\n  value = module.vm.instance_id\n}\n\noutput \"db_id\" {\n  value = module.db.db_instance_id\n}\n</code></pre>"},{"location":"ru/gcp/","title":"Home","text":""},{"location":"ru/gcp/#google-cloud-platform-gcp","title":"Google Cloud Platform (GCP)","text":"<p>\u042d\u0442\u043e\u0442 \u0440\u0430\u0437\u0434\u0435\u043b \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e, \u043e\u0442\u043d\u043e\u0441\u044f\u0449\u0443\u044e\u0441\u044f \u043a Google Cloud Platform.</p>"},{"location":"ru/gcp/db/","title":"DB","text":""},{"location":"ru/gcp/db/#_1","title":"\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u043f\u043e \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445","text":""},{"location":"ru/gcp/db/#_2","title":"\u041e\u0431\u0437\u043e\u0440","text":"<ul> <li>\u0418\u043c\u044f \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 \u0411\u0414]</li> <li>\u041f\u0440\u043e\u0435\u043a\u0442: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 ID \u043f\u0440\u043e\u0435\u043a\u0442\u0430 GCP]</li> <li>\u0420\u0435\u0433\u0438\u043e\u043d: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0440\u0435\u0433\u0438\u043e\u043d GCP]</li> <li>\u0422\u0438\u043f \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445: [\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, PostgreSQL 13, MySQL 8]</li> <li>\u0420\u0430\u0437\u043c\u0435\u0440 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430: [\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, db-n1-standard-1]</li> </ul>"},{"location":"ru/gcp/db/#_3","title":"\u0414\u0435\u0442\u0430\u043b\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f","text":"<ul> <li>\u0418\u043c\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430]</li> <li>\u041f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0439 IP: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0439 IP \u0438\u043b\u0438 \"\u041e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u043e\"]</li> <li>\u041f\u0440\u0438\u0432\u0430\u0442\u043d\u044b\u0439 IP: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0440\u0438\u0432\u0430\u0442\u043d\u044b\u0439 IP \u0438\u043b\u0438 \"\u041e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u043e\"]</li> </ul>"},{"location":"ru/gcp/db/#_4","title":"\u0420\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0435 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0438 \u043e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u043d\u0438\u0435","text":"<ul> <li>\u0420\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u043e\u0433\u043e \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f: [\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0415\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u043e \u0432 01:00 UTC]</li> <li>\u041e\u043a\u043d\u043e \u043e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u043d\u0438\u044f: [\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0412\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435 03:00-04:00 UTC]</li> </ul>"},{"location":"ru/gcp/db/#_5","title":"\u041f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u044f","text":"<p>[\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u043b\u044e\u0431\u044b\u0435 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u044f \u0437\u0434\u0435\u0441\u044c]</p>"},{"location":"ru/gcp/k8s/","title":"K8s","text":""},{"location":"ru/gcp/k8s/#kubernetes","title":"\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u043f\u043e \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0443 Kubernetes","text":""},{"location":"ru/gcp/k8s/#_1","title":"\u041e\u0431\u0437\u043e\u0440","text":"<ul> <li>\u0418\u043c\u044f \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430]</li> <li>\u041f\u0440\u043e\u0435\u043a\u0442: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 ID \u043f\u0440\u043e\u0435\u043a\u0442\u0430 GCP]</li> <li>\u041c\u0435\u0441\u0442\u043e\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043e\u043d\u0443 \u0438\u043b\u0438 \u0440\u0435\u0433\u0438\u043e\u043d GCP]</li> <li>\u0412\u0435\u0440\u0441\u0438\u044f Kubernetes: [\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, 1.23]</li> </ul>"},{"location":"ru/gcp/k8s/#_2","title":"\u041f\u0443\u043b\u044b \u0443\u0437\u043b\u043e\u0432","text":"\u0418\u043c\u044f \u043f\u0443\u043b\u0430 \u0443\u0437\u043b\u043e\u0432 \u0422\u0438\u043f \u043c\u0430\u0448\u0438\u043d\u044b \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0443\u0437\u043b\u043e\u0432 \u0410\u0432\u0442\u043e\u043c\u0430\u0441\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 [\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, default-pool] [\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, e2-medium] [\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, 3] [\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0412\u043a\u043b\u044e\u0447\u0435\u043d\u043e]"},{"location":"ru/gcp/k8s/#_3","title":"\u0421\u0435\u0442\u044c","text":"<ul> <li>VPC: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f VPC]</li> <li>\u041f\u043e\u0434\u0441\u0435\u0442\u044c: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043f\u043e\u0434\u0441\u0435\u0442\u0438]</li> <li>\u0414\u0438\u0430\u043f\u0430\u0437\u043e\u043d \u0430\u0434\u0440\u0435\u0441\u043e\u0432 \u043f\u043e\u0434\u043e\u0432: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 CIDR \u043f\u043e\u0434\u043e\u0432]</li> <li>\u0414\u0438\u0430\u043f\u0430\u0437\u043e\u043d \u0430\u0434\u0440\u0435\u0441\u043e\u0432 \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 CIDR \u0441\u0435\u0440\u0432\u0438\u0441\u043e\u0432]</li> </ul>"},{"location":"ru/gcp/k8s/#_4","title":"\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c","text":"<ul> <li>RBAC: [\u0412\u043a\u043b\u044e\u0447\u0435\u043d\u043e/\u041e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u043e]</li> <li>\u0418\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u0440\u0430\u0431\u043e\u0447\u0435\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438: [\u0412\u043a\u043b\u044e\u0447\u0435\u043d\u043e/\u041e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u043e]</li> </ul>"},{"location":"ru/gcp/k8s/#_5","title":"\u041f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u044f","text":"<p>[\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u043b\u044e\u0431\u044b\u0435 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u044f \u0437\u0434\u0435\u0441\u044c]</p>"},{"location":"ru/gcp/vm/","title":"VM","text":""},{"location":"ru/gcp/vm/#_1","title":"\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u043f\u043e \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u0435","text":""},{"location":"ru/gcp/vm/#_2","title":"\u041e\u0431\u0437\u043e\u0440","text":"<ul> <li>\u0418\u043c\u044f \u0412\u041c: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u0412\u041c]</li> <li>\u041f\u0440\u043e\u0435\u043a\u0442: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 ID \u043f\u0440\u043e\u0435\u043a\u0442\u0430 GCP]</li> <li>\u0417\u043e\u043d\u0430: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u043e\u043d\u0443 GCP]</li> <li>\u0422\u0438\u043f \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430: [\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, e2-medium]</li> <li>\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430: [\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, Debian 11]</li> </ul>"},{"location":"ru/gcp/vm/#_3","title":"\u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u0441\u0435\u0442\u0438","text":"<ul> <li>VPC: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f VPC]</li> <li>\u041f\u043e\u0434\u0441\u0435\u0442\u044c: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043f\u043e\u0434\u0441\u0435\u0442\u0438]</li> <li>\u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0439 IP: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0439 IP]</li> <li>\u0412\u043d\u0435\u0448\u043d\u0438\u0439 IP: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u043d\u0435\u0448\u043d\u0438\u0439 IP \u0438\u043b\u0438 \"\u041d\u0435\u0442\"]</li> </ul>"},{"location":"ru/gcp/vm/#_4","title":"\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044c","text":"<ul> <li>\u041f\u0440\u0430\u0432\u0438\u043b\u0430 \u0431\u0440\u0430\u043d\u0434\u043c\u0430\u0443\u044d\u0440\u0430:</li> <li>[\u0421\u043f\u0438\u0441\u043e\u043a \u043f\u0440\u0430\u0432\u0438\u043b \u0431\u0440\u0430\u043d\u0434\u043c\u0430\u0443\u044d\u0440\u0430]</li> <li>\u0423\u0447\u0435\u0442\u043d\u0430\u044f \u0437\u0430\u043f\u0438\u0441\u044c \u0441\u043b\u0443\u0436\u0431\u044b: [\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u0443\u0447\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438 \u0441\u043b\u0443\u0436\u0431\u044b]</li> </ul>"},{"location":"ru/gcp/vm/#_5","title":"\u041f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u044f","text":"<p>[\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u043b\u044e\u0431\u044b\u0435 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u044f \u0437\u0434\u0435\u0441\u044c]</p>"}]}