# infra-ci: Ð Ð°Ð±Ð¾Ñ‡Ð¸Ðµ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÑ‹ CI/CD

**infra-ci** â€” ÑÑ‚Ð¾ Ñ†ÐµÐ½Ñ‚Ñ€Ð°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹, ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ñ‰Ð¸Ð¹ Ð¼Ð½Ð¾Ð³Ð¾ÐºÑ€Ð°Ñ‚Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼Ñ‹Ðµ Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ðµ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÑ‹ GitHub Actions, ÑˆÐ°Ð±Ð»Ð¾Ð½Ñ‹ ÐºÐ¾Ð½Ð²ÐµÐ¹ÐµÑ€Ð¾Ð² Ð¸ ÑƒÑ‚Ð¸Ð»Ð¸Ñ‚Ñ‹ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð´Ð»Ñ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð¾Ð² Ð¸Ð½Ñ„Ñ€Ð°ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹ ÐºÐ°Ðº ÐºÐ¾Ð´Ð°.

## ðŸŽ¯ ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ

Ð­Ñ‚Ð¾Ñ‚ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹ Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ‹ CI/CD, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ:

- **Ð£Ð½Ð¸Ñ„Ð¸Ñ†Ð¸Ñ€ÑƒÑŽÑ‚ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÑ‹ CI/CD** Ð²Ð¾ Ð²ÑÐµÑ… Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸ÑÑ… `infra-*`
- **Ð£Ð¿Ñ€Ð¾Ñ‰Ð°ÑŽÑ‚ Ð¾Ð±ÑÐ»ÑƒÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ** Ð·Ð° ÑÑ‡ÐµÑ‚ Ñ†ÐµÐ½Ñ‚Ñ€Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð»Ð¾Ð³Ð¸ÐºÐ¸ ÐºÐ¾Ð½Ð²ÐµÐ¹ÐµÑ€Ð°
- **ÐŸÐ¾Ð²Ñ‹ÑˆÐ°ÑŽÑ‚ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ** Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ñ Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾Ð¼Ñƒ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸ÑŽ ÑÐµÐºÑ€ÐµÑ‚Ð°Ð¼Ð¸
- **Ð£ÑÐºÐ¾Ñ€ÑÑŽÑ‚ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ** Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ð³Ð¾Ñ‚Ð¾Ð²Ñ‹Ñ… ÑˆÐ°Ð±Ð»Ð¾Ð½Ð¾Ð²

## ðŸ“ Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ

```
infra-ci/
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â”œâ”€â”€ validate.yml             # Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Terraform
â”‚       â”œâ”€â”€ deploy.yml               # Ð¨Ð°Ð±Ð»Ð¾Ð½ Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ñ
â”‚       â””â”€â”€ reusable/
â”‚           â”œâ”€â”€ terraform-plan.yml   # ÐŸÐµÑ€ÐµÐ¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼Ñ‹Ð¹ Ð¿Ð»Ð°Ð½ Terraform
â”‚           â”œâ”€â”€ terraform-apply.yml  # ÐŸÐµÑ€ÐµÐ¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼Ð¾Ðµ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Terraform
â”‚           â””â”€â”€ sops-decrypt.yml     # Ð Ð°ÑÑˆÐ¸Ñ„Ñ€Ð¾Ð²ÐºÐ° ÑÐµÐºÑ€ÐµÑ‚Ð¾Ð² SOPS
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ decrypt.sh                   # Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ñ€Ð°ÑÑˆÐ¸Ñ„Ñ€Ð¾Ð²ÐºÐ¸ SOPS
â”‚   â””â”€â”€ lint.sh                      # ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ ÐºÐ¾Ð´Ð°
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ README.template.md           # Ð¨Ð°Ð±Ð»Ð¾Ð½ README Ð¼Ð¾Ð´ÑƒÐ»Ñ
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ ci-guide.md                  # Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Ð¿Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÑŽ
â””â”€â”€ README.md
```

## ðŸ”§ ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸

### 1. ÐŸÐµÑ€ÐµÐ¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼Ñ‹Ðµ Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ðµ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÑ‹

#### Ð Ð°Ð±Ð¾Ñ‡Ð¸Ð¹ Ð¿Ñ€Ð¾Ñ†ÐµÑÑ Terraform Plan
```yaml
# .github/workflows/reusable/terraform-plan.yml
name: Terraform Plan
on:
  workflow_call:
    inputs:
      working-directory:
        required: true
        type: string
      environment:
        required: true
        type: string
```

#### Ð Ð°Ð±Ð¾Ñ‡Ð¸Ð¹ Ð¿Ñ€Ð¾Ñ†ÐµÑÑ Terraform Apply
```yaml
# .github/workflows/reusable/terraform-apply.yml
name: Terraform Apply
on:
  workflow_call:
    inputs:
      working-directory:
        required: true
        type: string
```

#### Ð Ð°Ð±Ð¾Ñ‡Ð¸Ð¹ Ð¿Ñ€Ð¾Ñ†ÐµÑÑ Ñ€Ð°ÑÑˆÐ¸Ñ„Ñ€Ð¾Ð²ÐºÐ¸ SOPS
Ð Ð°ÑÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ñ‹Ð²Ð°ÐµÑ‚ ÐºÐ¾Ð½Ñ„Ð¸Ð´ÐµÐ½Ñ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ SOPS Ð¿ÐµÑ€ÐµÐ´ Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸ÐµÐ¼.

### 2. ÐšÐ¾Ð½Ð²ÐµÐ¹ÐµÑ€ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ð¸

Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸:
- âœ… `terraform fmt` - Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð´Ð°
- âœ… `terraform validate` - Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸
- âœ… `tflint` - Ð›Ð¸Ð½Ñ‚Ð¸Ð½Ð³ (Ð½ÐµÐ¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾)

### 3. Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸

- Ð’ÑÐµ ÑÐµÐºÑ€ÐµÑ‚Ñ‹ Ð¿ÐµÑ€ÐµÐ´Ð°ÑŽÑ‚ÑÑ Ñ‡ÐµÑ€ÐµÐ· GitHub Secrets
- Ð Ð°ÑÑˆÐ¸Ñ„Ñ€Ð¾Ð²ÐºÐ° Ñ„Ð°Ð¹Ð»Ð¾Ð² SOPS Ñ‡ÐµÑ€ÐµÐ· `age` Ð¸Ð»Ð¸ KMS
- Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Tailscale Ð´Ð»Ñ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ñ‹Ñ… Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ð¹

## ðŸ“– ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ

### Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿ÐµÑ€ÐµÐ¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼Ñ‹Ñ… Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ñ… Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ¾Ð² Ð² Ð²Ð°ÑˆÐµÐ¼ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¸

#### ÐŸÑ€Ð¸Ð¼ÐµÑ€: infra-aws/.github/workflows/deploy.yml

```yaml
name: Deploy AWS Infrastructure
on:
  push:
    branches: [main]
  pull_request:

jobs:
  plan:
    uses: v-grand/infra-ci/.github/workflows/reusable/terraform-plan.yml@main
    with:
      working-directory: ./infra
      environment: dev
    secrets:
      AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
      AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}

  apply:
    needs: plan
    if: github.ref == 'refs/heads/main'
    uses: v-grand/infra-ci/.github/workflows/reusable/terraform-apply.yml@main
    with:
      working-directory: ./infra
      environment: dev
    secrets:
      AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
      AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
```

### Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ€Ð°ÑÑˆÐ¸Ñ„Ñ€Ð¾Ð²ÐºÐ¸ SOPS

```yaml
name: Deploy with Secrets
on:
  push:
    branches: [main]

jobs:
  decrypt-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Decrypt Secrets
        uses: v-grand/infra-ci/.github/workflows/reusable/sops-decrypt.yml@main
        with:
          encrypted-file: secrets.enc.yaml
          age-key: ${{ secrets.AGE_SECRET_KEY }}
      
      - name: Deploy Infrastructure
        run: |
          terraform init
          terraform apply -auto-approve
```

## ðŸ”‘ Ð¢Ñ€ÐµÐ±ÑƒÐµÐ¼Ñ‹Ðµ ÑÐµÐºÑ€ÐµÑ‚Ñ‹ GitHub

ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹Ñ‚Ðµ ÑÑ‚Ð¸ ÑÐµÐºÑ€ÐµÑ‚Ñ‹ Ð² Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°Ñ… Ð²Ð°ÑˆÐµÐ³Ð¾ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ:

### Ð”Ð»Ñ Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ð¹ AWS
- `AWS_ACCESS_KEY_ID`
- `AWS_SECRET_ACCESS_KEY`
- `AWS_REGION` (Ð½ÐµÐ¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾)

### Ð”Ð»Ñ Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ð¹ GCP
- `GCP_CREDENTIALS` - JSON ÑƒÑ‡ÐµÑ‚Ð½Ð¾Ð¹ Ð·Ð°Ð¿Ð¸ÑÐ¸ ÑÐ»ÑƒÐ¶Ð±Ñ‹
- `GCP_PROJECT_ID`
- `GCP_REGION`

### Ð”Ð»Ñ Ñ€Ð°ÑÑˆÐ¸Ñ„Ñ€Ð¾Ð²ÐºÐ¸ SOPS
- `AGE_SECRET_KEY` - ÐŸÑ€Ð¸Ð²Ð°Ñ‚Ð½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡ Age
- `SOPS_KMS_ARN` - ARN ÐºÐ»ÑŽÑ‡Ð° AWS KMS (Ð¿Ñ€Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ð¸ AWS KMS)
- `SOPS_GCP_KMS` - ÐšÐ»ÑŽÑ‡ GCP KMS (Ð¿Ñ€Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ð¸ GCP KMS)

### Ð”Ð»Ñ Tailscale (Ð½ÐµÐ¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾)
- `TAILSCALE_AUTH_KEY` - ÐšÐ»ÑŽÑ‡ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Tailscale

## ðŸ›¡ï¸ Ð›ÑƒÑ‡ÑˆÐ¸Ðµ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸

1. **ÐÐ¸ÐºÐ¾Ð³Ð´Ð° Ð½Ðµ ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚ÑŒÑ‚Ðµ ÑÐµÐºÑ€ÐµÑ‚Ñ‹** - Ð’ÑÐµÐ³Ð´Ð° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ GitHub Secrets Ð¸Ð»Ð¸ SOPS
2. **Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ð¿Ñ€Ð¸Ð½Ñ†Ð¸Ð¿ Ð½Ð°Ð¸Ð¼ÐµÐ½ÑŒÑˆÐ¸Ñ… Ð¿Ñ€Ð¸Ð²Ð¸Ð»ÐµÐ³Ð¸Ð¹** - ÐŸÑ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐ¹Ñ‚Ðµ Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð¾ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ñ‹Ðµ Ñ€Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¸Ñ
3. **Ð’ÐºÐ»ÑŽÑ‡Ð¸Ñ‚Ðµ Ð·Ð°Ñ‰Ð¸Ñ‚Ñƒ Ð²ÐµÑ‚Ð²ÐµÐ¹** - Ð¢Ñ€ÐµÐ±ÑƒÐ¹Ñ‚Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ PR Ð´Ð»Ñ `main`
4. **Ð Ð¾Ñ‚Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ ÑƒÑ‡ÐµÑ‚Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ** - Ð ÐµÐ³ÑƒÐ»ÑÑ€Ð½Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐ¹Ñ‚Ðµ ÐºÐ»ÑŽÑ‡Ð¸ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð°
5. **ÐÑƒÐ´Ð¸Ñ‚ Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ð¹** - ÐŸÑ€Ð¾ÑÐ¼Ð°Ñ‚Ñ€Ð¸Ð²Ð°Ð¹Ñ‚Ðµ Ð¶ÑƒÑ€Ð½Ð°Ð»Ñ‹ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ñ… Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ¾Ð²

## ðŸ“š Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ñ Ð´Ñ€ÑƒÐ³Ð¸Ð¼Ð¸ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸ÑÐ¼Ð¸

| Ð ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹ | Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ |
|:-----------|:-----------|
| **infra-aws** | Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ðµ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÑ‹ `terraform-plan` Ð¸ `terraform-apply` |
| **infra-gcp** | Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ Ð¿ÐµÑ€ÐµÐ¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼Ñ‹Ðµ Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ðµ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÑ‹ Ñ ÑƒÑ‡ÐµÑ‚Ð½Ñ‹Ð¼Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸ GCP |
| **infra-k8s** | Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð¸Ñ€ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ñ Ð´Ð¸Ð°Ð³Ñ€Ð°Ð¼Ð¼ Helm |
| **infra-monitoring** | Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ðµ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÑ‹ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ð¸ |
| **infra-secrets** | Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ðµ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÑ‹ Ñ€Ð°ÑÑˆÐ¸Ñ„Ñ€Ð¾Ð²ÐºÐ¸ SOPS |

## ðŸš€ ÐÐ°Ñ‡Ð°Ð»Ð¾ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹

### 1. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹Ñ‚Ðµ ÑÐ²Ð¾Ð¹ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹

Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ ÑÑ‚Ð¾Ñ‚ Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ð¹ Ð¿Ñ€Ð¾Ñ†ÐµÑÑ Ð² ÑÐ²Ð¾Ð¹ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹:

```bash
mkdir -p .github/workflows
cat > .github/workflows/deploy.yml << 'EOF'
name: Deploy Infrastructure
on:
  push:
    branches: [main]
  pull_request:

jobs:
  terraform:
    uses: v-grand/infra-ci/.github/workflows/reusable/terraform-plan.yml@main
    with:
      working-directory: ./
      environment: dev
EOF
```

### 2. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹Ñ‚Ðµ ÑÐµÐºÑ€ÐµÑ‚Ñ‹

ÐŸÐµÑ€ÐµÐ¹Ð´Ð¸Ñ‚Ðµ Ð² ÑÐ²Ð¾Ð¹ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹ â†’ Settings â†’ Secrets Ð¸ Ð´Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ñ‹Ðµ ÑÐµÐºÑ€ÐµÑ‚Ñ‹.

### 3. ÐžÑ‚Ð¿Ñ€Ð°Ð²ÑŒÑ‚Ðµ Ð¸ Ñ€Ð°Ð·Ð²ÐµÑ€Ð½Ð¸Ñ‚Ðµ

```bash
git add .github/workflows/deploy.yml
git commit -m "Add CI/CD pipeline"
git push
```

## ðŸ“Š Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚

ÐŸÐ¾ÑÐ»Ðµ Ð²Ð½ÐµÐ´Ñ€ÐµÐ½Ð¸Ñ:
- âœ… Ð£Ð½Ð¸Ñ„Ð¸Ñ†Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ ÐºÐ¾Ð½Ð²ÐµÐ¹ÐµÑ€Ñ‹ CI/CD Ð²Ð¾ Ð²ÑÐµÑ… Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸ÑÑ…
- âœ… Ð£Ð¿Ñ€Ð¾Ñ‰ÐµÐ½Ð½Ð¾Ðµ Ð¾Ð±ÑÐ»ÑƒÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ Ð¸ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ
- âœ… ÐŸÐ¾Ð²Ñ‹ÑˆÐµÐ½Ð½Ð°Ñ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ñ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸ÑŽ ÑÐµÐºÑ€ÐµÑ‚Ð°Ð¼Ð¸
- âœ… Ð£ÑÐºÐ¾Ñ€ÐµÐ½Ð½Ð¾Ðµ Ð½Ð°Ñ‡Ð°Ð»Ð¾ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°

## ðŸ”— Ð¡Ð²ÑÐ·Ð°Ð½Ð½Ð°Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ

- [Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Terraform](https://terraform.io/docs)
- [GitHub Actions](https://docs.github.com/en/actions)
- [SOPS](https://github.com/mozilla/sops)
- [Tailscale](https://tailscale.com/kb/)

## ðŸ“ Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ñ€ÐµÑÑƒÑ€ÑÑ‹

- [Ð ÑƒÐºÐ¾Ð²Ð¾Ð´ÑÑ‚Ð²Ð¾ Ð¿Ð¾ CI](https://github.com/v-grand/infra-ci/blob/main/docs/ci-guide.md)
- [Ð¨Ð°Ð±Ð»Ð¾Ð½ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ](https://github.com/v-grand/infra-template)
